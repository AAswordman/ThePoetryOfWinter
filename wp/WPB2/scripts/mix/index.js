/*! For license information please see index.js.LICENSE.txt */
import*as __WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__ from"@minecraft/server";import*as __WEBPACK_EXTERNAL_MODULE__minecraft_server_ui_f6791859__ from"@minecraft/server-ui";var __webpack_modules__={475:(e,t,n)=>{n.d(t,{Z:()=>s});class s{constructor(e){this.val=null!=e?e:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}clone(){return new s(this.val)}mul(e){const t=new s;for(let n=0;n<4;n++)for(let s=0;s<4;s++){let i=0;this.val[n].forEach(((t,n)=>i+=t*e.val[n][s])),t.val[n][s]=i}return t}}},721:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(475);class i{constructor(e,t,n){"number"==typeof e&&"number"==typeof t&&"number"==typeof n?(this.x=e,this.y=t,this.z=n):void 0===e&&void 0===t&&void 0===n?(this.x=0,this.y=0,this.z=0):(this.x=e.x,this.y=e.y,this.z=e.z)}set(e,t,n){return"number"==typeof e?"number"==typeof t&&"number"==typeof n&&(this.x=e,this.y=t,this.z=n):this.set(e.x,e.y,e.z),this}add(e,t,n){return"number"==typeof e?"number"==typeof t&&"number"==typeof n&&(this.x+=e,this.y+=t,this.z+=n):this.add(e.x,e.y,e.z),this}sub(e,t,n){return"number"==typeof e?"number"==typeof t&&"number"==typeof n&&(this.x-=e,this.y-=t,this.z-=n):this.sub(e.x,e.y,e.z),this}scl(e,t,n){return"number"==typeof e?"number"==typeof t&&"number"==typeof n?(this.x*=e,this.y*=t,this.z*=n):void 0===t&&void 0===n&&(this.x*=e,this.y*=e,this.z*=e):this.scl(e.x,e.y,e.z),this}div(e,t,n){return"number"==typeof e?"number"==typeof t&&"number"==typeof n?(this.x/=e,this.y/=t,this.z/=n):void 0===t&&void 0===n&&(this.x/=e,this.y/=e,this.z/=e):this.div(e.x,e.y,e.z),this}len(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}len2(){return Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2)}equals(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}distance(e){return this.clone().sub(e).len()}toString(){return`(${this.x}, ${this.y}, ${this.z})`}[Symbol.toStringTag](){return this.toString()}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this}mul(e){if(e instanceof s.Z){const t=e.val;return this.set(this.x*t[0][0]+this.y*t[0][1]+this.z*t[0][2]+t[0][3],this.x*t[1][0]+this.y*t[1][1]+this.z*t[1][2]+t[1][3],this.x*t[2][0]+this.y*t[2][1]+this.z*t[2][2]+t[2][3])}return e.x*this.x+e.y*this.y+e.z*this.z}normalize(){return console.log("nor0: "+this),this.div(this.len()),console.log("nor1: "+this),this}clone(){return new i(this.x,this.y,this.z)}toArray(){return[this.x,this.y,this.z]}}i.down=new i(0,-1,0),i.forward=new i(0,0,1),i.back=new i(0,0,-1),i.left=new i(-1,0,0),i.one=new i(1,1,1),i.right=new i(1,0,0),i.up=new i(0,1,0),i.zero=new i(0,0,0)},724:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(205),i=n(721),a=n(801),r=n(409),o=n(960);class c{constructor(e){this.command=new o.Z(this),this._dimension=e}spawnParticle(e,t){this._dimension.spawnParticle(e,r.Z.getLocation(t),new s.MolangVariableMap)}createExplosion(e,t,n){this._dimension.createExplosion(r.Z.getLocation(e),t,n)}get dimension(){return this._dimension}getPlayers(e){return Array.from(this._dimension.getPlayers(e))}getEntities(e){let t=this._dimension.getEntities(e),n=[];for(let e of t)e.dimension===this._dimension&&n.push(e);return n}getBlock(e){return this._dimension.getBlock(e instanceof i.Z?r.Z.getBlockLocation(e):e)}setBlock(e,t,n=0){if("string"==typeof t)this.command.run(`setBlock ${e.x} ${e.y} ${e.z} ${t} ${n}`);else{let n=this.getBlock(e);null==n||n.setType(t)}}setBlockAsync(e,t){this.runCommandAsync(`setBlock ${e.x} ${e.y} ${e.z} ${t}`)}digBlock(e){try{return this.command.run(`setBlock ${e.x} ${e.y} ${e.z} air 0 destroy`),!0}catch(e){return!1}}spawnItem(e,t){try{return this._dimension.spawnItem(e,r.Z.getBlockLocation(t))}catch(e){return void a.Z.console.warn(e)}}spawnEntity(e,t){try{return this._dimension.spawnEntity(e,r.Z.getBlockLocation(t))}catch(e){return void a.Z.console.warn(e)}}runCommandAsync(e){return this._dimension.runCommandAsync(e)}static getInstance(e){let t=e;return this.propertyNameCache in t?t[this.propertyNameCache]:t[this.propertyNameCache]=new c(t)}}c.propertyNameCache="exCache"},361:(e,t,n)=>{n.d(t,{W:()=>a,Z:()=>s,to:()=>i});class s{static throwError(e){this.errorStack.push(e)}static init(e){e.getEvents().events.tick.subscribe((e=>{if(this.errorStack.length>0)throw this.errorStack.shift()}))}}function i(e){return e.then((e=>[e,void 0])).catch((e=>(s.throwError(e),[void 0,e])))}function a(e){try{return e()}catch(e){return}}s.errorStack=[]},215:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>ExGameClient});var _ExGameConfig_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(801),_events_ExClientEvents_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(654),_minecraft_server__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(205),_entity_ExPlayer_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(782),_ExDimension_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(724),_ui_ExActionAlert_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(217),_reflect_metadata_Reflect_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(855),_reflect_metadata_Reflect_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_reflect_metadata_Reflect_js__WEBPACK_IMPORTED_MODULE_6__),_events_eventDecoratorFactory_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(478),_utils_NotUtillTask_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(29),__awaiter=function(e,t,n,s){return new(n||(n=Promise))((function(i,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function o(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((s=s.apply(e,t||[])).next())}))};class ExGameClient{constructor(server,id,player){this.debuggerChatTest=e=>{e.message.startsWith("*/")&&_ExGameConfig_js__WEBPACK_IMPORTED_MODULE_0__.Z.console.info(eval(e.message.substring(2,e.message.length)))},this._server=server,this.clientId=id,this.player=player,this.exPlayer=_entity_ExPlayer_js__WEBPACK_IMPORTED_MODULE_3__.Z.getInstance(player),this.playerName=player.name,this._events=new _events_ExClientEvents_js__WEBPACK_IMPORTED_MODULE_1__.Z(this),_ExGameConfig_js__WEBPACK_IMPORTED_MODULE_0__.Z.config.debug?this.asDebugger():this.notDebugger(),(0,_utils_NotUtillTask_js__WEBPACK_IMPORTED_MODULE_8__.Z)(this,(()=>__awaiter(this,void 0,void 0,(function*(){try{return yield this.exPlayer.command.run("testfor @s"),!0}catch(e){return!1}}))),(()=>this.onLoaded())),this.onJoin(),(0,_events_eventDecoratorFactory_js__WEBPACK_IMPORTED_MODULE_7__.B)(this.getEvents(),this)}debug_removeAllTag(){for(let e of this.exPlayer.getTags())this.exPlayer.removeTag(e)}debug_alert(){(new _ui_ExActionAlert_js__WEBPACK_IMPORTED_MODULE_5__.Z).title("aaa").body("bbbb").button("alert",(()=>{})).button("alert",(()=>{})).show(this.player)}getDimension(e){return void 0!==e?_minecraft_server__WEBPACK_IMPORTED_MODULE_2__.world.getDimension(e):this.exPlayer.getDimension()}getExDimension(e){return _ExDimension_js__WEBPACK_IMPORTED_MODULE_4__.Z.getInstance(this.getDimension(...arguments))}getPlayers(){return _minecraft_server__WEBPACK_IMPORTED_MODULE_2__.world.getPlayers()}getServer(){return this._server}setInterworkingPool(e){this._pool=e,this._poolCache={};for(const e in this._pool)this._poolCache[e]=this._pool[e],Object.defineProperty(this._pool,e,{set:t=>{this._poolCache[e]=t},get:()=>{const t=this._poolCache[e];return"function"==typeof t?function(){const n={type:"pool",name:e,args:[...arguments]};return new Promise(((e,s)=>{e(t(...n.args))}))}:t},enumerable:!0})}getInterworkingPool(){return this._pool}onJoin(){}onLoaded(){}onLeave(){this._events.cancelAll()}getEvents(){return this._events}asDebugger(){this.player.addTag("debugger"),this._events.exEvents.chat.subscribe(this.debuggerChatTest)}notDebugger(){this.player.removeTag("debugger")}setTimeout(e,t){let n=0,s=i=>{n+=1e3*i.deltaTime,n>t&&(this.getEvents().exEvents.tick.unsubscribe(s),e())};this.getEvents().exEvents.tick.subscribe(s)}}},801:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(205);class i{static runCommandAsync(e){return t=this,n=void 0,a=function*(){try{return s.world.getDimension(s.MinecraftDimensionTypes.overworld).runCommandAsync(e)}catch(e){console.warn("Console error:",e)}},new((i=void 0)||(i=Promise))((function(e,s){function r(e){try{c(a.next(e))}catch(e){s(e)}}function o(e){try{c(a.throw(e))}catch(e){s(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,o)}c((a=a.apply(t,n||[])).next())}));var t,n,i,a}}},703:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(205),i=n(418),a=n(721),r=n(522),o=n(960),c=n(724);class l{constructor(e){if(this.command=new o.Z(this),this._entity=e,l.propertyNameCache in e)throw new Error("Already have a instance in entity.please use ExEntity.getInstance to get it.");Reflect.set(e,l.propertyNameCache,this)}damage(e){this.runCommandAsync(`damage @s ${e}`)}causeDamageTo(e,t){e instanceof l&&(e=e.entity),o.Z.run(this,`damage {0} ${t} entity_attack entity @s`,e)}getPreRemoveHealth(){return this._damage}removeHealth(e,t){void 0===this._damage?(this._damage=t,e.setTimeout((()=>{var e;let t=this.getHealthComponent();t.current>.5&&t.setCurrent(Math.max(.5,t.current-(null!==(e=this._damage)&&void 0!==e?e:0))),this._damage=void 0}),0)):this._damage+=t}addHealth(e,t){this.removeHealth(e,-t)}get nameTag(){return this._entity.nameTag}set nameTag(e){this._entity.nameTag=e}get entity(){return this._entity}set entity(e){this._entity=e}static getInstance(e){let t=e;return this.propertyNameCache in t?Reflect.get(t,this.propertyNameCache):new l(t)}getDimension(){return this._entity.dimension}getExDimension(){return c.Z.getInstance(this.getDimension())}addTag(e){return this._entity.addTag(e),e}getTags(){return this._entity.getTags()}hasTag(e){return this._entity.hasTag(e)}removeTag(e){return this._entity.removeTag(e),e}runCommandAsync(e){return this._entity.runCommandAsync(e)}detectArmor(e,t,n,s){return i=this,a=void 0,o=function*(){try{return yield this.command.run("execute if entity @s[hasitem={location=slot.armor.head,item="+e+"}] if entity @s[hasitem={location=slot.armor.chest,item="+t+"}] if entity @s[hasitem={location=slot.armor.legs,item="+n+"}] if entity @s[hasitem={location=slot.armor.feet,item="+s+"}] run testfor @s"),!0}catch(e){return!1}},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{c(o.next(e))}catch(e){t(e)}}function s(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(n,s)}c((o=o.apply(i,a||[])).next())}));var i,a,r,o}getScoresManager(){return new i.Z(this._entity)}triggerEvent(e){this._entity.triggerEvent(e)}getPosition(){return new a.Z(this.entity.location)}getRotation(){return this.entity.rotation}setPosition(e,t=this.entity.dimension){this.entity.teleport(e,t,this.entity.rotation.x,this.entity.rotation.y)}setDimension(e){this.setPosition(this.getPosition(),e)}getViewVector(){return new a.Z(this.entity.viewVector)}hasComponent(e){return this._entity.hasComponent(e)}getComponent(e){return this._entity.getComponent(e)}hasHealthComponent(){return this.hasComponent(s.EntityHealthComponent.componentId)}getHealthComponent(){return this.getComponent(s.EntityHealthComponent.componentId)}getHealth(){return this.getHealthComponent().current}getMaxHealth(){return this.getHealthComponent().value}hasInventoryComponent(){return this.hasComponent(s.EntityInventoryComponent.componentId)}getInventoryComponent(){return this.getComponent(s.EntityInventoryComponent.componentId)}getBag(){return new r.Z(this)}hasVariantComponent(){return this.hasComponent(s.EntityVariantComponent.componentId)}getVariantComponent(){return this.getComponent(s.EntityVariantComponent.componentId)}getVariant(){var e,t;return null!==(t=null===(e=this.getVariantComponent())||void 0===e?void 0:e.value)&&void 0!==t?t:0}hasMarkVariantComponent(){return this.hasComponent(s.EntityMarkVariantComponent.componentId)}getMarkVariantComponent(){return this.getComponent(s.EntityMarkVariantComponent.componentId)}getMarkVariant(){var e,t;return null!==(t=null===(e=this.getMarkVariantComponent())||void 0===e?void 0:e.value)&&void 0!==t?t:0}hasIsBabyComponent(){return this.hasComponent(s.EntityIsBabyComponent.componentId)}hasIsChargedComponent(){return this.hasComponent(s.EntityIsChargedComponent.componentId)}}l.propertyNameCache="exCache"},522:(e,t,n)=>{n.d(t,{Z:()=>s});class s{constructor(e){this._entity=e,this.bagComponent=e.getInventoryComponent()}getItem(e){if("number"==typeof e)return this.bagComponent.container.getItem(e);let t=this.searchItem(e);return-1!==t?this.bagComponent.container.getItem(t):void 0}searchItem(e){let t=this.getAllItems();for(let n=0;n<t.length;n++)if(void 0!==t[n]&&t[n].typeId===e)return n;return-1}getAllItems(){let e=[];for(let t=0;t<this.size();t++)e.push(this.bagComponent.container.getItem(t));return e}countAllItems(){var e;let t=new Map;for(let n=0;n<this.size();n++){let s=this.getItem(n);s&&t.set(s.typeId,s.amount+(null!==(e=t.get(s.typeId))&&void 0!==e?e:0))}return t}clearItem(e,t){for(let n=0;n<this.size();n++){let s=this.getItem(n);if((null==s?void 0:s.typeId)===e){let e=t-s.amount;if(!(e>0)){s.amount-=t,this.setItem(n,s);break}this.setItem(n,void 0),t=e}}}size(){return this.bagComponent.inventorySize}type(){return this.bagComponent.containerType}isPrivate(){return this.bagComponent.private}isRestrictToOwner(){return this.bagComponent.restrictToOwner}setItem(e,t){return this.bagComponent.container.setItem(e,t)}hasItem(e){return-1!==this.searchItem(e)}}},344:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(205),i=n(418),a=n(960);class r{constructor(e){this.command=new a.Z(this),this.nameTag=e}runCommandAsync(e){return s.world.getDimension(s.MinecraftDimensionTypes.overworld).runCommandAsync(e)}getScoresManager(){return new i.Z(this)}}},782:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(205),i=n(703),a=n(409),r=n(522);class o extends r.Z{constructor(e){super(e),this._player=e,this.bagComponent=e.getInventoryComponent()}getItemOnHand(){return this.getItem(this._player.selectedSlot)}setItemOnHand(e){return this.setItem(this._player.selectedSlot,e)}}class c extends i.Z{constructor(e){super(e),this.bag=new o(this),this.scoresManager=super.getScoresManager()}get entity(){return super.entity}set entity(e){super.entity=e}setGameMode(e){switch(e){case s.GameMode.survival:this.runCommandAsync("gamemode 0");break;case s.GameMode.creative:this.runCommandAsync("gamemode 1");break;case s.GameMode.adventure:this.runCommandAsync("gamemode 2");break;case s.GameMode.spectator:this.runCommandAsync("gamemode 3")}}getGameMode(){var e,t,n,i;let r=s.GameMode.creative;return r=(null===(e=Array.from(this.getDimension().getPlayers({location:a.Z.getLocation(this.entity.location),closest:1,maxDistance:1,gameMode:s.GameMode.adventure})))||void 0===e?void 0:e[0])===this.entity?s.GameMode.adventure:r,r=(null===(t=Array.from(this.getDimension().getPlayers({location:a.Z.getLocation(this.entity.location),closest:1,maxDistance:1,gameMode:s.GameMode.creative})))||void 0===t?void 0:t[0])===this.entity?s.GameMode.creative:r,r=(null===(n=Array.from(this.getDimension().getPlayers({location:a.Z.getLocation(this.entity.location),closest:1,maxDistance:1,gameMode:s.GameMode.spectator})))||void 0===n?void 0:n[0])===this.entity?s.GameMode.spectator:r,r=(null===(i=Array.from(this.getDimension().getPlayers({location:a.Z.getLocation(this.entity.location),closest:1,maxDistance:1,gameMode:s.GameMode.survival})))||void 0===i?void 0:i[0])===this.entity?s.GameMode.survival:r,r}title(e,t){this.entity.onScreenDisplay.setTitle(e),t&&this.entity.onScreenDisplay.updateSubtitle(t)}titleActionBar(e){this.entity.onScreenDisplay.setActionBar(e)}get selectedSlot(){return this.entity.selectedSlot}set selectedSlot(e){this.entity.selectedSlot=e}getBag(){return this.bag}static getInstance(e){let t=e;return this.propertyNameCache in t?t[this.propertyNameCache]:t[this.propertyNameCache]=new c(t)}getScoresManager(){return this.scoresManager}}},418:(e,t,n)=>{n.d(t,{C:()=>o,Z:()=>r});var s=n(205),i=n(344),a=n(801);class r{constructor(e){this.entity=e}getScore(e){var t,n,a,r,o,c;let l="string"==typeof e?e:e.name;if(this.entity instanceof i.Z){const e=this.entity;return null!==(n=null===(t=s.world.scoreboard.getObjective(l).getScores().find((t=>t.participant.displayName===e.nameTag)))||void 0===t?void 0:t.score)&&void 0!==n?n:0}try{return null!==(r=null===(a=s.world.scoreboard.getObjective(l))||void 0===a?void 0:a.getScore(this.entity.scoreboard))&&void 0!==r?r:0}catch(e){const t=this.entity;return null!==(c=null===(o=s.world.scoreboard.getObjective(l).getScores().find((e=>e.participant===t.scoreboard)))||void 0===o?void 0:o.score)&&void 0!==c?c:0}}setScoreAsync(e,t){let n="string"==typeof e?e:e.name;this.entity.runCommandAsync(`scoreboard players set ${this.entity instanceof i.Z?'"'+this.entity.nameTag+'"':"@s"} ${n} ${t}`)}addScoreAsync(e,t){let n="string"==typeof e?e:e.name;this.entity.runCommandAsync(`scoreboard players add ${this.entity instanceof i.Z?'"'+this.entity.nameTag+'"':"@s"} ${n} ${t}`)}removeScoreAsync(e,t){let n="string"==typeof e?e:e.name;this.entity.runCommandAsync(`scoreboard players remove ${this.entity instanceof i.Z?'"'+this.entity.nameTag+'"':"@s"} ${n} ${t}`)}deleteScoreAsync(e){let t="string"==typeof e?e:e.name;this.entity.runCommandAsync(`scoreboard players reset ${this.entity instanceof i.Z?'"'+this.entity.nameTag+'"':"@s"} ${t}`)}}class o{constructor(e){this.name=e}create(e){try{s.world.scoreboard.addObjective(this.name,e)}catch(e){}return this}delete(){a.Z.runCommandAsync(`scoreboard objectives remove ${this.name}`)}setDisplay(e="sidebar",t=!0){return"sidebar"==e?a.Z.runCommandAsync(`scoreboard objectives setdisplay ${e} ${this.name} ${t?"ascending":"descending"}`):a.Z.runCommandAsync(`scoreboard objectives setdisplay ${e} ${this.name}`),this}}},960:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(703),i=n(38),a=n(242),r=n(484);class o{constructor(){this.queue=[]}push(e){this.queue.push(e)}shift(){return this.queue.shift()}get length(){return this.queue.length}}class c{constructor(e){this.runner=e}run(e,...t){if("string"==typeof e)return new Promise(((n,s)=>{c.queue.push([this.runner,e,t,n,s])}));{let n=[];for(let n of e)this.run(n,...t);return n}}static init(e){this.queue=new o,this.delay=new r.Z(e.getEvents(),(()=>{let e=0;for(;c.queue.length>0&&e<100;){const t=c.queue.shift();e++,void 0!==t&&c.run(t[0],t[1],...t[2]).then((e=>{t[3](e)})).catch((e=>{t[4](e)}))}})).delay(1),this.delay.start()}static run(e,t,...n){return r=this,o=void 0,l=function*(){const r=[];let o=yield e.runCommandAsync(0===n.length?t:(0,i.Z)(t,n.map((e=>{let t=a.Z.randomUUID();return e instanceof s.Z&&(e=e.entity),e.addTag(t),r.push([e,t]),`@e[tag="${t}"]`}))));for(let e of r)e[0].removeTag(e[1]);return o},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function s(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c((function(e){e(i)}))).then(n,s)}i((l=l.apply(r,o||[])).next())}));var r,o,c,l}}},710:(e,t,n)=>{n.d(t,{Z:()=>s});class s{constructor(){this.monitorMap={},this.registerToServerByEntity=(e,t)=>{this.server.getEvents().register(e,(e=>{var n;const s=null===(n=this.listeners[t].filter)||void 0===n?void 0:n.name;if(s){let n=e[s],i=this.monitorMap[t].get(n);i&&i.forEach((t=>{t(e)}))}}))},this.registerToServerByServerEvent=(e,t)=>{this.server.getEvents().register(e,(e=>{for(let[n,s]of this.monitorMap[t])s.forEach((t=>{t(e)}))}))}}setEventLiseners(e){this.listeners=e}init(e){this.server=e;for(let e in this.listeners)this.monitorMap[e]=new Map;for(let e in this.monitorMap){let t=this.listeners[e],n=e;t.name&&(n=t.name),t.pattern(n,e)}}subscribe(e,t,n){var s;let i=this.monitorMap[t];i.has(e)||i.set(e,[]),null===(s=i.get(e))||void 0===s||s.push(n)}unsubscribe(e,t,n){let s=this.monitorMap[t].get(e);if(s){let e=s.indexOf(n);-1!==e&&s.splice(e,1)}}unsubscribeAll(e){for(let t in this.monitorMap)this.monitorMap[t].delete(e)}}},654:(e,t,n)=>{n.d(t,{Z:()=>l});var s,i=n(205),a=n(782),r=n(513),o=n(484),c=n(710);class l{constructor(e){this.exEvents={itemUse:new u(this,"itemUse"),chat:new u(this,"chat"),beforeChat:new u(this,"beforeChat"),tick:new u(this,"tick"),entityHit:new u(this,"entityHit"),itemUseOn:new u(this,"itemUseOn"),beforeItemUseOn:new u(this,"beforeItemUseOn"),onceItemUseOn:new u(this,"onceItemUseOn"),playerHitEntity:new u(this,"playerHitEntity"),playerHurt:new u(this,"playerHurt"),itemOnHandChange:new u(this,"itemOnHandChange"),onLongTick:new u(this,"onLongTick"),blockBreak:new u(this,"blockBreak")},this._client=e}_subscribe(e,t){l.eventHandlers.subscribe(this._client.player,e,t)}_unsubscribe(e,t){l.eventHandlers.unsubscribe(this._client.player,e,t)}cancelAll(){l.eventHandlers.unsubscribeAll(this._client.player)}static init(e){this.eventHandlers.setEventLiseners(this.exEventSetting),this.eventHandlers.init(e)}register(e,t){let n=t;if(e in this.exEvents)return this.exEvents[e].subscribe(n);console.warn("No event registered for name "+e)}cancel(e,t){if(e in this.exEvents)return this.exEvents[e].unsubscribe(t)}}s=l,l.eventHandlers=new c.Z,l.exEventSetting={itemUse:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"source"}},chat:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"sender"}},beforeChat:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"sender"}},tick:{pattern:l.eventHandlers.registerToServerByServerEvent},entityHit:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"entity"}},itemUseOn:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"source"}},beforeItemUseOn:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"source"}},onceItemUseOn:{pattern:(e,t)=>{s.onceItemUseOnMap=new Map,l.eventHandlers.server.getEvents().register(e,(e=>{var n;if(!(e.source instanceof i.Player))return;let a=l.eventHandlers.monitorMap[t];if(!s.onceItemUseOnMap.has(e.source)){const t=e.source;s.onceItemUseOnMap.set(e.source,[new o.Z(l.eventHandlers.server.getEvents(),(()=>{let e=s.onceItemUseOnMap.get(t);void 0!==e&&(e[1]=!0)})).delay(3),!0])}let r=s.onceItemUseOnMap.get(e.source);void 0!==r&&(r[1]&&(r[1]=!1,null===(n=a.get(e.source))||void 0===n||n.forEach((t=>t(e)))),r[0].stop(),r[0].startOnce())}))},filter:{name:"source"},name:"beforeItemUseOn"},playerHitEntity:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"damagingEntity"},name:"entityHurt"},playerHurt:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"hurtEntity"},name:"entityHurt"},itemOnHandChange:{pattern:(e,t)=>{s.onHandItemMap=new Map,l.eventHandlers.server.getEvents().register(e,(e=>{for(let e of l.eventHandlers.monitorMap[t]){let t=s.onHandItemMap.get(e[0]),n=null==t?void 0:t[0],i=a.Z.getInstance(e[0]).getBag().getItemOnHand();(null==n?void 0:n.typeId)===(null==i?void 0:i.typeId)&&e[0].selectedSlot===(null==t?void 0:t[1])||(e[1].forEach((t=>{t(new r.a(n,a.Z.getInstance(e[0]).getBag().getItemOnHand(),e[0]))})),s.onHandItemMap.set(e[0],[i,e[0].selectedSlot]))}}))},name:"onLongTick"},onLongTick:{pattern:l.eventHandlers.registerToServerByServerEvent},blockBreak:{pattern:l.eventHandlers.registerToServerByEntity,filter:{name:"player"}}},l.onHandItemMap=new Map,l.onceItemUseOnMap=new Map;class u{constructor(e,t){this.subscribe=n=>{e._subscribe(t,n)},this.unsubscribe=n=>{e._unsubscribe(t,n)}}}},478:(e,t,n)=>{n.d(t,{B:()=>i,K:()=>a});var s=n(516);function i(e,t){for(let n of s.Z.keys(t)){const s=Reflect.getMetadata("eventName",t,n);if(s){const i=Reflect.getMetadata("eventCondition",t,n);i?e.register(s,(e=>{i(t,e)&&t[n].call(t,e)})):e.register(s,t[n].bind(t))}}}function a(e,t){return function(n,s,i){Reflect.defineMetadata("eventName",e,n,s),Reflect.defineMetadata("eventCondition",t,n,s)}}},513:(e,t,n)=>{n.d(t,{a:()=>s});class s{constructor(e,t,n){this.beforeItem=e,this.afterItem=t,this.source=n}}},409:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(205);class i{static getVector(e){return this._tempVector?(this._tempVector.x=e.x,this._tempVector.y=e.y,this._tempVector.z=e.z,this._tempVector):this._tempVector=new s.Vector(e.x,e.y,e.z)}static getLocation(e){return this._tempLocation?(this._tempLocation.x=e.x,this._tempLocation.y=e.y,this._tempLocation.z=e.z,this._tempLocation):this._tempLocation=new s.Location(e.x,e.y,e.z)}static getBlockLocation(e){return this._tempBlockLocation?(this._tempBlockLocation.x=e.x,this._tempBlockLocation.y=e.y,this._tempBlockLocation.z=e.z,this._tempBlockLocation):this._tempBlockLocation=new s.BlockLocation(e.x,e.y,e.z)}}},217:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(985),i=n(361);class a{constructor(){this._alert=new s.ActionFormData,this.buttonEvent=[]}body(e){return this._alert.body(e),this}button(e,t,n){return this._alert.button(e,n),this.buttonEvent.push(t),this}show(e){return this._alert.show(e).then((e=>{e.canceled||void 0===e.selection||this.buttonEvent[e.selection]()})).catch((e=>i.Z.throwError(e))),this}title(e){return this._alert.title(e),this}}},516:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(647);class i{static getId(e){return this.idMap.has(e)||this.idMap.set(e,Math.floor(Math.random()*s.Z.MAX_VALUE)),this.idMap.get(e)}static hasChineseCharacter(e){return this.chineseCharMatcher.test(e)}static keys(e){const t=Reflect.ownKeys(e);let n=e.__proto__;for(;n;){for(let e of Reflect.ownKeys(n))t.push(e);n=n.__proto__}return t}static parseObj(e){let t=i.keys(e),n="{\n";for(const s of t){const t=e[s];null===t&&(n+=`${String(s)}: null\n`),n+="object"!=typeof t?`${String(s)}: ${t}\n`:`${String(s)}: {...}\n`}return n+"}"}}i.idMap=new Map,i.chineseCharMatcher=/([\u4E00-\u9FA5])+/},29:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(361);function i(e,t,n){let i=()=>{return a=this,r=void 0,c=function*(){try{let s=t();s instanceof Promise&&(s=yield s),s?n():e.setTimeout(i,1e3)}catch(e){s.Z.throwError(e)}},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function s(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(n,s)}i((c=c.apply(a,r||[])).next())}));var a,r,o,c};e.setTimeout(i,100)}},647:(e,t,n)=>{n.d(t,{Z:()=>s});class s{constructor(e){this.seed=(e||Date.now())%999999999}next(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280}nextDouble(){return this.next()}nextLong(){return Math.floor(this.nextDouble()*s.MAX_VALUE)}nextInt(e=s.MAX_VALUE){return Math.floor(this.nextDouble()*e)}nextBoolean(){return this.nextDouble()>=.5}static choice(e){if(e instanceof Array){if(0===e.length)throw new Error("array mustnot be empty");return e[Math.floor(Math.random()*e.length)]}{let t=[];for(let n in e)t.push(n);return e[s.choice(t)]}}}s.MAX_VALUE=~(1<<31),s.MIN_VALUE=1<<31},484:(e,t,n)=>{n.d(t,{Z:()=>s});class s{constructor(e,t){this.time=20,this.timeOut=e,this.looper=t}getDelay(){return this.time}delay(e){return this.time=e,this}isStarted(){return void 0!==this.func}startOnce(){let e=0;this.isStarted()||(this.func=t=>{e+=1,e>=this.time&&(this.stop(),this.looper())},this.timeOut.register("tick",this.func))}start(){let e=0;this.isStarted()||(this.func=t=>{e+=1,e>=this.time&&(this.looper(),e=0)},this.timeOut.register("tick",this.func))}stop(){this.func&&(this.timeOut.cancel("tick",this.func),this.func=void 0)}}},242:(e,t,n)=>{n.d(t,{Z:()=>s});class s{static randomUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}}},342:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function encodeUnicode(e){let t=[];for(var n=0;n<e.length;n++)t[n]=("00"+e.charCodeAt(n).toString(16)).slice(-4);return"\\u"+t.join("\\u")}function decodeUnicode(str){return eval('{"'+str+'"}')}__webpack_require__.d(__webpack_exports__,{L:()=>decodeUnicode})},38:(e,t,n)=>{function s(e,...t){var n=e;for(let e in t)n=n.replace("{"+e+"}",t[e]+"");return n}n.d(t,{Z:()=>s})},437:()=>{Array.prototype.clear=function(){this.splice(0,this.length)}},855:(e,t,n)=>{var s;!function(e){!function(t){var s="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=a(e);function a(e,t){return function(n,s){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:s}),t&&t(n,s)}}void 0===s.Reflect?s.Reflect=e:i=a(s.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,s=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,r={__proto__:[]}instanceof Array,o=!a&&!r,c={create:a?function(){return O(Object.create(null))}:r?function(){return O({__proto__:null})}:function(){return O({})},has:o?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:o?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var s=this._keys.length,i=n+1;i<s;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,s)},t.prototype.values=function(){return new n(this._keys,this._values,a)},t.prototype.entries=function(){return new n(this._keys,this._values,r)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function s(e,t){return e}function a(e,t){return t}function r(e,t){return[e,t]}}():Map,d=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}():Set,m=new(u||"function"!=typeof WeakMap?function(){var e=c.create(),n=s();return function(){function e(){this._key=s()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=s()},e}();function s(){var t;do{t="@@WeakMap@@"+r()}while(c.has(e,t));return e[t]=!0,t}function i(e,s){if(!t.call(e,n)){if(!s)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function r(){var e,t=(e=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",s=0;s<16;++s){var i=t[s];4!==s&&6!==s&&8!==s||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}():WeakMap);function g(e,t,n){var s=m.get(e);if(A(s)){if(!n)return;s=new h,m.set(e,s)}var i=s.get(t);if(A(i)){if(!n)return;i=new h,s.set(t,i)}return i}function _(e,t,n){if(p(e,t,n))return!0;var s=R(t);return!v(s)&&_(e,s,n)}function p(e,t,n){var s=g(t,n,!1);return!A(s)&&!!s.has(e)}function y(e,t,n){if(p(e,t,n))return f(e,t,n);var s=R(t);return v(s)?void 0:y(e,s,n)}function f(e,t,n){var s=g(t,n,!1);if(!A(s))return s.get(e)}function w(e,t,n,s){g(n,s,!0).set(e,t)}function E(e,t){var n=b(e,t),s=R(e);if(null===s)return n;var i=E(s,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var a=new d,r=[],o=0,c=n;o<c.length;o++){var l=c[o];a.has(l)||(a.add(l),r.push(l))}for(var u=0,h=i;u<h.length;u++)l=h[u],a.has(l)||(a.add(l),r.push(l));return r}function b(e,t){var n=[],s=g(e,t,!1);if(A(s))return n;for(var a=function(e){var t=k(e,i);if(!S(t))throw new TypeError;var n=t.call(e);if(!T(n))throw new TypeError;return n}(s.keys()),r=0;;){var o=N(a);if(!o)return n.length=r,n;var c=o.value;try{n[r]=c}catch(e){try{B(a)}finally{throw e}}r++}}function I(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function A(e){return void 0===e}function v(e){return null===e}function T(e){return"object"==typeof e?null!==e:"function"==typeof e}function M(e,t){switch(I(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=k(e,s);if(void 0!==i){var a=i.call(e,n);if(T(a))throw new TypeError;return a}return function(e,t){if("string"===t){var n=e.toString;if(S(n)&&!T(i=n.call(e)))return i;if(S(s=e.valueOf)&&!T(i=s.call(e)))return i}else{var s;if(S(s=e.valueOf)&&!T(i=s.call(e)))return i;var i,a=e.toString;if(S(a)&&!T(i=a.call(e)))return i}throw new TypeError}(e,"default"===n?"number":n)}function D(e){var t=M(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function C(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function S(e){return"function"==typeof e}function x(e){return"function"==typeof e}function k(e,t){var n=e[t];if(null!=n){if(!S(n))throw new TypeError;return n}}function N(e){var t=e.next();return!t.done&&t}function B(e){var t=e.return;t&&t.call(e)}function R(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var n=e.prototype,s=n&&Object.getPrototypeOf(n);if(null==s||s===Object.prototype)return t;var i=s.constructor;return"function"!=typeof i||i===e?t:i}function O(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,n,s){if(A(n)){if(!C(e))throw new TypeError;if(!x(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var s=(0,e[n])(t);if(!A(s)&&!v(s)){if(!x(s))throw new TypeError;t=s}}return t}(e,t)}if(!C(e))throw new TypeError;if(!T(t))throw new TypeError;if(!T(s)&&!A(s)&&!v(s))throw new TypeError;return v(s)&&(s=void 0),function(e,t,n,s){for(var i=e.length-1;i>=0;--i){var a=(0,e[i])(t,n,s);if(!A(a)&&!v(a)){if(!T(a))throw new TypeError;s=a}}return s}(e,t,n=D(n),s)})),e("metadata",(function(e,t){return function(n,s){if(!T(n))throw new TypeError;if(!A(s)&&!function(e){switch(I(e)){case 3:case 4:return!0;default:return!1}}(s))throw new TypeError;w(e,t,n,s)}})),e("defineMetadata",(function(e,t,n,s){if(!T(n))throw new TypeError;return A(s)||(s=D(s)),w(e,t,n,s)})),e("hasMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return A(n)||(n=D(n)),_(e,t,n)})),e("hasOwnMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return A(n)||(n=D(n)),p(e,t,n)})),e("getMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return A(n)||(n=D(n)),y(e,t,n)})),e("getOwnMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return A(n)||(n=D(n)),f(e,t,n)})),e("getMetadataKeys",(function(e,t){if(!T(e))throw new TypeError;return A(t)||(t=D(t)),E(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!T(e))throw new TypeError;return A(t)||(t=D(t)),b(e,t)})),e("deleteMetadata",(function(e,t,n){if(!T(t))throw new TypeError;A(n)||(n=D(n));var s=g(t,n,!1);if(A(s))return!1;if(!s.delete(e))return!1;if(s.size>0)return!0;var i=m.get(t);return i.delete(n),i.size>0||m.delete(t),!0}))}(i)}()}(s||(s={}))},205:(e,t,n)=>{var s,i;e.exports=(s={BlockLocation:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.BlockLocation,ChatEvent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.ChatEvent,EntityCreateEvent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityCreateEvent,EntityDamageCause:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityDamageCause,EntityHealthComponent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityHealthComponent,EntityHurtEvent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityHurtEvent,EntityInventoryComponent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityInventoryComponent,EntityIsBabyComponent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityIsBabyComponent,EntityIsChargedComponent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityIsChargedComponent,EntityMarkVariantComponent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityMarkVariantComponent,EntityVariantComponent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.EntityVariantComponent,GameMode:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.GameMode,ItemEnchantsComponent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.ItemEnchantsComponent,ItemStack:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.ItemStack,Items:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.Items,Location:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.Location,MinecraftBlockTypes:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.MinecraftBlockTypes,MinecraftDimensionTypes:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.MinecraftDimensionTypes,MinecraftEffectTypes:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.MinecraftEffectTypes,MinecraftEntityTypes:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.MinecraftEntityTypes,MinecraftItemTypes:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.MinecraftItemTypes,MolangVariableMap:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.MolangVariableMap,Player:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.Player,PlayerJoinEvent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.PlayerJoinEvent,PlayerLeaveEvent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.PlayerLeaveEvent,TickEvent:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.TickEvent,Vector:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.Vector,system:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.system,world:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_fb7572af__.world},i={},n.d(i,s),i)},985:(e,t,n)=>{var s,i;e.exports=(s={ActionFormData:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_ui_f6791859__.ActionFormData,MessageFormData:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_ui_f6791859__.MessageFormData,ModalFormData:()=>__WEBPACK_EXTERNAL_MODULE__minecraft_server_ui_f6791859__.ModalFormData},i={},n.d(i,s),i)}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{var e=__webpack_require__(205),t=__webpack_require__(721),n=__webpack_require__(724),s=__webpack_require__(215),i=__webpack_require__(801);class a{constructor(t){if(this.exEvents={onLongTick:{subscribe:e=>{this._subscribe("onLongTick",e)},unsubscribe:e=>{this._unsubscribe("onLongTick",e)},pattern:()=>{this.events.tick.subscribe((e=>{var t;if(this.tickTime+=e.deltaTime,e.currentTick%5==0){this.tickNum++;let e={currentTick:this.tickNum,deltaTime:this.tickTime};null===(t=a.monitorMap.get("onLongTick"))||void 0===t||t.forEach((t=>{t(e)})),this.tickTime=0}}))}}},this.tickNum=0,this.tickTime=0,this.init=!1,this._server=t,this.events=e.world.events,!this.init){this.init=!0;for(let e in this.exEvents)this.exEvents[e].pattern()}}_subscribe(e,t){let n=a.monitorMap.get(e);void 0===n&&(n=[],a.monitorMap.set(e,n)),n.push(t)}_unsubscribe(e,t){var n;let s=null!==(n=a.monitorMap.get(e))&&void 0!==n?n:[];s.splice(s.findIndex(((e,n)=>{if(e===t)return!0})),1)}cancelAll(){throw new Error("Method not implemented.")}register(e,t){let n=t;return e in this.events?this.events[e].subscribe(n):e in this.exEvents?this.exEvents[e].subscribe(n):void console.warn("No event registered for name "+e)}cancel(e,t){return e in this.events?this.events[e].unsubscribe(t):e in this.exEvents?this.exEvents[e].unsubscribe(t):void 0}}a.monitorMap=new Map;var r=__webpack_require__(242),o=__webpack_require__(361),c=__webpack_require__(484);class l{static push(e){return this.queue.push(e),this}static init(e){this.delay=new c.Z(e.getEvents(),(()=>{var e;this.queue.length>0&&(null===(e=this.queue.shift())||void 0===e||e())})).delay(60),this.delay.start()}}l.queue=[];var u,h=__webpack_require__(960),d=__webpack_require__(654),m=__webpack_require__(782),g=__webpack_require__(710),_=__webpack_require__(513);class p{constructor(e){this.exEvents={itemUse:new y(this,"itemUse"),tick:new y(this,"tick"),entityHit:new y(this,"entityHit"),onHitEntity:new y(this,"onHitEntity"),onHurt:new y(this,"onHurt"),itemOnHandChange:new y(this,"itemOnHandChange"),onLongTick:new y(this,"onLongTick"),blockBreak:new y(this,"blockBreak")},this._ctrl=e,console.warn("regist events")}_subscribe(e,t){p.eventHandlers.subscribe(this._ctrl.entity,e,t)}_unsubscribe(e,t){p.eventHandlers.unsubscribe(this._ctrl.entity,e,t)}cancelAll(){console.warn("destroy all events"),p.eventHandlers.unsubscribeAll(this._ctrl.entity)}static init(e){this.eventHandlers.setEventLiseners(this.exEventSetting),this.eventHandlers.init(e)}register(e,t){let n=t;if(e in this.exEvents)return this.exEvents[e].subscribe(n);console.warn("No event registered for name "+e)}cancel(e,t){if(e in this.exEvents)return this.exEvents[e].unsubscribe(t)}}u=p,p.eventHandlers=new g.Z,p.exEventSetting={itemUse:{pattern:p.eventHandlers.registerToServerByEntity,filter:{name:"source"}},tick:{pattern:p.eventHandlers.registerToServerByServerEvent},entityHit:{pattern:p.eventHandlers.registerToServerByEntity,filter:{name:"entity"}},onHitEntity:{pattern:p.eventHandlers.registerToServerByEntity,filter:{name:"damagingEntity"},name:"entityHurt"},onHurt:{pattern:p.eventHandlers.registerToServerByEntity,filter:{name:"hurtEntity"},name:"entityHurt"},itemOnHandChange:{pattern:(e,t)=>{u.onHandItemMap=new Map,p.eventHandlers.server.getEvents().register(e,(e=>{for(let e of p.eventHandlers.monitorMap[t]){let t=u.onHandItemMap.get(e[0]),n=null==t?void 0:t[0],s=m.Z.getInstance(e[0]).getBag().getItemOnHand();(null==n?void 0:n.typeId)===(null==s?void 0:s.typeId)&&e[0].selectedSlot===(null==t?void 0:t[1])||(e[1].forEach((t=>{t(new _.a(n,m.Z.getInstance(e[0]).getBag().getItemOnHand(),e[0]))})),u.onHandItemMap.set(e[0],[s,e[0].selectedSlot]))}}))},name:"onLongTick"},onLongTick:{pattern:p.eventHandlers.registerToServerByServerEvent},blockBreak:{pattern:p.eventHandlers.registerToServerByEntity,filter:{name:"player"}}},p.onHandItemMap=new Map,p.onceItemUseOnMap=new Map;class y{constructor(e,t){this.subscribe=n=>{e._subscribe(t,n)},this.unsubscribe=n=>{e._unsubscribe(t,n)}}}__webpack_require__(855);var f=__webpack_require__(478),w=function(e,t,n,s){var i,a=arguments.length,r=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class b{constructor(t){this.entityControllers=new Map,this.clients=new Map,this.clients_nameMap=new Map,this._events=new a(this),b.isInitialized||(b.isInitialized=!0,i.Z.config=t,t.watchDog||e.system.events.beforeWatchdogTerminate.subscribe((e=>{e.cancel=!0})),i.Z.console=function(e){const t="§c",n="§5",s=(e="§f",t="")=>Array.isArray(t)?(t[0]=e+t[0],t[t.length-1]+="§r",t):e+t+"§r",i=t=>e.runCommandAsync(`tellraw @a[tag=debugger] {"rawtext": [{"text": "${t}"}]}`),a=e=>{let t="{\n";for(const i in Object.keys(e)){const a=e[i];null===a&&(t+=`${i}: null\n`),t+="object"!=typeof a?`${i}: ${"number"==typeof a?s(n,a):a}\n`:`${i}: {...}\n`}return t+"}"},r=(()=>{const e=(e,t)=>e.replace("%s",t&&"string"==typeof t?t:t.toString()),t=(e,t)=>e.replace("%d",s("§b",t&&"number"==typeof t?Math.floor(t):"string"==typeof t?Math.floor(parseInt(t)):NaN)),r=(e,t)=>e.replace("%f",s(n,"number"==typeof t?t:"string"==typeof t?Math.floor(parseFloat(t)):NaN)),o=(e,t)=>e.replace("%o",a(t));return(n,...s)=>{for(let i=0;i<s.length;i++){let a=/(%[s|d|f|o])/.exec(n)[1];"%s"===a&&(n=e(n,s[i]))||"%d"===a&&(n=t(n,s[i]))||"%f"===a&&(n=r(n,s[i]))||"%o"!==a||(n=o(n,s[i]))}return i(n)}})();function o(...e){let t=new Array(l).fill("    ").join("");return/%[s|d|f|o]/.test(e[0])?r(t+e.shift(),...e):(e=e.map((e=>"number"==typeof e?s(n,e):"object"==typeof e?a(e):e)).join("\n"),i(t+e))}let c=0,l=0,u={},h=[];return new class{constructor(){this.log=o,this.info=o}countReset(e){}debug(...e){}dir(e,t){}dirxml(...e){}groupCollapsed(...e){}table(e,t){}timeLog(e,...t){}timeStamp(e){}assert(e,n){return!e&&o(s(t,n))}clear(){o("\n\n\n\n\n\n\n\n\n\n")}error(...e){return h.length>0&&o(s(t,h.join(" > ")+"\n")),o(...s(t,e))}warn(...e){return o(...s("§e",e))}count(e){return o(e+": "+c++)}group(e=`分组${l}`){let t=o(`▼ ${e}`);return l++,t}groupEnd(){l>0&&l--}time(e="default"){u[e]=(new Date).getTime()}timeEnd(e="default"){if(u[e]){let t=((new Date).getTime()-u[e])/1e3;u[e]=null,o(`${e}: ${t} s`)}}trace(){o(h.join("\n\n"))}setTracePoint(e){let t=this.name||"anonymous";e&&(t+=` at line: ${e}`),h.push(t)}}}(i.Z),o.Z.init(this),l.init(this),h.Z.init(this),d.Z.init(this),p.init(this)),(0,f.B)(this.getEvents(),this)}say(t){e.world.say(t)}addEntityController(e,t){this.entityControllers.set(e,t)}onEntitySpawn(e){const t=this.entityControllers.get(e.entity.typeId);t&&new t(e.entity,this)}getDimension(t){return e.world.getDimension(t)}getExDimension(e){return n.Z.getInstance(this.getDimension(e))}getEvents(){return this._events}getClients(){return this.clients.values()}getPlayers(){let e=[];for(let t of this.clients)e.push(t[1].player);return e}findClientByName(e){return this.clients_nameMap.get(e)}findClientByPlayer(e){for(let t of this.clients)if(t[1].player==e)return t[1]}onClientJoin(e){let t=e.player,n=r.Z.randomUUID(),s=this.newClient(n,t);this.clients.set(n,s),this.clients_nameMap.set(t.name,s)}onClientLeave(e){let t=this.findClientByName(e.playerName);void 0!==t?(t.onLeave(),this.clients.delete(t.clientId),this.clients_nameMap.delete(e.playerName)):i.Z.console.error(e.playerName+"client is not exists")}newClient(e,t){return new s.Z(this,e,t)}setTimeout(e,t){let n=0,s=i=>{n+=1e3*i.deltaTime,n>t&&(this.getEvents().events.tick.unsubscribe(s),e())};this.getEvents().events.tick.subscribe(s)}}w([(0,f.K)("entityCreate"),E("design:type",Function),E("design:paramtypes",[e.EntityCreateEvent]),E("design:returntype",void 0)],b.prototype,"onEntitySpawn",null),w([(0,f.K)("playerJoin"),E("design:type",Function),E("design:paramtypes",[e.PlayerJoinEvent]),E("design:returntype",void 0)],b.prototype,"onClientJoin",null),w([(0,f.K)("playerLeave"),E("design:type",Function),E("design:paramtypes",[e.PlayerLeaveEvent]),E("design:returntype",void 0)],b.prototype,"onClientLeave",null);var I=__webpack_require__(475);class A{constructor(e,n,s){if(this._width=new t.Z,this._tmpA=new t.Z,this._tmpC=new t.Z,this._judgeWidth=new t.Z,this._tmpD=new t.Z,this.start=e.clone(),this.end=n.clone(),s)this.start.x>this.end.x&&([this.start.x,this.end.x]=[this.end.x,this.start.x]),this.start.y>this.end.y&&([this.start.y,this.end.y]=[this.end.y,this.start.y]),this.start.z>this.end.z&&([this.start.z,this.end.z]=[this.end.z,this.start.z]),this.end.add(1,1,1);else{if(this.end.x<0||this.end.y<0||this.end.z<0)throw new Error("Invalid value (x,y,z < 0)");this.end.add(this.start)}this.resetRotation()}center(){return this.end.clone().sub(this.start).scl(.5).add(this.start)}contains(e){return this.start.x<=e.x&&this.start.z<=e.z&&e.x<=this.end.x&&e.z<=this.end.z&&this.start.y<=e.y&&e.y<=this.end.y}resetRotation(){this.setMatrix4(new I.Z([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]))}turnUp(){this.setMatrix4(this.mat.mul(new I.Z([[1,0,0,0],[0,0,-1,0],[0,1,0,0],[0,0,0,1]])))}turnRight(){this.setMatrix4(this.mat=this.mat.mul(new I.Z([[0,0,-1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]])))}turnFrontClockwise(){this.setMatrix4(this.mat.mul(new I.Z([[0,-1,0,0],[1,0,0,0],[0,0,1,0],[0,0,0,1]])))}pointAtStart(e){this.end.sub(this.start).add(e),this.start.set(e)}calculateWidth(){return this._width.set(this.end).sub(this.start).mul(this.mat).abs(),this._judgeWidth.set(1,1,1).mul(this.mat),this.getWidth()}getWidth(){return this._width}calculateAbsPos(e,t=this._tmpA){return this.calculateRelPos(this._tmpC.sub(this.start),t).add(this.start)}calculateRelPos(e,t=this._tmpA){t.set(e).mul(this.mat);const n=this.getWidth();return t.x=this._judgeWidth.x<0?n.x+t.x-1:t.x,t.y=this._judgeWidth.y<0?n.y+t.y-1:t.y,t.z=this._judgeWidth.z<0?n.z+t.z-1:t.z,t}forEachArea(e,t){const n=e.clone();n.pointAtStart(this._tmpD.set(0,0,0));const s=this.getWidth(),i=n.getWidth();for(let e=0;e<=s.x-i.x;e++)for(let a=0;a<=s.y-i.y;a++)for(let r=0;r<=s.z-i.z;r++)n.pointAtStart(this._tmpD.set(e,a,r).add(this.start)),t(n)}clone(){const e=new A(this.start.clone(),this.end.clone().sub(1,1,1),!0);return e.setMatrix4(this.mat.clone()),e}setMatrix4(e){this.mat=e,this.calculateWidth()}static randomPoint(e,t=0){if(0===e.length)throw new Error("empty array");let n=e[Math.floor(Math.random()*e.length)];if(A.tempV.set(n.start).add(t,t,t),A.tempP.set(n.end).sub(t,t,t),A.tempP.sub(this.tempV),A.tempP.x<0||A.tempP.y<0||A.tempP.z<0)throw new Error("Bound is too large");return A.tempP.set(A.tempP.x*Math.random(),A.tempP.y*Math.random(),A.tempP.z*Math.random()),A.tempV.add(A.tempP).clone()}}A.tempV=new t.Z,A.tempP=new t.Z;class v{constructor(){this.direction=v.DIRECTION_AROUND|v.DIRECTION_LAY}clone(){let e=new v;return e.dimension=this.dimension,e.structure=this.structure,e.analysisMap=this.analysisMap,e.direction=this.direction,e.area=this.area,e}setDimension(e){return this.dimension=n.Z.getInstance(e),this}find(){if(void 0===this.dimension)throw new Error("dimension is undefined");if(void 0===this.structure)throw new Error("structure is undefined");if(void 0===this.analysisMap)throw new Error("analysisMap is undefined");if(void 0===this.area)throw new Error("area is undefined");const e=new A(new t.Z,new t.Z(this.structure[0][0].length,this.structure[0].length,this.structure.length));let n,s=e.clone();if(this.direction>>0&1)if(this.direction>>6&1){if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n}else if(n=this.searchOnce(s))return n;if(s=e.clone(),s.turnRight(),s.turnRight(),this.direction>>1&1)if(this.direction>>6&1){if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n}else if(n=this.searchOnce(s))return n;if(s=e.clone(),s.turnRight(),this.direction>>2&1)if(this.direction>>6&1){if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n}else if(n=this.searchOnce(s))return n;if(s=e.clone(),s.turnRight(),s.turnRight(),s.turnRight(),this.direction>>3&1)if(this.direction>>6&1){if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n}else if(n=this.searchOnce(s))return n;if(s=e.clone(),s.turnUp(),this.direction>>4&1){if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n}if(s=e.clone(),s.turnUp(),s.turnUp(),s.turnUp(),this.direction>>5&1){if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n;if(s.turnFrontClockwise(),n=this.searchOnce(s))return n}return n}searchOnce(n){var s,i;const a=null!==(s=this.structure)&&void 0!==s?s:[[""]],r=new t.Z,o=new t.Z,c=this.dimension;let l;return null===(i=this.area)||void 0===i||i.forEachArea(n,(t=>{var n,s,i;for(o.z=0;o.z<a.length;o.z++)for(o.y=0;o.y<a[o.z].length;o.y++){const l=a[o.z][o.y];for(o.x=0;o.x<l.length;o.x++){const a=l.charAt(o.x);if(" "!=a&&(t.calculateRelPos(o,r).add(t.start),(null===(n=null==c?void 0:c.getBlock(r))||void 0===n?void 0:n.typeId)!==(null!==(i=null===(s=this.analysisMap)||void 0===s?void 0:s.get(a))&&void 0!==i?i:e.MinecraftBlockTypes.air.id)))return}}l=t.clone()})),l}setStructure(e){return this.structure=e,this.structure.forEach((e=>{e.reverse()})),this}analysis(e){if(e instanceof Map)this.analysisMap=e;else{const t=new Map;for(const n in e)t.set(n,e[n]);this.analysisMap=t}return this}putStructure(n){if(void 0===this.dimension)throw new Error("dimension is undefined");if(void 0===this.analysisMap)throw new Error("analysisMap is undefined");if(void 0===this.structure)throw new Error("structure is undefined");const s=new t.Z,i=new t.Z;for(i.z=0;i.z<this.structure.length;i.z++)for(i.y=0;i.y<this.structure[i.z].length;i.y++){const t=this.structure[i.z][i.y];for(i.x=0;i.x<t.length;i.x++){const a=t.charAt(i.x);if(" "==a)continue;n.calculateRelPos(i,s).add(n.start);let r=this.analysisMap.get(a),o=0,c=null==r?void 0:r.indexOf("|");r&&c&&-1!==c&&(o=parseInt(null==r?void 0:r.slice(c+1))),this.dimension.setBlock(s,null!=r?r:e.MinecraftBlockTypes.air.id,o)}}return this}setArea(e){return this.area=e,this}setDirection(e){return this.direction=e,this}}v.DIRECTION_SOUTH=Math.pow(2,0),v.DIRECTION_NORTH=Math.pow(2,1),v.DIRECTION_EAST=Math.pow(2,2),v.DIRECTION_WEST=Math.pow(2,3),v.DIRECTION_UP=Math.pow(2,4),v.DIRECTION_BUTTOM=Math.pow(2,5),v.DIRECTION_ALLOW_ROTATE=Math.pow(2,6),v.DIRECTION_AROUND=v.DIRECTION_WEST|v.DIRECTION_EAST|v.DIRECTION_SOUTH|v.DIRECTION_NORTH,v.DIRECTION_AROUND_MIRROR=v.DIRECTION_EAST|v.DIRECTION_NORTH,v.DIRECTION_LAY=v.DIRECTION_UP|v.DIRECTION_BUTTOM,v.DIRECTION_LAY_MIRROR=v.DIRECTION_UP;var T=__webpack_require__(703),M=__webpack_require__(418),D=__webpack_require__(409),C=__webpack_require__(647);class S{constructor(e,t){this.time=1e3,this.timeOut=e,this.looper=t}getDelay(){return this.time}delay(e){return this.time=e,this}isStarted(){return void 0!==this.func}startOnce(){let e=0;this.isStarted()||(this.func=t=>{e+=1e3*t.deltaTime,e>=this.time&&(this.stop(),this.looper())},this.timeOut.register("tick",this.func))}start(){let e=0;this.isStarted()||(this.func=t=>{e+=1e3*t.deltaTime,e>=this.time&&(this.looper(),e=0)},this.timeOut.register("tick",this.func))}stop(){this.func&&(this.timeOut.cancel("tick",this.func),this.func=void 0)}}var x=__webpack_require__(516);class k{static createServer(e,t){let n=new e(t);this.serverMap.set(e,n)}static postMessageBetweenServer(){}static postMessageBetweenClient(e,t,n,s){let i=this.serverMap.get(t);if(!i)return;let a=i.findClientByPlayer(e.player);if(a)for(let e of x.Z.keys(a))Reflect.getMetadata("exportName",a,e)===n&&Reflect.get(a,e).apply(a,s)}}function N(e){return function(t,n,s){Reflect.defineMetadata("exportName",e,t,n)}}k.serverMap=new Map;class B{static from(e,t){let n;try{n=JSON.parse(e)}catch(e){n=t}return n}static to(e){return JSON.stringify(e)}}class R{constructor(e){this.manager=e}load(){for(const e of this.manager.getTags())if(e.startsWith("__cache:"))return this.tagFrom=e,e.substring("__cache:".length)}get(e){if(this.cache)return this.cache;{let t=this.load();return t?(this.cache=B.from(t,e),this.cache):(this.cache=e,this.tagFrom="__cache:"+JSON.stringify(this.cache),this.manager.addTag(this.tagFrom),e)}}save(){let e="__cache:"+B.to(this.cache);e!==this.tagFrom&&(this.manager.removeTag(this.tagFrom),this.manager.addTag(e),this.tagFrom=e)}}var O=__webpack_require__(344);class U{constructor(e){this.entity=new O.Z(""),this.objective=e,e.create("cache:"+e.name),U.varMap.has(e.name)||U.varMap.set(e.name,new Map),this.useMap=U.varMap.get(e.name)}debug(){this.objective.setDisplay()}setBoolean(e,t){this.setNumber(e,t?1:0)}getBoolean(e){return 1===this.getNumber(e)}setNumber(e,t){this.entity.nameTag=e,this.entity.getScoresManager().setScoreAsync(this.objective,t),this.useMap.set(e,t)}getNumber(e){return this.entity.nameTag=e,this.useMap.has(e)||this.useMap.set(e,this.entity.getScoresManager().getScore(this.objective)),this.useMap.get(e)}deleteNumber(e){return this.entity.nameTag=e,this.useMap.delete(e),this.entity.getScoresManager().deleteScoreAsync(this.objective)}}U.varMap=new Map;class P extends U{get playerCanTp(){return this.getBoolean("playerCanTp")}set playerCanTp(e){this.setBoolean("playerCanTp",e)}get tpNeedItem(){return this.getBoolean("tpNeedItem")}set tpNeedItem(e){this.setBoolean("tpNeedItem",e)}get entityCleaner(){return this.getBoolean("entityCleaner")}set entityCleaner(e){this.setBoolean("entityCleaner",e)}get deathRecord(){return this.getBoolean("deathRecord")}set deathRecord(e){this.setBoolean("deathRecord",e)}get tpPointRecord(){return this.getBoolean("tpPointRecord")}set tpPointRecord(e){this.setBoolean("tpPointRecord",e)}get damageShow(){return this.getBoolean("damageShow")}set damageShow(e){this.setBoolean("damageShow",e)}get ownerExists(){return this.getBoolean("ownerExists")}set ownerExists(e){this.setBoolean("ownerExists",e)}get entityCleanerLeastNum(){return this.getNumber("entityCleanerLeastNum")||200}set entityCleanerLeastNum(e){this.setNumber("entityCleanerLeastNum",e)}get entityCleanerStrength(){return this.getNumber("entityCleanerStrength")||5}set entityCleanerStrength(e){this.setNumber("entityCleanerStrength",e)}get entityCleanerDelay(){return this.getNumber("entityCleanerDelay")||30}set entityCleanerDelay(e){this.setNumber("entityCleanerDelay",e)}get worldSeed(){return Math.abs(this.getNumber("worldSeed")||(this.worldSeed=Math.floor(Math.random()*C.Z.MAX_VALUE)))}set worldSeed(e){this.setNumber("worldSeed",e)}get ruinsExsitsData(){return this.getNumber("ruinsExsitsData")||0}set ruinsExsitsData(e){this.setNumber("ruinsExsitsData",e)}}class L{static clamp(e,t,n){return Math.max(t,Math.min(n,e))}static IEEEremainder(e,t){return e-t*Math.round(e/t)}static isNumber(e){return/^\d+(\.\d+)?$/.test(e)&&/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e)}static zeroIfNaN(e){return"string"==typeof e&&(e=parseFloat(e)),void 0===e||isNaN(e)?0:e}static randomInteger(e,t){return e+Math.floor(Math.random()*(t-e+1))}}var Z=__webpack_require__(38);class z{constructor(e){this.item=e}append(e){let t=this.getLore();t.push(e),this.setLore(t)}insert(e,t){let n=this.getLore();n.splice(e,0,t),this.setLore(n)}getLore(){return this.item.getLore()}setLore(e){this.item.setLore(e)}search(e){let t=this.getLore();for(let n=0;n<t.length;n++)if(t[n].startsWith(e+" : "))return new j(this.item,n)}getValueUseDefault(e){let t=this.search(e);if(t)return t.get().substring(e.length+3)}hasTag(e){let t=this.getLore();for(let n of t)if(n.startsWith(e))return!0;return!1}getValueUseRepeat(e){let t=this.getValueUseDefault(e);return t?t.length:0}getValueUseMap(e,t){let n="  ",s=this.search(e);if(s)for(;s.hasNext()&&(s.next(),s.get().startsWith(n));)if(s.get().startsWith(n+t+" : "))return s.get().substring(n.length+3+t.length)}setValueUseDefault(e,t){let n=this.search(e);n?n.revise(e+" : "+t).set():this.append(e+" : "+t)}setTag(e){this.hasTag(e)||this.append(e)}setValueUseRepeat(e,t,n){this.setValueUseDefault(e,new Array(n).fill(t).join(""))}*entries(e){if(e){let t="  ",n=this.search(e);if(!n)return;for(;n.hasNext()&&(n.next(),n.get().startsWith(t));)yield[...n.get().trim().split(" : ")]}else for(let e of this.getLore())yield[...e.trim().split(" : ")]}setValueUseMap(e,t,n){let s="  ",a=this.search(e);if(!a)return this.append(e+" : "),void this.append(s+t+" : "+n);for(;a.hasNext()&&(a.next(),a.get().startsWith(s));)if(a.get().startsWith(s+t+" : "))return void a.revise(s+t+" : "+n).set();a=this.search(e),a?this.insert(a.index+1,s+t+" : "+n):i.Z.console.error("Could not find "+e+" : "+n+" in lore")}delete(e){let t=this.search(e);if(!t)return;let n=1,s=t.index;for(;t.hasNext()&&(t.next(),t.get().startsWith("  "));)n++;let i=this.getLore();i.splice(s,n),this.setLore(i)}}class j{constructor(e,t){this.item=e,this.lore=e.getLore(),this.index=t}set(){this.item.setLore(this.lore)}revise(e){return this.lore[this.index]=e,this}get(){return this.lore[this.index]}hasNext(){return this.index+1<this.lore.length}next(){this.index++}}class H extends z{setTag(e){super.setTag("§r§n§6"+e)}hasTag(e){return super.hasTag(e.startsWith("§")?e:"§r§n§6"+e)}getValueUseMap(e,t){let n=super.getValueUseMap("§r§l§f"+e,"§r§o§b"+t);return(null==n?void 0:n.startsWith("§"))?n.substring(6):n}setValueUseMap(e,t,n){super.setValueUseMap("§r§l§f"+e,"§r§o§b"+t,"§r§o§e"+n)}*entries(e){for(let t of super.entries(e))yield[t[0].startsWith("§")?t[0].substring(6):t[0],t[1].startsWith("§")?t[1].substring(6):t[1]]}search(e){let t=this.getLore();e=e.startsWith("§")?e.substring(6):e;for(let n=0;n<t.length;n++)if((t[n].startsWith("§")?t[n].substring(6):t[n]).startsWith(e+" : "))return new j(this.item,n)}}class W{constructor(){this.pointUsed=0,this.occupation=F.EMPTY,this.talents=[]}static getDescription(e,t,n,s){let i=W.calculateTalent(t,n,s);switch(n){case V.VIENTIANE:return(0,Z.Z)(e.talentWanxiangDesc,`§o§e${i}§r`);case V.CLOAD_PIERCING:return(0,Z.Z)(e.talentChuanyunDesc,`§o§b${i}％§r`);case V.ARMOR_BREAKING:return(0,Z.Z)(e.talentChuanjiaDesc,`§o§b${i}％§r`);case V.SANCTION:return(0,Z.Z)(e.talentZhicaiDesc,`§o§b${i}％§r`);case V.DEFENSE:return(0,Z.Z)(e.talentFangyuDesc,`§o§b${i}％§r`);case V.CHARGING:return(0,Z.Z)(e.talentChongnengDesc,`§o§b${i}％§r`);case V.RELOAD:return(0,Z.Z)(e.talentChongzhuangDesc,`§o§b${i}％§r`);case V.SOURCE:return(0,Z.Z)(e.talentYuanquanDesc,`§o§b${i}％§r`);case V.SUDDEN_STRIKE:return(0,Z.Z)(e.talentTuxiDesc,`§o§b${i}％§r`);case V.REGENERATE:return(0,Z.Z)(e.talentZaishengDesc,`§o§e${i}§r`);default:return""}}static getLevel(e,t){for(let n of e.talents)if(n.id===t)return n.level;return 0}static hasOccupation(e){return e.occupation.id!==F.EMPTY.id}static chooseOccupation(e,t){e.occupation=t;let n=new Set([V.VIENTIANE,V.CLOAD_PIERCING,V.ARMOR_BREAKING,V.SANCTION,V.DEFENSE,V.CHARGING,V.RELOAD,V.SOURCE]);for(let e of t.talentId)n.add(e);n.forEach((t=>{e.talents.push(new V(t,0))}))}static calculateTalent(e,t,n){switch(t){case V.VIENTIANE:return n*(W.isOccupationTalent(e,t)?20:10)/40;case V.CLOAD_PIERCING:return n*(W.isOccupationTalent(e,t)?80:40)/40;case V.ARMOR_BREAKING:return n*(W.isOccupationTalent(e,t)?20:10)/40;case V.SANCTION:return n*(W.isOccupationTalent(e,t)?50:25)/40;case V.DEFENSE:return n*(W.isOccupationTalent(e,t)?45:25)/40;case V.CHARGING:return n*(W.isOccupationTalent(e,t)?30:15)/40;case V.RELOAD:return n*(W.isOccupationTalent(e,t)?25:15)/40;case V.SOURCE:return n*(W.isOccupationTalent(e,t)?100:40)/40;case V.SUDDEN_STRIKE:return n*(W.isOccupationTalent(e,t)?80:0)/40;case V.REGENERATE:return n*(W.isOccupationTalent(e,t)?20:0)/40;default:return 0}}static calculateTalentToLore(e,t,n,s){let i=new H(n);i.delete("addition");for(let n of e){let e=0,a=L.zeroIfNaN(i.getValueUseMap("enchanting",V.getCharacter(s,n.id)))+n.level;e=W.calculateTalent(t,n.id,a);let r=L.zeroIfNaN(i.getValueUseMap("enchanting",V.getCharacter(s,n.id))),o=Math.round(r+10*e)/10;0!==o&&i.setValueUseMap("addition",V.getCharacter(s,n.id),r+" -> "+o)}}static isOccupationTalent(e,t){return-1!==e.talentId.indexOf(t)}}class V{constructor(e,t){this.id=e,this.level=t}static getCharacter(e,t){switch(t){case V.VIENTIANE:return e.talentWanxiang;case V.CLOAD_PIERCING:return e.talentChuanyun;case V.ARMOR_BREAKING:return e.talentChuanjia;case V.SANCTION:return e.talentZhicai;case V.DEFENSE:return e.talentFangyu;case V.CHARGING:return e.talentChongneng;case V.RELOAD:return e.talentChongzhuang;case V.SOURCE:return e.talentYuanquan;case V.SUDDEN_STRIKE:return e.talentTuxi;case V.REGENERATE:return e.talentZaisheng;default:return e.talentWeizhi}}}V.VIENTIANE=1,V.CLOAD_PIERCING=2,V.ARMOR_BREAKING=3,V.SANCTION=4,V.DEFENSE=5,V.CHARGING=6,V.RELOAD=7,V.SOURCE=8,V.SUDDEN_STRIKE=9,V.REGENERATE=10;class F{constructor(e,t){this.id=e,this.talentId=t}getCharacter(e){switch(this.id){case 0:return e.occupationEmpty;case 1:return e.occupationGuard;case 2:return e.occupationWarrior;case 3:return e.occupationAssassin;case 4:return e.occupationArcher;case 5:return e.occupationWarlock;case 6:return e.occupationPriest}return""}}F.EMPTY=new F(0,[]),F.GUARD=new F(1,[V.VIENTIANE,V.ARMOR_BREAKING]),F.WARRIOR=new F(2,[V.SANCTION,V.DEFENSE]),F.ASSASSIN=new F(3,[V.SANCTION,V.SUDDEN_STRIKE]),F.ARCHER=new F(4,[V.CLOAD_PIERCING,V.ARMOR_BREAKING]),F.WARLOCK=new F(5,[V.RELOAD,V.SOURCE,V.CHARGING]),F.PRIEST=new F(6,[V.SOURCE,V.REGENERATE]),F.keys=[F.GUARD,F.WARRIOR,F.ASSASSIN,F.ARCHER,F.WARLOCK,F.PRIEST];class G{constructor(){this.talent=new W}}const $='冬之纪行诗最终用户许可协议\n\n一、为保护玩家乐趣、利益及维护开发者利益，我们需要这些最终用户许可条款为冬之纪行诗Add-Ons(以下简称本作品)的下载和使用制定一些规则。本许可是您与本作品的开发者(包括但不限于剑侠、LiLeyi及其他未列出或将来加入开发的人员，以下简称我们)之间达成的协议，描述使用游戏的条款和条件，这些条款应在中国法律所允许的范围内最大程度地适用。\n二、由于网络服务的特殊性，您同意本协议以电子协议形式签订。您一旦以任何形式表明同意，即视为您同意并已经接受本协议的全部条款；\n三、本协议的订立、履行、解释及争议的解决均适用中华人民共和国法律并排除其他一切冲突法的适用。如您就本协议内容或其执行有任何疑问，请与我们联系。您因使用我们服务所产生的及与本协议相关的争议，应由我们与您友好协商解决；如协商不成，任何一方均可向合同签订地有管辖权的人民法院提起诉讼。\n\n您知晓并同意：\n一、知识产权\n1.本作品是基于游戏"MineCraft"创作的 免费 内容拓展模组，在未取得我们允许的情况下，您不得将本作品用于商业用途/盈利。\n\n2.阅览本作品的代码以学习交流是允许的，但在未取得我们允许的情况下，您不得以任何方式窃取本作品中的代码、美术、音乐、文档等内容后将其复制、分发、发行、出租、展览、表演、广播、修改、改编、销售、运营、转许可、通过信息网络传播。\n\n3.您可以就本作品向我们提出有关建议，但这并不意味着您的建议会被采纳，我们可以通过所需的任何方式使用或不使用您的建议，且不必向您支付报酬。如果您认为我们应为您的建议支付报酬，请提前说明该要求，在我们以书面形式答复后再提交该建议，否则您提交该建议造成的损失将由您个人承担。\n\n二、我们的权利和义务\n1.下载的提供\n1).您可以直接从MCPEDL及我们所授权的其他网站/平台/渠道获取本作品\n2).如果您从未经我们授权的第三方获取本作品或与本作品名称相同的内容，我们无法保证该软件能够正常使用，并对因此给您造成的损失不予负责。\n3).我们会不断丰富本作品的内容、终端、形式等。当您使用本服务时，您应选择与您的终端、系统等相匹配的作品/游戏版本，否则，您可能无法正常使用本作品；我们可能会在本作品的完成之前发布测试版本，因此它可能包含BUG，这是无法避免的。\n2.作品的更新\n1).为了增进玩家体验、完善作品内容，我们  可能  不断努力开发新的服务，并为您不时提供作品更新。\n2).为了改善用户体验或提高服务安全性、保证功能的一致性等目的，我们有权对本作品进行更新，或者对作品的部分功能效果、服务内容进行改变。\n\n三、其他\n1.当暴露在特定光影图案或闪光光亮下时，有极小部分人群会引发癫痫。这种情形可能是由于某些未查出的癫痫症状引起，即使该人员没有患癫痫病史也有可能造成此类病症。如果您的家人或任意家庭成员有过类似症状，请在请在进行游戏前咨询您的医生或医师。如果您在游戏过程中出现任何症状，包括头晕、目眩、眼部或肌肉抽搐、失去意识、失去方向感、抽搐或出现任何自己无法控制的动作，请立刻停止游戏并在继续游戏前咨询您的医生或医师，否则所造成的一切后果由您自己承担。\n2.您在游戏MineCraft中的存档可能会由于装载本作品的更新而损坏，在更新前请自行备份您的存档，否则所造成的一切后果由您自己承担。\n3. 本协议内容同时包括本协议附件中的协议或规则，我们可能不断发布的关于本服务的其他相关协议、规则等内容。上述内容一经正式发布，即为本协议不可分割的组成部分，您同样应当遵守。\n\n您理解并同意，英文版为机器翻译内容，若本协议有中文、英文等多个语言版本，相应内容不一致的，均以中文版的内容为准。\n\n1、 In order to protect the fun and interests of players and the interests of developers, we need these end-user license terms to formulate some rules for the download and use of winter chronicles add ons (hereinafter referred to as this work). This license is an agreement between you and the developers of this work (including but not limited to AA swordsman, LiLeyi and other people not listed or who will join the development in the future, hereinafter referred to as US). It describes the terms and conditions of using the game. These terms shall be applied to the maximum extent permitted by Chinese laws.\n2、 Due to the particularity of network services, you agree that this agreement is signed in the form of electronic agreement. Once you express your consent in any form, it shall be deemed that you agree and have accepted all the terms of this Agreement;\n3、 The conclusion, performance, interpretation and dispute settlement of this Agreement shall be governed by the laws of the people\'s Republic of China, excluding the application of other conflict laws. If you have any questions about the contents of this agreement or its implementation, please contact us. Any dispute arising from your use of our services and related to this Agreement shall be settled through friendly negotiation between us and you; If the negotiation fails, either party may bring a lawsuit to the people\'s court with jurisdiction at the place where the contract is signed.\nYou understand and agree that:\n1、 Intellectual property\n1. This work is a free content expansion module created based on the game "minecraft". You may not use this work for commercial purposes / profits without our permission.\n2. It is allowed to read the code of this work to learn and communicate, but without our permission, you shall not steal the code, art, music, documents and other contents of this work in any way, and then copy, distribute, distribute, rent, exhibit, perform, broadcast, modify, adapt, sell, operate, sublicense, and disseminate them through the information network.\n3. You can make suggestions to us about this work, but this does not mean that your suggestions will be adopted. We can use or not use your suggestions in any way we need, and do not need to pay you any remuneration. If you think that we should pay for your proposal, please explain this requirement in advance and submit the proposal after we reply in writing. Otherwise, you will bear the losses caused by submitting the proposal.\n2、 Our rights and obligations\n1. Provision of download\n1) . you can directly obtain this work from mcpedl and other websites / platforms / channels authorized by us\n2). If you have never obtained this work or the content with the same name as this work from a third party authorized by us, we cannot guarantee the normal use of this software and will not be responsible for the losses caused to you.\n3). We will constantly enrich the content, terminal and form of this work. When you use this service, you should select a work / game version that matches your terminal, system, etc., otherwise, you may not be able to use this work normally; We may release the test version before the completion of this work, so it may contain bugs, which is unavoidable.\n2. Update of works\n1). In order to improve the player\'s experience and improve the content of the work, we may constantly strive to develop new services and provide you with work updates from time to time.\n2). In order to improve the user experience, improve the service security and ensure the consistency of functions, we have the right to update the work, or change some of the functional effects and service contents of the work.\n3、 Other\n1. When exposed to specific light and shadow patterns or flash light, a small part of the population will cause epilepsy. This situation may be caused by some undetected epileptic symptoms. Even if the person has no history of epilepsy, it may cause such symptoms. If your family or any family member has similar symptoms, please consult your doctor or physician before playing the game. If you have any symptoms during the game, including dizziness, dizziness, eye or muscle convulsions, loss of consciousness, loss of direction, convulsions, or any movement beyond your control, please stop the game immediately and consult your doctor or physician before continuing the game. Otherwise, you will bear all the consequences.\n2. Your archives in the game minecraft may be damaged due to loading the updates of this work. Please back up your archives before updating, otherwise you will bear all the consequences.\n3. The contents of this agreement also include the agreements or rules in the annexes to this agreement, and other relevant agreements and rules on this service that we may continuously publish. Once the above contents are officially released, they shall be an integral part of this agreement, and you shall also abide by them.\n',X={zh:{ruinDesertCmd_SELF:"原地",ruinDesertCmd_TP:"传送",ruinDesertCmd_BLAST:"生成爆炸",ruinDesertCmd_EFFECT:"设置药水",ruinDesertCmd_DAMAGE:"造成伤害",ruinDesertCmd_HEALTH_ADD:"增加血量",ruinDesertCmd_HEALTH_REMOVE:"减少血量",ruinDesertCmd_FACING_ADD_2:"面向+2",ruinDesertCmd_FACING_ADD_4:"面向+4",ruinDesertCmd_FACING_ADD_6:"面向+6",ruinDesertCmd_FACING_ADD_8:"面向+8",ruinDesertCmd_FACING_ADD_10:"面向+10",ruinDesertCmd_FACING_ADD_12:"面向+12",ruinDesertCmd_FACING_ADD_16:"面向+16",ruinDesertCmd_FACING_ADD_20:"面向+20",ruinDesertCmd_FACING_ADD_28:"面向+28",ruinDesertCmd_FACING_ADD_32:"面向+32",ruinDesertCmd_Y_ADD_4:"Y+4",ruinDesertCmd_Y_ADD_8:"Y+8",ruinDesertCmd_Y_ADD_16:"Y+16",ruinDesertCmd_Y_ADD_32:"Y+32",ruinDesertCmd_Y_REMOVE_4:"Y-4",ruinDesertCmd_Y_REMOVE_8:"Y-8",ruinDesertCmd_Y_REMOVE_16:"Y-16",ruinDesertCmd_Y_REMOVE_32:"Y-32",ruinDesertCmd_WEAKNESS:"虚弱",ruinDesertCmd_STRENGTH:"力量",ruinDesertCmd_BLIND:"失明",ruinDesertCmd_SPEED:"速度",ruinDesertCmd_DEFENSE:"防御",ruinDesertCmd_WITHER:"凋零",ruinDesertCmd_EXECUTE:"检测",ruinDesertCmd_VALUE_1:"值: 1",ruinDesertCmd_VALUE_2:"值: 2",ruinDesertCmd_VALUE_4:"值: 4",ruinDesertCmd_VALUE_8:"值: 8",ruinDesertCmd_VALUE_16:"值: 16",ruinDesertCmd_VALUE_32:"值: 32",ruinDesertCmd_VALUE_3:"值: 3",ruinDesertCmd_VALUE_5:"值: 5",ruinDesertCmd_VALUE_10:"值: 4",ruinDesertCmd_VALUE_64:"值: 64",ruinDesertCmd_GUARD_POS:"守卫者位置",maxSingleDamage:"最大单体伤害",maxSecondaryDamage:"最大秒伤",talentWanxiang:"万象",talentChuanyun:"穿云",talentChuanjia:"穿甲",talentZhicai:"制裁",talentFangyu:"防御",talentChongneng:"充能",talentChongzhuang:"重装",talentYuanquan:"源泉",talentTuxi:"突袭",talentZaisheng:"再生",talentWeizhi:"未知",talentWanxiangDesc:"生命值增加 {0} 点",talentChuanyunDesc:"对0 ~ 64距离远处目标造成 {0} 额外伤害，距离越近额外伤害越小",talentChuanjiaDesc:"对目标造成 {0} * (自身最大生命值) 额外伤害",talentZhicaiDesc:"对0 ~ 16距离远处目标造成 {0} 额外伤害，距离越远额外伤害越小",talentFangyuDesc:"受到一切伤害减免 {0} ，致命伤无效",talentChongnengDesc:"武器冷却回复加快 {0}",talentChongzhuangDesc:"盔甲冷却回复加快 {0}",talentYuanquanDesc:"法力值回复加快 {0}",talentTuxiDesc:"攻击造成额外 {0} 伤害，该效果冷却10s",talentZaishengDesc:"每10s为18半径内血量最少玩家回复 {0} 点血量，敌对模式下该技能不发动",talentWeizhiDesc:"未知",occupationEmpty:"空",occupationGuard:"近卫",occupationWarrior:"战士",occupationAssassin:"暗杀者",occupationArcher:"射手",occupationWarlock:"术士",occupationPriest:"牧师",menuUISubtitleGonggao:"公告",menuUIMsgGonggao1:"大部分boss召唤方式更新，请前往游戏指南查看",menuUISubtitleHuodong:"活动",menuUISubtitleBanben:"版本",menuUIMsgBanben1:"版本信息",menuUIMsgBanben2:"当前Addon版本: ",menuUIMsgBanben3:"补丁包信息请到以下链接查看：",menuUIMsgBanben4:"版本须知",menuUIMsgBanben6:"致谢名单",menuUIMsgBanben5:"冬诗可能存在卡顿现象，因此我们建议您先输入/tag @s add owner，再前往菜单设置中，打开实体清理选项。如果您担心重要实体被清，请不要开启。",menuUIMsgBailan1:"主页",menuUIMsgBailan2:"宣传赢好礼",menuUIMsgBailan3:"本作品是耗时三年制作的大型模组，但奈何并无人气，我们决定举办本活动",menuUIMsgBailan4:"征稿活动：",menuUIMsgBailan5:"版本",menuUIMsgBailan6:"最终用户许可协议",menuUIMsgBailan7:"为什么无法召唤BOSS",menuUIMsgBailan8:"现在部分boss有专属的召唤者方块了。在他们的群系中，概率生成BOSS建筑，建筑内有召唤者方块。使用 钥匙 类物品点击即可召唤boss。对于未激活的召唤者方块，使用特定物品可以再次激活。如果找不到特定建筑，说明脸黑。请在特定的群系找。",menuUIMsgBailan9:"为什么那么卡",menuUIMsgBailan10:"卡顿多半是因为实体过多导致的。请尝试在 管理 界面（只有带有owner tag的玩家才能进入）打开实体清理功能，并调整最低保留实体数。建议350，配置好就往上调，配置差就往下调。",menuUIMsgBailan11:"如何升级、天赋点数怎么获得",menuUIMsgBailan12:"可以通过升级台挂机，以及在线时间来升级。升级可获得点数。",menuUIMsgBailan13:"个人",menuUIMsgBailan14:"信息",menuUIMsgBailan15:"是",menuUIMsgBailan16:"否",menuUIMsgBailan17:"是",menuUIMsgBailan18:"否",menuUIMsgBailan19:"加成",menuUIMsgBailan20:"等级效果",menuUIMsgBailan21:"到达一定等级可以获得药水增益",menuUIMsgBailan22:"等级效果 开",menuUIMsgBailan23:"粒子效果",menuUIMsgBailan24:"可以通过合成相应的药水来获得粒子，用腻了再来这里取消",menuUIMsgBailan25:"去除火焰",menuUIMsgBailan26:"去除光环",menuUIMsgBailan27:"去除符文",menuUIMsgBailan28:"去除爱心",menuUIMsgBailan29:"天赋",menuUIMsgBailan30:"剩余可使用点数 ： ",menuUIMsgBailan31:"选择你的职业",menuUIMsgBailan32:"传送点",menuUIMsgBailan33:"传送点记录",menuUIMsgBailan34:"传送点：",menuUIMsgBailan35:"前往点",menuUIMsgBailan36:"§b背包无传送石，传送失败",menuUIMsgBailan37:"§b传送成功",menuUIMsgBailan38:"备注点",menuUIMsgBailan39:"输入备注",menuUIMsgBailan40:"删除点",menuUIMsgBailan41:"记录当前点",menuUIMsgBailan42:"禁止记录传送点",menuUIMsgBailan43:"死亡点：",menuUIMsgBailan44:"前往点",menuUIMsgBailan45:"禁止死亡回溯",menuUIMsgBailan46:"交往",menuUIMsgBailan47:"交往设置",menuUIMsgBailan48:"敌对模式",menuUIMsgBailan49:"在敌对模式下，你可以攻击任何玩家，名字显示为红色；在友好模式下你无法攻击处于 友好模式 的玩家，名字显示为绿色。",menuUIMsgBailan50:"即：如果一个玩家名字是绿色，那么他是无威胁的；如果他开了红，那么他可能有攻击倾向。",menuUIMsgBailan51:"友好模式",menuUIMsgBailan52:"敌对模式",menuUIMsgBailan53:"传送",menuUIMsgBailan54:"不允许使用传送",menuUIMsgBailan55:"传送至",menuUIMsgBailan56:"§b背包无传送石，传送失败",menuUIMsgBailan57:"§b你向对方发起了请求",menuUIMsgBailan58:"传送请求",menuUIMsgBailan59:"是",menuUIMsgBailan60:"§b传送成功",menuUIMsgBailan61:"§b传送成功",menuUIMsgBailan62:"否",menuUIMsgBailan63:"§b对方拒绝了你的请求",menuUIMsgBailan64:"§b你拒绝了对方的请求",menuUIMsgBailan65:"邀请传送到你的位置",menuUIMsgBailan66:"§b背包无传送石，传送失败",menuUIMsgBailan67:"§b你向对方发起了邀请",menuUIMsgBailan68:"传送请求",menuUIMsgBailan69:"是",menuUIMsgBailan70:"§b传送成功",menuUIMsgBailan71:"§b传送成功",menuUIMsgBailan72:"否",menuUIMsgBailan73:"§b对方拒绝了你的邀请",menuUIMsgBailan74:"§b你拒绝了对方的邀请",menuUIMsgBailan75:"设置",menuUIMsgBailan76:"管理",menuUIMsgBailan77:"游戏内容",menuUIMsgBailan78:"玩家传送",menuUIMsgBailan79:"任何传送需要传送石",menuUIMsgBailan80:"开启实体清理",menuUIMsgBailan81:"开启死亡点回溯",menuUIMsgBailan82:"允许记录传送点",menuUIMsgBailan83:"无权限访问此页面。如果你是 op ，请输入/tag @s add owner 来获取管理权限",menuUIMsgBailan84:"高级设置",menuUIMsgBailan85:"实体清理设置",menuUIMsgBailan86:"开启实体清理",menuUIMsgBailan87:"保留实体数(最低实体数)",menuUIMsgBailan88:"清理灵敏度(瞬时卡顿处理)",menuUIMsgBailan89:"清理频次(长期清理强度)",menuUIMsgBailan90:"无权限访问此页面。如果你是 op ，请输入/tag @s add owner 来获取管理权限",menuUIMsgBailan91:"保留实体数(最低实体数)",menuUIMsgBailan92:"清理灵敏度(瞬时卡顿处理)",menuUIMsgBailan93:"清理频次(长期清理强度)",menuUIMsgBailan94:"玩家ID",menuUIMsgBailan95:"玩家等级",menuUIMsgBailan96:"法力值",menuUIMsgBailan97:"武器技能冷却",menuUIMsgBailan98:"盔甲技能冷却",menuUIMsgBailan99:"友好模式是否开启",menuUIMsgBailan100:"等级加成是否开启",menuUIMsgBailan101:"个人设置",menuUIMsgBailan102:"语言选择",menuUIMsgBailan103:"向作者提问",menuUIMsgBailan104:"你可以通过qq联系，Bilibili联系（找作者很容易的）LiLeyi 和 aa剑侠"},en:{ruinDesertCmd_SELF:"原地",ruinDesertCmd_TP:"TP",ruinDesertCmd_BLAST:"BLAST",ruinDesertCmd_EFFECT:"EFFECT",ruinDesertCmd_DAMAGE:"DAMAGE",ruinDesertCmd_HEALTH_ADD:"HEALTH_ADD",ruinDesertCmd_HEALTH_REMOVE:"HEALTH_REMOVE",ruinDesertCmd_FACING_ADD_2:"facing+2",ruinDesertCmd_FACING_ADD_4:"facing+4",ruinDesertCmd_FACING_ADD_6:"facing+6",ruinDesertCmd_FACING_ADD_8:"facing+8",ruinDesertCmd_FACING_ADD_10:"facing+10",ruinDesertCmd_FACING_ADD_12:"facing+12",ruinDesertCmd_FACING_ADD_16:"facing+16",ruinDesertCmd_FACING_ADD_20:"facing+20",ruinDesertCmd_FACING_ADD_28:"facing+28",ruinDesertCmd_FACING_ADD_32:"facing+32",ruinDesertCmd_Y_ADD_4:"Y+4",ruinDesertCmd_Y_ADD_8:"Y+8",ruinDesertCmd_Y_ADD_16:"Y+16",ruinDesertCmd_Y_ADD_32:"Y+32",ruinDesertCmd_Y_REMOVE_4:"Y-4",ruinDesertCmd_Y_REMOVE_8:"Y-8",ruinDesertCmd_Y_REMOVE_16:"Y-16",ruinDesertCmd_Y_REMOVE_32:"Y-32",ruinDesertCmd_WEAKNESS:"WEAKNESS",ruinDesertCmd_STRENGTH:"STRENGTH",ruinDesertCmd_BLIND:"BLIND",ruinDesertCmd_SPEED:"SPEED",ruinDesertCmd_DEFENSE:"DEFENSE",ruinDesertCmd_WITHER:"WITHER",ruinDesertCmd_EXECUTE:"EXECUTE",ruinDesertCmd_VALUE_1:"VALUE_1",ruinDesertCmd_VALUE_2:"VALUE_2",ruinDesertCmd_VALUE_4:"VALUE_4",ruinDesertCmd_VALUE_8:"VALUE_8",ruinDesertCmd_VALUE_16:"VALUE_16",ruinDesertCmd_VALUE_32:"VALUE_32",ruinDesertCmd_VALUE_3:"VALUE_3",ruinDesertCmd_VALUE_5:"VALUE_5",ruinDesertCmd_VALUE_10:"VALUE_10",ruinDesertCmd_VALUE_64:"VALUE_64",ruinDesertCmd_GUARD_POS:"GUARD_POS",maxSingleDamage:"Maximum monomer damage",maxSecondaryDamage:"Maximum second injury",talentWanxiang:"Juvenation",talentChuanyun:"Precision",talentChuanjia:"Bloodrage",talentZhicai:"Overheat",talentFangyu:"DamageAbsorption",talentChongneng:"WeaponRecharge",talentChongzhuang:"ArmorRecharge",talentYuanquan:"MagicRecharge",talentTuxi:"Frenzy",talentZaisheng:"Regeneration",talentWeizhi:"unknown",talentWanxiangDesc:"HP increases {0}",talentChuanyunDesc:"Deal {0} extra damage to targets within 0-64 blocks",talentChuanjiaDesc:"Deal extra damage ({0} * your HP) to targets",talentZhicaiDesc:"Deal {0} extra damage to targets within 0-16 blocks, the closer the distance, the higher the damage.",talentFangyuDesc:"Absorb {0} of the damage.",talentChongnengDesc:"Reduce {0} of your weapon's CD",talentChongzhuangDesc:"Reduce {0} of your armor's CD",talentYuanquanDesc:"Mana recharge speed up {0}",talentTuxiDesc:"Deal {0} extra damage to targets. CD: 10s",talentZaishengDesc:"Cure the players {0} HP around you every 10s, this talent is invalid when you are in hostile mode",talentWeizhiDesc:"unknown",occupationEmpty:"null",occupationGuard:"Guard",occupationWarrior:"warrior",occupationAssassin:"Assassin",occupationArcher:"Archer",occupationWarlock:"Warlock",occupationPriest:"Priest",menuUISubtitleGonggao:"announcement",menuUIMsgGonggao1:"Our new update is out, Let's take a look!",menuUISubtitleHuodong:"Activity",menuUISubtitleBanben:"Version",menuUIMsgBanben1:"Version Information",menuUIMsgBanben2:"Basic information",menuUIMsgBanben3:"Addon's version: 1.7.2B4, more info about the addon: ",menuUIMsgBanben4:"Edition notice",menuUIMsgBanben6:"Thanks list",menuUIMsgBanben5:"Winter poetry may have a stuttering phenomenon, so we recommend that you first enter/tag @s add owner, then go to the menu settings to open the entity cleanup option.If you are worried that the important entity will be cleared, please don't open it.",menuUIMsgBailan1:"Homepage",menuUIMsgBailan2:"Propaganda and winning gifts",menuUIMsgBailan3:"This work is a large module made for three years, but it is no popular, we decided to host this event",menuUIMsgBailan4:"Payment activity: ",menuUIMsgBailan5:"Version",menuUIMsgBailan6:"End User License Agreement",menuUIMsgBailan7:"How to summon the bosses?",menuUIMsgBailan8:"Now some of the bosses have their own summon blocks, in some biomes, there will be structures with summon blocks inside. With different items, you can unlock the block to summon the boss. It may takes you a long time to find these summon blocks, good luck!",menuUIMsgBailan9:"Why it is so laggy?",menuUIMsgBailan10:"Too many mobs may cause the problem, you can go to the Manage page to opem the 'Mob Cleanup'.(Only players with owner tag can visit the Manage page)",menuUIMsgBailan11:"How can I upgrade?",menuUIMsgBailan12:"You can upgrade your level through the level up table, and you can get some talent points to upgrade your talents when your level is up.",menuUIMsgBailan13:"personal",menuUIMsgBailan14:"information",menuUIMsgBailan15:"Yes",menuUIMsgBailan16:"no",menuUIMsgBailan17:"Yes",menuUIMsgBailan18:"no",menuUIMsgBailan19:"addition",menuUIMsgBailan20:"Level effect",menuUIMsgBailan21:"You can get some powerful buffs when you reach some special levels.",menuUIMsgBailan22:"Level effect",menuUIMsgBailan23:"Particles",menuUIMsgBailan24:"You can craft special potions to get particles, remove them here if you don't like it.",menuUIMsgBailan25:"Remove flame particle",menuUIMsgBailan26:"Remove halo particle",menuUIMsgBailan27:"Remove rune particle",menuUIMsgBailan28:"Remove love particle",menuUIMsgBailan29:"talent",menuUIMsgBailan30:"Talent points: ",menuUIMsgBailan31:"Choose your job",menuUIMsgBailan32:"Teleport point",menuUIMsgBailan33:"Teleport point record",menuUIMsgBailan34:"Teleport point: ",menuUIMsgBailan35:"Go to point:",menuUIMsgBailan36:"§bbackpack without teleport stones, teleport failed",menuUIMsgBailan37:"§bsuccessful teleport",menuUIMsgBailan38:"Remarks",menuUIMsgBailan39:"Enter remarks",menuUIMsgBailan40:"Delete point:",menuUIMsgBailan41:"Record the current point",menuUIMsgBailan42:"Forbidden record teleportation point",menuUIMsgBailan43:"Death point: ",menuUIMsgBailan44:"Go to the point",menuUIMsgBailan45:"Destroy retrospective",menuUIMsgBailan46:"Exchanges",menuUIMsgBailan47:"Associated settings",menuUIMsgBailan48:"Hostile mode",menuUIMsgBailan49:"When you are in hostile mode, you can attack other players and your name will turn into red. When you are in friendly mode, you can't attack other players and your name will turn into green.",menuUIMsgBailan50:"That is, if a player's name is green, then he is not threatened; if he starts red, then he may have a tendency to attack.",menuUIMsgBailan51:"Friendly mode",menuUIMsgBailan52:"Hostile mode",menuUIMsgBailan53:"Teleport",menuUIMsgBailan54:"teleport not allowed",menuUIMsgBailan55:"Teleport to",menuUIMsgBailan56:"§bbackpack without teleport stones, teleport failed",menuUIMsgBailan57:"§byou initiated a request to the other party",menuUIMsgBailan58:"Teleport request",menuUIMsgBailan59:"Yes",menuUIMsgBailan60:"§bsuccessful teleport",menuUIMsgBailan61:"§bsuccessful teleport",menuUIMsgBailan62:"no",menuUIMsgBailan63:"§bthe other party rejected your request",menuUIMsgBailan64:"§byou reject the other party's request",menuUIMsgBailan65:"Invite the player to teleport to your position",menuUIMsgBailan66:"§bbackpack without teleport stones, teleport failed",menuUIMsgBailan67:"§byou initiated an invitation to the other party",menuUIMsgBailan68:"Teleport request",menuUIMsgBailan69:"Yes",menuUIMsgBailan70:"§bsuccessful teleport",menuUIMsgBailan71:"§bsuccessful teleport",menuUIMsgBailan72:"no",menuUIMsgBailan73:"§bthe target player rejected your invitation",menuUIMsgBailan74:"§byou rejected the invitation.",menuUIMsgBailan75:"set up",menuUIMsgBailan76:"manage",menuUIMsgBailan77:"Game content",menuUIMsgBailan78:"Player Teleportation",menuUIMsgBailan79:"Any teleportation requires teleportation stone",menuUIMsgBailan80:"Entity Cleanup",menuUIMsgBailan81:"Starting the death point back",menuUIMsgBailan82:"Allow players to record teleportation point",menuUIMsgBailan83:"Access to this page without permissions.If you are OP, enter/tag @s add owner to obtain management permissions",menuUIMsgBailan84:"advanced settings",menuUIMsgBailan85:"Entity Cleaning Settings",menuUIMsgBailan86:"Entity Cleanup",menuUIMsgBailan87:"Reserve the number of entities (minimum entity)",menuUIMsgBailan88:"Clean up sensitivity (instantaneous stuck processing)",menuUIMsgBailan89:"Cleaning frequency (long -term cleaning intensity)",menuUIMsgBailan90:"Access to this page without permissions.If you are OP, enter/tag @s add owner to obtain management permissions",menuUIMsgBailan91:"Reserve the number of entities (minimum entity)",menuUIMsgBailan92:"Clean up sensitivity (instantaneous stuck processing)",menuUIMsgBailan93:"Cleaning frequency (long -term cleaning intensity)",menuUIMsgBailan94:"Player ID",menuUIMsgBailan95:"Player level",menuUIMsgBailan96:"Mana",menuUIMsgBailan97:"Weapon skill cooling",menuUIMsgBailan98:"Armor skills cooling",menuUIMsgBailan99:"Whether the friendly mode is opened",menuUIMsgBailan100:"Whether the level bonus is turned on",menuUIMsgBailan101:"Personal settings",menuUIMsgBailan102:"language selection",menuUIMsgBailan103:"How can I contact the creator?",menuUIMsgBailan104:"Twitter: @le_lyii or @EAT_YOUR_PANTS     (issues)Github: https://github.com/AAswordman/ThePoetryOfWinter"}};class q{constructor(e){this._client=e}get exPlayer(){return this._client.exPlayer}get player(){return this._client.player}get client(){return this._client}get globalSettings(){return this._client.globalSettings}get data(){return this._client.data}runCommandAsync(e){return i.Z.runCommandAsync(e)}setTimeout(e,t){this._client.setTimeout(e,t)}getDimension(e){return this._client.getDimension(e)}getExDimension(e){return this._client.getExDimension(e)}getPlayers(){return this._client.getPlayers()}getEvents(){return this._client.getEvents()}sayTo(e,t=this.player){this._client.sayTo(e,t)}getLang(){return this._client.getLang()}}var K;class Y{}K=Y,Y.DESERT_RUIN_NUM=0,Y.DESERT_RUIN_LOCATION_START=new t.Z(16384,64,16384),Y.DESERT_RUIN_LOCATION_SIZE=new t.Z(512,191,512),Y.DESERT_RUIN_LOCATION_END=K.DESERT_RUIN_LOCATION_START.clone().add(K.DESERT_RUIN_LOCATION_SIZE),Y.DESERT_RUIN_LOCATION_CENTER=K.DESERT_RUIN_LOCATION_START.clone().add(K.DESERT_RUIN_LOCATION_SIZE.x/2,0,K.DESERT_RUIN_LOCATION_SIZE.z/2),Y.DESERT_RUIN_AREA=new A(K.DESERT_RUIN_LOCATION_START,K.DESERT_RUIN_LOCATION_SIZE),Y.DESERT_RUIN_PROTECT_AREA=new A(K.DESERT_RUIN_LOCATION_START.clone().sub(K.DESERT_RUIN_LOCATION_SIZE),K.DESERT_RUIN_LOCATION_END.clone().add(K.DESERT_RUIN_LOCATION_SIZE)),Y.STONE_RUIN_NUM=1,Y.STONE_RUIN_LOCATION_START=new t.Z(15360,64,15360),Y.STONE_RUIN_LOCATION_SIZE=new t.Z(128,128,128),Y.STONE_RUIN_LOCATION_END=K.STONE_RUIN_LOCATION_START.clone().add(K.STONE_RUIN_LOCATION_SIZE),Y.STONE_RUIN_LOCATION_CENTER=K.STONE_RUIN_LOCATION_START.clone().add(K.STONE_RUIN_LOCATION_SIZE.x/2,0,K.STONE_RUIN_LOCATION_SIZE.z/2),Y.STONE_RUIN_AREA=new A(K.STONE_RUIN_LOCATION_START,K.STONE_RUIN_LOCATION_SIZE),Y.STONE_RUIN_PROTECT_AREA=new A(K.STONE_RUIN_LOCATION_START.clone().sub(K.STONE_RUIN_LOCATION_SIZE),K.STONE_RUIN_LOCATION_END.clone().add(K.STONE_RUIN_LOCATION_SIZE)),Y.CAVE_RUIN_NUM=2,Y.CAVE_RUIN_LOCATION_START=new t.Z(17408,64,17408),Y.CAVE_RUIN_LOCATION_SIZE=new t.Z(128,128,128),Y.CAVE_RUIN_LOCATION_END=K.CAVE_RUIN_LOCATION_START.clone().add(K.CAVE_RUIN_LOCATION_SIZE),Y.CAVE_RUIN_LOCATION_CENTER=K.CAVE_RUIN_LOCATION_START.clone().add(K.CAVE_RUIN_LOCATION_SIZE.x/2,0,K.CAVE_RUIN_LOCATION_SIZE.z/2),Y.CAVE_RUIN_AREA=new A(K.CAVE_RUIN_LOCATION_START,K.CAVE_RUIN_LOCATION_SIZE),Y.CAVE_RUIN_PROTECT_AREA=new A(K.CAVE_RUIN_LOCATION_START.clone().sub(K.CAVE_RUIN_LOCATION_SIZE),K.CAVE_RUIN_LOCATION_END.clone().add(K.CAVE_RUIN_LOCATION_SIZE)),Y.ANCIENT_RUIN_NUM=3,Y.ANCIENT_RUIN_LOCATION_START=new t.Z(15360,64,16384),Y.ANCIENT_RUIN_LOCATION_SIZE=new t.Z(128,128,128),Y.ANCIENT_RUIN_LOCATION_END=K.ANCIENT_RUIN_LOCATION_START.clone().add(K.ANCIENT_RUIN_LOCATION_SIZE),Y.ANCIENT_RUIN_LOCATION_CENTER=K.ANCIENT_RUIN_LOCATION_START.clone().add(K.ANCIENT_RUIN_LOCATION_SIZE.x/2,0,K.ANCIENT_RUIN_LOCATION_SIZE.z/2),Y.ANCIENT_RUIN_AREA=new A(K.ANCIENT_RUIN_LOCATION_START,K.ANCIENT_RUIN_LOCATION_SIZE),Y.ANCIENT_RUIN_PROTECT_AREA=new A(K.ANCIENT_RUIN_LOCATION_START.clone().sub(K.ANCIENT_RUIN_LOCATION_SIZE),K.ANCIENT_RUIN_LOCATION_END.clone().add(K.ANCIENT_RUIN_LOCATION_SIZE)),Y.MIND_RUIN_NUM=4,Y.MIND_RUIN_LOCATION_START=new t.Z(15360,64,17408),Y.MIND_RUIN_LOCATION_SIZE=new t.Z(128,128,128),Y.MIND_RUIN_LOCATION_END=K.MIND_RUIN_LOCATION_START.clone().add(K.MIND_RUIN_LOCATION_SIZE),Y.MIND_RUIN_LOCATION_CENTER=K.MIND_RUIN_LOCATION_START.clone().add(K.MIND_RUIN_LOCATION_SIZE.x/2,0,K.MIND_RUIN_LOCATION_SIZE.z/2),Y.MIND_RUIN_AREA=new A(K.MIND_RUIN_LOCATION_START,K.MIND_RUIN_LOCATION_SIZE),Y.MIND_RUIN_PROTECT_AREA=new A(K.MIND_RUIN_LOCATION_START.clone().sub(K.MIND_RUIN_LOCATION_SIZE),K.MIND_RUIN_LOCATION_END.clone().add(K.MIND_RUIN_LOCATION_SIZE));class J{constructor(e){this.game=e}get client(){return this.game.client}}var Q,ee,te,ne,se=__webpack_require__(985);function ie(e,t){return e[t]}!function(e){e[e.TP=0]="TP",e[e.BLAST=1]="BLAST",e[e.EFFECT=2]="EFFECT",e[e.DAMAGE=3]="DAMAGE",e[e.HEALTH_ADD=4]="HEALTH_ADD",e[e.HEALTH_REMOVE=5]="HEALTH_REMOVE",e[e.EXECUTE=6]="EXECUTE"}(Q||(Q={})),function(e){e[e.SELF=0]="SELF",e[e.FACING_ADD_2=1]="FACING_ADD_2",e[e.FACING_ADD_4=2]="FACING_ADD_4",e[e.FACING_ADD_6=3]="FACING_ADD_6",e[e.FACING_ADD_8=4]="FACING_ADD_8",e[e.FACING_ADD_10=5]="FACING_ADD_10",e[e.FACING_ADD_12=6]="FACING_ADD_12",e[e.FACING_ADD_16=7]="FACING_ADD_16",e[e.FACING_ADD_20=8]="FACING_ADD_20",e[e.FACING_ADD_28=9]="FACING_ADD_28",e[e.FACING_ADD_32=10]="FACING_ADD_32",e[e.Y_ADD_4=11]="Y_ADD_4",e[e.Y_ADD_8=12]="Y_ADD_8",e[e.Y_ADD_16=13]="Y_ADD_16",e[e.Y_ADD_32=14]="Y_ADD_32",e[e.Y_REMOVE_4=15]="Y_REMOVE_4",e[e.Y_REMOVE_8=16]="Y_REMOVE_8",e[e.Y_REMOVE_16=17]="Y_REMOVE_16",e[e.Y_REMOVE_32=18]="Y_REMOVE_32",e[e.GUARD_POS=19]="GUARD_POS"}(ee||(ee={})),function(e){e[e.WEAKNESS=0]="WEAKNESS",e[e.STRENGTH=1]="STRENGTH",e[e.BLIND=2]="BLIND",e[e.SPEED=3]="SPEED",e[e.DEFENSE=4]="DEFENSE",e[e.WITHER=5]="WITHER"}(te||(te={})),function(e){e[e.VALUE_1=0]="VALUE_1",e[e.VALUE_2=1]="VALUE_2",e[e.VALUE_4=2]="VALUE_4",e[e.VALUE_8=3]="VALUE_8",e[e.VALUE_16=4]="VALUE_16",e[e.VALUE_32=5]="VALUE_32",e[e.VALUE_3=6]="VALUE_3",e[e.VALUE_5=7]="VALUE_5",e[e.VALUE_10=8]="VALUE_10",e[e.VALUE_64=9]="VALUE_64"}(ne||(ne={}));class ae{constructor(e){this.collections=[],this.game=e}clear(){this.collections.splice(0,this.collections.length)}init(){this.collections=[]}randomAddRule(){let e=C.Z.choice(function(e){let t=[];for(let n in e)isNaN(Number(n))&&t.push(n);return t}(C.Z.choice([te,Q,ee,ne])));return this.collections.push(e),e}show(){return n=this,s=void 0,a=function*(){let n=[];e:for(let s of[1]){let s="/ ",i=Q.EXECUTE;for(;i===Q.EXECUTE;){let e=(new se.ActionFormData).title("使用规则").body("规则结构："+s+"\n当前有："+this.collections.map((e=>this.game.getLang()["ruinDesertCmd_"+e])).join(" , ")),t=[];for(let e of this.collections)e in Q&&t.push(e);if(0===t.length)break e;for(let n of t)e.button(this.game.getLang()["ruinDesertCmd_"+n]);let a=yield e.show(this.game.player);if(a.canceled||void 0===a.selection)break e;s+=this.game.getLang()["ruinDesertCmd_"+t[a.selection]]+" / ",n.push(t[a.selection]),this.collections.splice(this.collections.indexOf(t[a.selection]),1),i=Q[t[a.selection]],console.log(this.collections),e=(new se.ActionFormData).title("执行坐标").body("规则结构："+s+"\n当前有："+this.collections.map((e=>this.game.getLang()["ruinDesertCmd_"+e])).join(" , ")),t=[];for(let e of this.collections)e in ee&&t.push(e);if(0===t.length)break e;for(let n of t)e.button(this.game.getLang()["ruinDesertCmd_"+n]);if(a=yield e.show(this.game.player),a.canceled||void 0===a.selection)break e;s+=this.game.getLang()["ruinDesertCmd_"+t[a.selection]]+" / ",n.push(t[a.selection]),this.collections.splice(this.collections.indexOf(t[a.selection]),1)}let a=(new se.ActionFormData).title("效果/值/倍数").body("规则结构："+s+"\n当前有："+this.collections.map((e=>this.game.getLang()["ruinDesertCmd_"+e])).join(" , ")),r=[];if(i===Q.EFFECT)for(let e of this.collections)e in te&&r.push(e);else for(let e of this.collections)e in ne&&r.push(e);if(0===r.length)break e;for(let e of r)a.button(this.game.getLang()["ruinDesertCmd_"+e]);let o=yield a.show(this.game.player);if(o.canceled||void 0===o.selection)break e;s+=this.game.getLang()["ruinDesertCmd_"+r[o.selection]]+" / ",n.push(r[o.selection]),this.collections.splice(this.collections.indexOf(r[o.selection]),1);const l=new t.Z;let u=0;for(i=Q.EXECUTE;i===Q.EXECUTE&&n[u]in Q;){i=ie(Q,n[u]),u+=1;let e=ie(ee,n[u]);switch(u+=1,e){case ee.FACING_ADD_2:l.add(this.game.exPlayer.getViewVector().scl(2));break;case ee.FACING_ADD_4:l.add(this.game.exPlayer.getViewVector().scl(4));break;case ee.FACING_ADD_6:l.add(this.game.exPlayer.getViewVector().scl(6));break;case ee.FACING_ADD_8:l.add(this.game.exPlayer.getViewVector().scl(8));break;case ee.FACING_ADD_10:l.add(this.game.exPlayer.getViewVector().scl(10));break;case ee.FACING_ADD_12:l.add(this.game.exPlayer.getViewVector().scl(12));break;case ee.FACING_ADD_16:l.add(this.game.exPlayer.getViewVector().scl(16));break;case ee.FACING_ADD_32:l.add(this.game.exPlayer.getViewVector().scl(32));break;case ee.FACING_ADD_20:l.add(this.game.exPlayer.getViewVector().scl(20));break;case ee.FACING_ADD_28:l.add(this.game.exPlayer.getViewVector().scl(28));break;case ee.Y_ADD_8:l.y+=8;break;case ee.Y_ADD_4:l.y+=4;break;case ee.Y_ADD_16:l.y+=16;break;case ee.Y_ADD_32:l.y+=32;break;case ee.Y_REMOVE_8:l.y-=8;break;case ee.Y_REMOVE_4:l.y-=4;break;case ee.Y_REMOVE_16:l.y-=16;break;case ee.Y_REMOVE_32:l.y-=32}}const h=ie(te,n[u])||ie(ne,n[u]),d=n[u].startsWith("VALUE_")?parseInt(n[u].split("_")[1]):0,m=yield(new se.ModalFormData).title("其他选项").slider("延迟(s)",0,15,.5,0).show(this.game.player);if(m.canceled||void 0===m.formValues)break e;const g=1e3*m.formValues[0],_=new t.Z,p=new c.Z(this.game.getEvents(),(()=>{_.set(this.game.player.location).add(l),this.game.getExDimension().spawnParticle("wb:ruin_desert_rulepre",_)})).delay(1);return p.start(),void this.game.setTimeout((()=>{switch(p.stop(),i){case Q.BLAST:this.game.getExDimension().createExplosion(_,d,{breaksBlocks:!1,source:this.game.player});break;case Q.DAMAGE:this.game.getExDimension().getEntities({maxDistance:15,excludeTags:this.game.player.hasTag("wbmsyh")?["wbmsyh"]:[],location:D.Z.getLocation(_)}).forEach((e=>this.game.exPlayer.causeDamageTo(e,d)));break;case Q.HEALTH_ADD:this.game.getExDimension().getEntities({maxDistance:15,location:D.Z.getLocation(_)}).forEach((e=>{let t=T.Z.getInstance(e).getHealthComponent();t.setCurrent(t.current+d)}));break;case Q.HEALTH_REMOVE:this.game.getExDimension().getEntities({maxDistance:15,excludeTags:this.game.player.hasTag("wbmsyh")?["wbmsyh"]:[],location:D.Z.getLocation(_)}).forEach((e=>{let t=T.Z.getInstance(e).getHealthComponent();t.setCurrent(Math.max(0,t.current-d))}));break;case Q.TP:this.game.getExDimension().getEntities({maxDistance:15,location:D.Z.getLocation(_)}).forEach((e=>T.Z.getInstance(e).setPosition(_.clone().sub(this.game.exPlayer.getPosition()).scl(d/2).add(_))));break;case Q.EFFECT:{let t=e.MinecraftEffectTypes.absorption;switch(h){case te.WITHER:t=e.MinecraftEffectTypes.wither;break;case te.BLIND:t=e.MinecraftEffectTypes.blindness;break;case te.DEFENSE:t=e.MinecraftEffectTypes.resistance;break;case te.SPEED:t=e.MinecraftEffectTypes.speed;break;case te.STRENGTH:t=e.MinecraftEffectTypes.strength;break;case te.WEAKNESS:t=e.MinecraftEffectTypes.weakness}this.game.getExDimension().getEntities({maxDistance:15,location:D.Z.getLocation(_)}).forEach((e=>e.addEffect(t,600,1,!1)));break}}}),g)}this.collections=this.collections.concat(n)},new((i=void 0)||(i=Promise))((function(e,t){function r(e){try{c(a.next(e))}catch(e){t(e)}}function o(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,o)}c((a=a.apply(n,s||[])).next())}));var n,s,i,a}}class re{}re.CHAR_MAZE_EMPTY="",re.CHAR_MAZE_PATH="",re.CHAR_MAZE_ROOM="",re.CHAR_MAZE_ROOM_PASSED="",re.CHAR_MAZE_ROOM_ARROW_UP="",re.CHAR_MAZE_ROOM_ARROW_RIGHT="",re.CHAR_MAZE_ROOM_ARROW_DOWN="",re.CHAR_MAZE_ROOM_ARROW_LEFT="",re.CHAR_MAZE_PATH_ARROW_UP="",re.CHAR_MAZE_PATH_ARROW_RIGHT="",re.CHAR_MAZE_PATH_ARROW_DOWN="",re.CHAR_MAZE_PATH_ARROW_LEFT="",re.CHAR_MAZE_PATH_GUARD="";class oe{constructor(e,t){this.trigger=e,this.value=t}upDate(e){if(this.value!==e){const t=this.value;this.value=e,this.trigger(e,t)}}}class ce extends J{constructor(n){super(n),this.tmpA=new t.Z;const s=e=>{this.client.magicSystem.additionHealth-=e/2,this.client.magicSystem.additionHealth<=0&&n.exPlayer.removeHealth(n,999)};this.desertRuinRules=new ae(n),this.inRuinsListener=new oe((e=>{e?(this.desertRuinRules.init(),this.client.talentSystem.hasBeenDamaged.hasMonitor(s)||this.client.talentSystem.hasBeenDamaged.addMonitor(s),this.client.magicSystem.deleteActionbarPass("desertRuinMap")):(this.client.magicSystem.additionHealth=40,this.client.talentSystem.hasBeenDamaged.removeMonitor(s),this.desertRoomCounter.clear(),this.desertRuinRules.clear(),this.client.magicSystem.deleteActionbarPass("desertRuinMap"))}),!1),this.desertRoomCounter=new Map,this.desertRuinScoreJudge=new oe(((s,i)=>{var a,r;const c=this.client.getServer().ruin_desertBoss;if(i&&c.isInRoom(i)){let s=i.split(",").map((e=>parseInt(e))),a=new t.Z(s[0],s[1],s[2]).scl(16).add(Y.DESERT_RUIN_LOCATION_START).add(8,8,8);const r=new t.Z,o=[];for(let t of n.getDimension().getEntities({excludeTypes:["minecraft:item",e.MinecraftEntityTypes.player.id],maxDistance:16,location:D.Z.getLocation(a)}))a.clone().sub(r.set(t.location)).abs().toArray().every((e=>e<=8))&&(o.push(t.id),this.client.magicSystem.additionHealth-=1,t.kill());0!==o.length&&n.sayTo("§b[遗迹]§f"+o.length+"个实体未清理, 已扣除 "+o.length+" 点血量")}if(this.client.getServer().ruin_desertBoss.isInRoom(s)){this.desertRoomCounter.set(s,(null!==(a=this.desertRoomCounter.get(s))&&void 0!==a?a:0)+1);let e=Math.max(-2,Math.floor(Math.random()*(5+(n.player.location.y-Y.DESERT_RUIN_LOCATION_START.y)/12-2*(null!==(r=this.desertRoomCounter.get(s))&&void 0!==r?r:0))));n.sayTo("§b[遗迹]§f第"+this.desertRoomCounter.get(s)+"次进入，随机点数："+e);let t=e;for(;t>=1;)n.sayTo("§b[遗迹]§f获得规则 §b§l"+n.getLang()["ruinDesertCmd_"+this.desertRuinRules.randomAddRule()]),n.sayTo("§b[遗迹]§f获得规则 §b§l"+n.getLang()["ruinDesertCmd_"+this.desertRuinRules.randomAddRule()]),t--;this.client.magicSystem.additionHealth+=e,Math.random()<.7&&this.desertRuinRules.show().then((t=>{let s=Math.floor(10*Math.random()),i=n.exPlayer.getPosition().div(16).floor().scl(16).add(8,4,8);switch(s){case 0:default:break;case 1:for(;e+1>0;)n.getExDimension().spawnEntity("wb:magic_book",i),n.getExDimension().spawnEntity("wb:magic_book",i),e-=2;break;case 2:for(;e+1>0;)n.getExDimension().spawnEntity("wb:desert_insect",i),n.getExDimension().spawnEntity("wb:magic_book",i),n.getExDimension().spawnEntity("wb:magic_book",i),n.getExDimension().spawnEntity("wb:desert_chester_normal",i),e-=2;break;case 3:for(;e+1>0;)n.getExDimension().spawnEntity("wb:desert_chester_high",i),n.getExDimension().spawnEntity("wb:desert_skeleton",i),n.getExDimension().spawnEntity("wb:desert_skeleton",i),n.getExDimension().spawnEntity("wb:desert_skeleton",i),n.getExDimension().spawnEntity("wb:desert_skeleton",i),e-=2;break;case 4:for(;e+1>0;)n.getExDimension().spawnEntity("dec:stone_golem",i),n.getExDimension().spawnEntity("dec:stone_golem",i),n.getExDimension().spawnEntity("wb:desert_chester_high",i),e-=4;break;case 5:for(;e+1>0;)n.getExDimension().spawnEntity("dec:stone_golem",i),n.getExDimension().spawnEntity("dec:stone_golem",i),n.getExDimension().spawnEntity("wb:desert_chester_high",i),e-=4;break;case 6:for(;e+1>0;)n.getExDimension().spawnEntity("wb:desert_zombie",i),n.getExDimension().spawnEntity("wb:desert_zombie",i),n.getExDimension().spawnEntity("wb:desert_skeleton",i),e-=2}})).catch((e=>o.Z.throwError(e)))}}),"0,0,0")}getShowMap(){const e=[],t=this.client.exPlayer.getPosition().sub(Y.DESERT_RUIN_LOCATION_START).div(16).floor();t.div(8,1,8).floor().scl(8,1,8);const n=this.client.exPlayer.getPosition().sub(Y.DESERT_RUIN_LOCATION_START).div(16).floor(),s=t.clone(),i=t.clone().add(8,0,8),a=this.client.getServer().ruin_desertBoss;for(this.tmpA.set(this.client.getServer().ruinDesertGuardPos).sub(Y.DESERT_RUIN_LOCATION_START).div(16).floor();t.z<i.z;t.z++){let r=[];for(t.x=s.x;t.x<i.x;t.x++){const e=`${t.x},${t.y},${t.z}`;if(t.x===this.tmpA.x&&t.y===this.tmpA.y&&t.z===this.tmpA.z)r.push(re.CHAR_MAZE_PATH_GUARD);else if(t.x===n.x&&t.z===n.z){const t=this.game.player.viewVector;a.isInRoom(e)?t.x>t.z?Math.abs(t.x)>Math.abs(t.z)?r.push(re.CHAR_MAZE_ROOM_ARROW_LEFT):r.push(re.CHAR_MAZE_ROOM_ARROW_DOWN):Math.abs(t.x)>Math.abs(t.z)?r.push(re.CHAR_MAZE_ROOM_ARROW_RIGHT):r.push(re.CHAR_MAZE_ROOM_ARROW_UP):a.isOnPath(e)?t.x>t.z?Math.abs(t.x)>Math.abs(t.z)?r.push(re.CHAR_MAZE_PATH_ARROW_LEFT):r.push(re.CHAR_MAZE_PATH_ARROW_DOWN):Math.abs(t.x)>Math.abs(t.z)?r.push(re.CHAR_MAZE_PATH_ARROW_RIGHT):r.push(re.CHAR_MAZE_PATH_ARROW_UP):r.push(re.CHAR_MAZE_EMPTY)}else a.isInRoom(e)?this.desertRoomCounter.has(e)?r.push(re.CHAR_MAZE_ROOM_PASSED):r.push(re.CHAR_MAZE_ROOM):a.isOnPath(e)?r.push(re.CHAR_MAZE_PATH):r.push(re.CHAR_MAZE_EMPTY)}e.unshift(r.reverse().join(""))}return e}}class le{constructor(){this._alert=new se.MessageFormData,this.buttonEvent=[()=>{},()=>{}]}body(e){return this._alert.body(e),this}button1(e,t){return this._alert.button1(e),this.buttonEvent[1]=t,this}button2(e,t){return this._alert.button2(e),this.buttonEvent[0]=t,this}show(e){return this._alert.show(e).then((e=>{e.canceled||void 0===e.selection||this.buttonEvent[e.selection]()})).catch((e=>o.Z.throwError(e))),this}title(e){return this._alert.title(e),this}}var ue=__webpack_require__(217);class he{constructor(e,t,n,s){this.deathTimes=0,this.fogListener=new oe(((e,t)=>{this.dim.command.run(`fog @a[x=${this.center.x},y=${this.center.y},z=${this.center.z},r=128] remove "ruin_fog"`),this.fog=e}),""),this.players=new Map,this.area=n,this.center=n.center(),this.id=r.Z.randomUUID(),he.map.set(this.id,this),this.dim=t;for(let s of t.getPlayers())if(n.contains(s.location)){this.players.set(s,!0);let t=e.findClientByPlayer(s);t&&(t.ruinsSystem.barrier=this)}this.tickEvent=this.update.bind(this),this.server=e,this.manager=e.getEvents(),this.manager.register("onLongTick",this.tickEvent),this.boss=s}particle(e){this.dim.spawnParticle(e,this.center)}static find(e){for(let[t,n]of this.map)if(n.area.contains(e))return n}setBoss(e){this.boss=e}static isInBarrier(e){return void 0!==he.find(e.location)}dispose(){he.map.delete(this.id),this.manager.cancel("onLongTick",this.tickEvent);for(let e of this.clientsByPlayer())e.ruinsSystem.barrier=void 0}*clientsByPlayer(){for(let e of this.players){let t=this.server.findClientByPlayer(e[0]);t&&(yield t)}}notifyDeathAdd(){this.deathTimes+=1;for(let e of this.clientsByPlayer())e.ruinsSystem.deathTimes=this.deathTimes;this.deathTimes>=3&&this.boss.onFail()}update(){this.dim.spawnParticle("wb:boss_barrier",this.center);for(let t of this.server.getPlayers())t.location&&(this.players.has(t)?this.area.contains(t.location)?this.players.set(t,!0):this.players.get(t)&&(this.server.setTimeout((()=>{this.dim.dimension!==t.dimension&&(t.addEffect(e.MinecraftEffectTypes.resistance,280,10,!0),t.addEffect(e.MinecraftEffectTypes.weakness,280,10,!0)),m.Z.getInstance(t).setPosition(this.area.center(),this.dim.dimension)}),2e3),this.players.set(t,!1)):this.area.contains(t.location)&&t.kill());(0,o.W)((()=>this.boss.entity.location))&&!this.area.contains(this.boss.entity.location)&&this.boss.exEntity.setPosition(this.area.center()),this.fog&&this.dim.command.run(`fog @a[x=${this.center.x},y=${this.center.y},z=${this.center.z},r=128] push ${this.fog} "ruin_fog"`)}stop(){this.dispose()}changeFog(e){this.fogListener.upDate(e)}}he.map=new Map;class de extends q{constructor(){super(...arguments),this.i_inviolable=new M.C("i_inviolable"),this.i_damp=new M.C("i_damp"),this.i_soft=new M.C("i_soft"),this.desertRuinRules=new ce(this),this.isInRuinJudge=!1,this.causeDamage=0,this.deathTimes=0,this._causeDamageShow=!1,this.causeDamageType=new Set,this.causeDamageListenner=new oe(((e,t)=>{e?(this.causeDamageMonitor=this.client.talentSystem.hasCauseDamage.addMonitor(((e,t)=>{this.causeDamageType.has(t.typeId)&&(this.causeDamage+=e)})),this.deathTimesListener=e=>{var t;this.exPlayer.getHealth()<=0&&(null===(t=this.barrier)||void 0===t||t.notifyDeathAdd())},this.getEvents().exEvents.playerHurt.subscribe(this.deathTimesListener)):(this.causeDamageMonitor&&(this.client.talentSystem.hasCauseDamage.removeMonitor(this.causeDamageMonitor),this.causeDamageMonitor=void 0,this.client.magicSystem.deleteActionbarPass("hasCauseDamage")),this.deathTimesListener&&(this.getEvents().exEvents.playerHurt.unsubscribe(this.deathTimesListener),this.deathTimesListener=void 0),this.deathTimes=0,this.causeDamage=0,this.causeDamageType.clear())}),!1),this.desertRuinBackJudge=new oe((n=>{n&&(new le).title("返回").body("是否返回主世界?").button1("否",(()=>{})).button2("是",(()=>{let n=this.data.dimBackPoint;n||(n=new t.Z(0,255,0)),this.exPlayer.setPosition(n,this.getDimension(e.MinecraftDimensionTypes.overworld))})).show(this.player)}),!1),this.stoneRuinBackJudge=new oe((n=>{n&&(new ue.Z).title("操作").body("选择你的操作").button("召唤boss",(()=>{this.getExDimension().spawnEntity("wb:magic_stoneman",this.client.getServer().ruin_stoneBoss.getBossSpawnArea().center())})).button("返回主世界",(()=>{let n=this.data.dimBackPoint;n||(n=new t.Z(0,255,0)),this.exPlayer.setPosition(n,this.getDimension(e.MinecraftDimensionTypes.overworld))})).button("取消",(()=>{})).show(this.player)}),!1),this.caveRuinBackJudge=new oe((n=>{n&&(new ue.Z).title("操作").body("选择你的操作").button("召唤boss",(()=>{this.getExDimension().spawnEntity("wb:headless_guard",this.client.getServer().ruin_caveBoss.getBossSpawnArea().center())})).button("返回主世界",(()=>{let n=this.data.dimBackPoint;n||(n=new t.Z(0,255,0)),this.exPlayer.setPosition(n,this.getDimension(e.MinecraftDimensionTypes.overworld))})).button("取消",(()=>{})).show(this.player)}),!1),this.ancientRuinBackJudge=new oe((n=>{n&&(new ue.Z).title("操作").body("选择你的操作").button("召唤boss",(()=>{this.getExDimension().spawnEntity("wb:ancient_stone",this.client.getServer().ruin_ancientBoss.getBossSpawnArea().center())})).button("返回主世界",(()=>{let n=this.data.dimBackPoint;n||(n=new t.Z(0,255,0)),this.exPlayer.setPosition(n,this.getDimension(e.MinecraftDimensionTypes.overworld))})).button("取消",(()=>{})).show(this.player)}),!1),this.mindRuinBackJudge=new oe((n=>{n&&(new ue.Z).title("操作").body("选择你的操作").button("召唤boss",(()=>{this.getExDimension().spawnEntity("wb:intentions_first",this.client.getServer().ruin_mindBoss.getBossSpawnArea().center())})).button("返回主世界",(()=>{let n=this.data.dimBackPoint;n||(n=new t.Z(0,255,0)),this.exPlayer.setPosition(n,this.getDimension(e.MinecraftDimensionTypes.overworld))})).button("取消",(()=>{})).show(this.player)}),!1),this.fogChange=new oe(((e,t)=>{this.exPlayer.command.run('fog @s remove "ruin_fog"')}),"")}get causeDamageShow(){return this._causeDamageShow}set causeDamageShow(e){this._causeDamageShow=e,this.causeDamageListenner.upDate(e)}onJoin(){const n=new t.Z;new t.Z,new t.Z,this.getEvents().exEvents.onLongTick.subscribe((s=>{var i,a,r,o,c,l,u,h,d,m;if(s.currentTick%4!=0)return;n.set(this.player.location);let g,_=D.Z.getBlockLocation(n);_.y-=1;try{g=this.getDimension().getBlock(_)}catch(e){}"wb:portal_desertboss"===(null==g?void 0:g.typeId)?(this.data.dimBackPoint=new t.Z(this.player.location).add(3,2,3),this.client.cache.save(),this.exPlayer.setPosition(A.randomPoint(this.client.getServer().ruin_desertBoss.getPlayerSpawnArea(),4),this.getDimension(e.MinecraftDimensionTypes.theEnd)),0==(this.globalSettings.ruinsExsitsData>>Y.DESERT_RUIN_NUM&1)&&(this.client.getServer().ruin_desertBoss.generate(),this.globalSettings.ruinsExsitsData=this.globalSettings.ruinsExsitsData|1<<Y.DESERT_RUIN_NUM)):"wb:portal_stoneboss"===(null==g?void 0:g.typeId)?(this.data.dimBackPoint=new t.Z(this.player.location).add(3,2,3),this.client.cache.save(),this.player.addEffect(e.MinecraftEffectTypes.resistance,200,10,!0),this.exPlayer.setPosition(A.randomPoint(this.client.getServer().ruin_stoneBoss.getPlayerSpawnArea(),0),this.getDimension(e.MinecraftDimensionTypes.theEnd)),0==(this.globalSettings.ruinsExsitsData>>Y.STONE_RUIN_NUM&1)&&(this.client.getServer().ruin_stoneBoss.generate(),this.globalSettings.ruinsExsitsData=this.globalSettings.ruinsExsitsData|1<<Y.STONE_RUIN_NUM)):"wb:portal_caveboss"===(null==g?void 0:g.typeId)?(this.data.dimBackPoint=new t.Z(this.player.location).add(3,2,3),this.client.cache.save(),this.player.addEffect(e.MinecraftEffectTypes.resistance,200,10,!0),this.exPlayer.setPosition(A.randomPoint(this.client.getServer().ruin_caveBoss.getPlayerSpawnArea(),0),this.getDimension(e.MinecraftDimensionTypes.theEnd)),0==(this.globalSettings.ruinsExsitsData>>Y.CAVE_RUIN_NUM&1)&&(this.client.getServer().ruin_caveBoss.generate(),this.globalSettings.ruinsExsitsData=this.globalSettings.ruinsExsitsData|1<<Y.CAVE_RUIN_NUM)):"wb:portal_ancientboss"===(null==g?void 0:g.typeId)?(this.data.dimBackPoint=new t.Z(this.player.location).add(3,2,3),this.client.cache.save(),this.player.addEffect(e.MinecraftEffectTypes.resistance,200,10,!0),this.exPlayer.setPosition(A.randomPoint(this.client.getServer().ruin_ancientBoss.getPlayerSpawnArea(),0),this.getDimension(e.MinecraftDimensionTypes.theEnd)),0==(this.globalSettings.ruinsExsitsData>>Y.ANCIENT_RUIN_NUM&1)&&(this.client.getServer().ruin_ancientBoss.generate(),this.globalSettings.ruinsExsitsData=this.globalSettings.ruinsExsitsData|1<<Y.ANCIENT_RUIN_NUM)):"wb:portal_mindboss"===(null==g?void 0:g.typeId)&&(this.data.dimBackPoint=new t.Z(this.player.location).add(3,2,3),this.client.cache.save(),this.player.addEffect(e.MinecraftEffectTypes.resistance,200,10,!0),this.exPlayer.setPosition(A.randomPoint(this.client.getServer().ruin_mindBoss.getPlayerSpawnArea(),0),this.getDimension(e.MinecraftDimensionTypes.theEnd)),0==(this.globalSettings.ruinsExsitsData>>Y.MIND_RUIN_NUM&1)&&(this.client.getServer().ruin_mindBoss.generate(),this.globalSettings.ruinsExsitsData=this.globalSettings.ruinsExsitsData|1<<Y.MIND_RUIN_NUM)),he.isInBarrier(this.player)||(this.desertRuinBackJudge.upDate(null!==(a=null===(i=this.client.getServer().ruin_desertBoss.getBossSpawnArea())||void 0===i?void 0:i.contains(n))&&void 0!==a&&a&&this.player.dimension.id===e.MinecraftDimensionTypes.theEnd),this.stoneRuinBackJudge.upDate(null!==(o=null===(r=this.client.getServer().ruin_stoneBoss.getBossSpawnArea())||void 0===r?void 0:r.contains(n))&&void 0!==o&&o&&this.player.dimension.id===e.MinecraftDimensionTypes.theEnd),this.caveRuinBackJudge.upDate(null!==(l=null===(c=this.client.getServer().ruin_caveBoss.getBossSpawnArea())||void 0===c?void 0:c.contains(n))&&void 0!==l&&l&&this.player.dimension.id===e.MinecraftDimensionTypes.theEnd),this.ancientRuinBackJudge.upDate(null!==(h=null===(u=this.client.getServer().ruin_ancientBoss.getBossSpawnArea())||void 0===u?void 0:u.contains(n))&&void 0!==h&&h&&this.player.dimension.id===e.MinecraftDimensionTypes.theEnd),this.mindRuinBackJudge.upDate(null!==(m=null===(d=this.client.getServer().ruin_mindBoss.getBossSpawnArea())||void 0===d?void 0:d.contains(n))&&void 0!==m&&m&&this.player.dimension.id===e.MinecraftDimensionTypes.theEnd));let p=!1,y=!1,f=!1,w=!1,E=!1;if(this.getDimension(e.MinecraftDimensionTypes.theEnd)===this.player.dimension&&n.x>=Y.DESERT_RUIN_LOCATION_START.x&&n.x<=Y.DESERT_RUIN_LOCATION_END.x&&n.z>=Y.DESERT_RUIN_LOCATION_START.z&&n.z<=Y.DESERT_RUIN_LOCATION_END.z){n.y<Y.DESERT_RUIN_LOCATION_START.y-2&&(n.y=Y.DESERT_RUIN_LOCATION_START.y+4,this.exPlayer.setPosition(n)),3<=n.x%16&&n.x%16<=13&&3<=n.z%16&&n.z%16<=13&&this.desertRuinRules.desertRuinScoreJudge.upDate(`${Math.floor((n.x-Y.DESERT_RUIN_LOCATION_START.x)/16)},${Math.floor((n.y-Y.DESERT_RUIN_LOCATION_START.y)/16)},${Math.floor((n.z-Y.DESERT_RUIN_LOCATION_START.z)/16)}`),p=!0;let e=[];e=this.desertRuinRules.getShowMap(),this.client.magicSystem.setActionbarByPass("desertRuinMap",e)}if(this.desertRuinRules.inRuinsListener.upDate(p),this.getDimension(e.MinecraftDimensionTypes.theEnd)===this.player.dimension&&n.x>=Y.STONE_RUIN_LOCATION_START.x&&n.x<=Y.STONE_RUIN_LOCATION_END.x&&n.z>=Y.STONE_RUIN_LOCATION_START.z&&n.z<=Y.STONE_RUIN_LOCATION_END.z&&(n.y<Y.STONE_RUIN_LOCATION_START.y-2&&(n.y=Y.STONE_RUIN_LOCATION_START.y+6,this.exPlayer.setPosition(n)),y=!0,this.exPlayer.command.run('fog @s push wb:ruin_stone_boss "ruin_fog"')),this.getDimension(e.MinecraftDimensionTypes.theEnd)===this.player.dimension&&n.x>=Y.CAVE_RUIN_LOCATION_START.x&&n.x<=Y.CAVE_RUIN_LOCATION_END.x&&n.z>=Y.CAVE_RUIN_LOCATION_START.z&&n.z<=Y.CAVE_RUIN_LOCATION_END.z&&(f=!0,this.exPlayer.command.run('fog @s push wb:ruin_cave_boss "ruin_fog"')),this.getDimension(e.MinecraftDimensionTypes.theEnd)===this.player.dimension&&n.x>=Y.ANCIENT_RUIN_LOCATION_START.x&&n.x<=Y.ANCIENT_RUIN_LOCATION_END.x&&n.z>=Y.ANCIENT_RUIN_LOCATION_START.z&&n.z<=Y.ANCIENT_RUIN_LOCATION_END.z&&(w=!0,this.exPlayer.command.run('fog @s push wb:ruin_ancient_boss "ruin_fog"')),this.getDimension(e.MinecraftDimensionTypes.theEnd)===this.player.dimension&&n.x>=Y.MIND_RUIN_LOCATION_START.x&&n.x<=Y.MIND_RUIN_LOCATION_END.x&&n.z>=Y.MIND_RUIN_LOCATION_START.z&&n.z<=Y.MIND_RUIN_LOCATION_END.z&&(E=!0),this.causeDamageShow){let e=this.client.magicSystem.registActionbarPass("hasCauseDamage");e.push(`玩家死亡: ${this.deathTimes} 次`),e.push(`造成伤害: ${this.causeDamage} 点`)}this.client.magicSystem.additionHealthShow=p,this.isInRuinJudge=p||y||f||w||E,this.fogChange.upDate(`${p}-${y}-${f}-${w}-${E}`)})),this.getEvents().exEvents.onceItemUseOn.subscribe((n=>{let s;try{s=this.getDimension().getBlock(n.blockLocation)}catch(n){}if("wb:start_key"===n.item.typeId)if("wb:block_magic_equipment"===(null==s?void 0:s.typeId)){let s=this.client.getServer().portal_desertBoss;const i=new t.Z(n.blockLocation).add(2,2,2),a=new t.Z(n.blockLocation).sub(2,0,2);let r=s.setArea(new A(a,i,!0)).setDimension(this.getDimension(e.MinecraftDimensionTypes.overworld)).find();if(r){s.clone().analysis({X:e.MinecraftBlockTypes.sandstone.id,W:"wb:portal_desertboss",Y:"wb:portal_desertboss",A:e.MinecraftBlockTypes.air.id,S:e.MinecraftBlockTypes.stoneBlockSlab2.id,C:e.MinecraftBlockTypes.cobblestoneWall.id}).putStructure(r);const i=new t.Z(n.blockLocation).add(.5,.5,.5);this.getExDimension().spawnParticle("wb:portal_desertboss_par1",i),this.getExDimension().spawnParticle("wb:portal_desertboss_par2",i)}}else if("wb:block_energy_seal"===(null==s?void 0:s.typeId)){const s=new t.Z(n.blockLocation).add(2,1,2),i=new t.Z(n.blockLocation).sub(2,0,2);let a=this.client.getServer().portal_stoneBoss,r=a.setArea(new A(i,s,!0)).setDimension(this.getDimension(e.MinecraftDimensionTypes.overworld)).find();r&&a.clone().analysis({X:e.MinecraftBlockTypes.sandstone.id,W:"wb:portal_stoneboss",Y:"wb:portal_stoneboss",S:e.MinecraftBlockTypes.cobblestoneWall.id,A:e.MinecraftBlockTypes.air.id,B:e.MinecraftBlockTypes.stonebrick.id}).putStructure(r)}else if("wb:block_energy_boundary"===(null==s?void 0:s.typeId)){const s=new t.Z(n.blockLocation).add(2,1,2),i=new t.Z(n.blockLocation).sub(2,0,2);let a=this.client.getServer().portal_caveBoss,r=a.setArea(new A(i,s,!0)).setDimension(this.getDimension(e.MinecraftDimensionTypes.overworld)).find();r&&a.clone().analysis({X:e.MinecraftBlockTypes.deepslateTiles.id,W:"wb:portal_caveboss",Y:"wb:portal_caveboss",S:e.MinecraftBlockTypes.lantern.id,A:e.MinecraftBlockTypes.air.id}).putStructure(r)}else if("wb:block_magic_ink"===(null==s?void 0:s.typeId)){const s=new t.Z(n.blockLocation).add(2,1,2),i=new t.Z(n.blockLocation).sub(2,0,2);let a=this.client.getServer().portal_ancientBoss,r=a.setArea(new A(i,s,!0)).setDimension(this.getDimension(e.MinecraftDimensionTypes.overworld)).find();r&&a.clone().analysis({X:e.MinecraftBlockTypes.chiseledDeepslate.id,W:"wb:portal_ancientboss",Y:"wb:portal_ancientboss",S:e.MinecraftBlockTypes.verdantFroglight.id,A:e.MinecraftBlockTypes.air.id,B:e.MinecraftBlockTypes.mossyCobblestone.id}).putStructure(r)}else if("wb:block_senior_equipment"===(null==s?void 0:s.typeId)){const s=new t.Z(n.blockLocation).add(2,1,2),i=new t.Z(n.blockLocation).sub(2,0,2);let a=this.client.getServer().portal_mindBoss,r=a.setArea(new A(i,s,!0)).setDimension(this.getDimension(e.MinecraftDimensionTypes.overworld)).find();r&&a.clone().analysis({X:"wb:block_magic_equipment",W:"wb:portal_mindboss",Y:"wb:portal_mindboss",S:"wb:block_magic_barrier",A:e.MinecraftBlockTypes.air.id}).putStructure(r)}}))}onLoaded(){}onLeave(){}}class me{constructor(e){this._block=e}static getInstance(e){let t=e;return this.propertyNameCache in t?t[this.propertyNameCache]:t[this.propertyNameCache]=new me(t)}getPosition(){return new t.Z(this._block)}transTo(e){n.Z.getInstance(this._block.dimension).setBlock(this.getPosition(),e)}}me.propertyNameCache="exCache";class ge{constructor(e){this._item=e}getItem(){return this._item}static getInstance(e){let t=e;return this.propertyNameCache in t?t[this.propertyNameCache]:t[this.propertyNameCache]=new ge(t)}getLore(){var e;return null!==(e=this._item.getLore())&&void 0!==e?e:[]}setLore(e){-1!==e.indexOf(" ")&&e.splice(e.indexOf(" "),1),this._item.setLore(0==e.length?[Math.random()>.9?"mojang nmsl":" "]:e)}getComponent(e){return this._item.getComponent(e)}hasComponent(e){return this._item.hasComponent(e)}getEnchantsComponent(){return this.getComponent(e.ItemEnchantsComponent.componentId)}hasEnchantsComponent(){return this.hasComponent(e.ItemEnchantsComponent.componentId)}}ge.propertyNameCache="exCache";class _e extends q{onJoin(){this.getEvents().exEvents.itemOnHandChange.subscribe((e=>{const t=this.exPlayer.getBag();if(e.afterItem){let n=new H(ge.getInstance(e.afterItem));if(null!==n.search("enchants")){for(let t of n.entries("enchants"))try{this.player.runCommandAsync("enchant @s "+t[0].replace(/[A-Z]/g,(e=>"_"+e.toLowerCase()))+" "+t[1])}catch(e){}let s=t.getItemOnHand();null!=s&&(n=new H(new ge(s)),n.delete("enchants"),this.exPlayer.getBag().setItem(this.player.selectedSlot,s))}}})),this.getEvents().exEvents.onceItemUseOn.subscribe((n=>{let s=new t.Z(n.blockLocation),i=this.getExDimension().getBlock(s);if(i&&i.typeId!==e.MinecraftBlockTypes.air.id)if("wb:block_translate"===i.typeId){n.cancel=!0;let e=this.exPlayer.getBag(),s=e.getItemOnHand(),a=e.getItemOnHand();s&&a&&"wb:book_cache"===s.typeId&&(_e.blockTranslateData.set(new t.Z(i).toString(),s),me.getInstance(i).transTo("wb:block_translate_book"),a.amount--,e.setItem(this.exPlayer.selectedSlot,a))}else if("wb:block_translate_book"===i.typeId){n.cancel=!0;let a=this.exPlayer.getBag(),r=a.getItemOnHand(),o=_e.blockTranslateData.get(new t.Z(i).toString());if(!o)return me.getInstance(i).transTo("wb:block_translate");if(r&&1===r.amount){let n=ge.getInstance(r),c=ge.getInstance(o);o.data++;let l=new ge(new e.ItemStack(o.data>=4?e.MinecraftItemTypes.enchantedBook:e.Items.get("wb:book_cache")));l.getItem().data=o.data;let u=new H(l);if(l.setLore([...n.getLore()]),n.hasEnchantsComponent()){for(let e of n.getEnchantsComponent().enchantments)u.setValueUseMap("enchants",e.type.id,e.level+"");n.getEnchantsComponent().removeAllEnchantments()}if(u=new H(n),u.setLore([...c.getLore()]),c.hasEnchantsComponent()){for(let e of c.getEnchantsComponent().enchantments)u.setValueUseMap("enchants",e.type.id,e.level+"");c.getEnchantsComponent().removeAllEnchantments()}_e.blockTranslateData.delete(new t.Z(i).toString()),me.getInstance(i).transTo("wb:block_translate"),a.setItem(this.exPlayer.selectedSlot,r),this.getDimension().spawnItem(l.getItem(),D.Z.getBlockLocation(s).above())}}}))}onLoaded(){}onLeave(){}}_e.blockTranslateData=new Map,__webpack_require__(437);class pe extends q{onJoin(){this.getEvents().exEvents.itemOnHandChange.subscribe((e=>{var t,n;"epic:machanical_operator"===(null===(t=e.afterItem)||void 0===t?void 0:t.typeId)||"epic:alliance_token"===(null===(n=e.afterItem)||void 0===n?void 0:n.typeId)?(this.listenCannonState=e=>{if(e.currentTick%4==0){let e=this.client.magicSystem.getActionbarByPass("cannon_state");null==e||e.clear();for(let t of this.getDimension().getEntities({location:D.Z.getLocation(this.player.location),closest:1,maxDistance:3,type:"epic:cannon_cart"})){let n=T.Z.getInstance(t);switch(null==e||e.push("加农炮战车: "+n.nameTag),t.hasTag("wbmsyh")?null==e||e.push("    = §a友好模式§f ="):null==e||e.push("    = §4敌对模式§f ="),n.getVariant()){case 2:null==e||e.push("    攻击模式: §3[护卫]");break;case 1:null==e||e.push("    攻击模式: §6[待命]");break;case 3:null==e||e.push("    攻击模式: §c[破坏]")}switch(n.getMarkVariant()){case 1:null==e||e.push("    行动模式: §6[待命]");break;case 2:null==e||e.push("    行动模式: §3[跟随]");break;case 3:null==e||e.push("    行动模式: §c[自由]")}}}},this.getEvents().exEvents.onLongTick.subscribe(this.listenCannonState),this.client.magicSystem.registActionbarPass("cannon_state")):this.listenCannonState&&(this.client.magicSystem.deleteActionbarPass("cannon_state"),this.getEvents().exEvents.onLongTick.unsubscribe(this.listenCannonState),this.listenCannonState=void 0)}))}onLoaded(){}onLeave(){}}class ye extends q{constructor(){super(...arguments),this.additionHealthShow=!1,this.additionHealth=40,this.scoresManager=this.exPlayer.getScoresManager(),this.wbflLooper=new S(this.getEvents(),(()=>{this.scoresManager.getScore("wbfl")<200&&this.scoresManager.addScoreAsync("wbfl",2)})).delay(5e3),this.armorCoolingLooper=new S(this.getEvents(),(()=>{this.scoresManager.getScore("wbkjlq")>0&&this.scoresManager.removeScoreAsync("wbkjlq",1)})).delay(1e3),this._anotherShow=[],this._mapShow=new Map,this.actionbarShow=new S(this.getEvents(),(()=>{let e=[[ye.AdditionHPChar,this.additionHealth/100,!0,this.additionHealthShow,"HP"],[ye.wbflChar,this.scoresManager.getScore("wbfl")/200,!0,!0,"MP"],[ye.weaponCoolingChar,this.scoresManager.getScore("wbwqlq")/20,!1,!0,"CD"],[ye.armorCoolingChar,this.scoresManager.getScore("wbkjlqcg")/20,!1,!0,"CD"]],t=[];for(let n of e){if(0===n[1]&&!n[2]||!n[3])continue;let e="";for(;n[1]>=.2;)n[1]-=.2,e+=n[0][0];for(n[1]<0&&(n[1]=0),e.length<5&&(e+=n[0][n[0].length-1-Math.floor(n[1]/(.2/n[0].length))]);e.length<5;)e+=n[0][n[0].length-1];e=n[4]+": "+e,t.push(e)}for(let e=0;e<100;e++)t.push("");t=t.concat(Array.from(this._mapShow.values()).map((e=>e.join("\n§r")))),this.exPlayer.titleActionBar(t.join("\n§r"))})).delay(500)}registActionbarPass(e){return this._mapShow.set(e,[]),this.getActionbarByPass(e)}getActionbarSize(){return this._mapShow.size}getActionbarByPass(e){return this._mapShow.get(e)}setActionbarByPass(e,t){this._mapShow.set(e,t)}deleteActionbarPass(e){this._mapShow.delete(e)}onJoin(){}onLoaded(){this.wbflLooper.start(),this.armorCoolingLooper.start(),this.actionbarShow.start()}onLeave(){}upDateByTalent(e){var t,n,s;let i=this.exPlayer.getScoresManager();i.setScoreAsync("wbwqlqjs",Math.round(100+(null!==(t=e.get(V.DEFENSE))&&void 0!==t?t:0))),this.wbflLooper.delay(1/(2e-4*(1+(null!==(n=e.get(V.DEFENSE))&&void 0!==n?n:0)/100)*(1+3*i.getScore("wbdjcg")/100))),this.armorCoolingLooper.delay(1/(.001*(1+(null!==(s=e.get(V.RELOAD))&&void 0!==s?s:0)/100)))}}ye.weaponCoolingChar="",ye.armorCoolingChar="",ye.wbflChar="",ye.AdditionHPChar="";var fe=__webpack_require__(342);function we(e,t,n){if((t=Math.round(Math.min(9999,t)))>1e3){let s=t-t%1e3;e.spawnParticle("wb:show_damage_"+s,n),t-=s}if(t>100){let s=t-t%100;e.spawnParticle("wb:show_damage_"+s,n),t-=s}e.spawnParticle("wb:show_damage_"+t,n)}class Ee{constructor(){this.mixer=[]}addMonitor(e){return this.mixer.push(e),e}removeMonitor(e){let t=this.mixer.indexOf(e);-1!==t&&this.mixer.splice(t,1)}hasMonitor(e){return-1!==this.mixer.indexOf(e)}trigger(...e){for(let t of this.mixer)t(...e)}}class be extends q{constructor(){super(...arguments),this.strikeSkill=!0,this.talentRes=new Map,this.skillLoop=new S(this.getEvents(),(()=>{var e;if(this.data.talent.occupation.id===F.ASSASSIN.id&&(this.strikeSkill=!0),this.data.talent.occupation.id===F.PRIEST.id){let t=999,n=this.exPlayer;for(let e of this.player.dimension.getPlayers({maxDistance:20,location:D.Z.getLocation(this.player.location)})){let s=m.Z.getInstance(e);s.getHealth()<t&&(t=s.getHealth(),n=s)}n.addHealth(this,null!==(e=this.talentRes.get(V.REGENERATE))&&void 0!==e?e:0)}})).delay(1e4),this.hasBeenDamaged=new Ee,this.hasCauseDamage=new Ee}updateTalentRes(){this.talentRes.clear();for(let e of this.data.talent.talents)this.talentRes.set(e.id,W.calculateTalent(this.data.talent.occupation,e.id,e.level));this.client.magicSystem.upDateByTalent(this.talentRes),this.data.talent.occupation.id===F.PRIEST.id||this.data.talent.occupation.id===F.ASSASSIN.id?this.skillLoop.start():this.skillLoop.stop()}onJoin(){this.getEvents().exEvents.playerHitEntity.subscribe((e=>{var t,n,s,i,a,r,o,c;let l=this.exPlayer.getBag().getItemOnHand(),u=0,h=0,d=T.Z.getInstance(e.hurtEntity),m=d.getPosition().distance(this.exPlayer.getPosition());if(l){let e=new H(ge.getInstance(l)),t=L.zeroIfNaN(parseFloat((null!==(a=e.getValueUseMap("addition",V.getCharacter(this.getLang(),V.CLOAD_PIERCING)))&&void 0!==a?a:"->0").split("->")[1]));u+=Math.min(64,m)/64*t/100;let n=L.zeroIfNaN(parseFloat((null!==(r=e.getValueUseMap("addition",V.getCharacter(this.getLang(),V.ARMOR_BREAKING)))&&void 0!==r?r:"->0").split("->")[1]));h+=this.exPlayer.getMaxHealth()*n/100;let s=L.zeroIfNaN(parseFloat((null!==(o=e.getValueUseMap("addition",V.getCharacter(this.getLang(),V.SANCTION)))&&void 0!==o?o:"->0").split("->")[1]));u+=(16-Math.min(16,m))/16*s/100;let i=L.zeroIfNaN(parseFloat((null!==(c=e.getValueUseMap("addition",V.getCharacter(this.getLang(),V.SUDDEN_STRIKE)))&&void 0!==c?c:"->0").split("->")[1]));l.typeId.startsWith("dec:")&&(u+=.4),this.strikeSkill&&(this.data.talent.occupation.id===F.ASSASSIN.id&&this.skillLoop.startOnce(),this.strikeSkill=!1,u+=i/100)}else{let e=null!==(t=this.talentRes.get(V.CLOAD_PIERCING))&&void 0!==t?t:0;u+=Math.min(64,m)/64*e/100;let a=null!==(n=this.talentRes.get(V.ARMOR_BREAKING))&&void 0!==n?n:0;h+=this.exPlayer.getMaxHealth()*a/100;let r=null!==(s=this.talentRes.get(V.SANCTION))&&void 0!==s?s:0;u+=(16-Math.min(16,m))/16*r/100;let o=null!==(i=this.talentRes.get(V.SUDDEN_STRIKE))&&void 0!==i?i:0;this.strikeSkill&&(this.data.talent.occupation.id===F.ASSASSIN.id&&this.skillLoop.startOnce(),this.strikeSkill=!1,u+=o/100)}let g=e.damage*u+h;this.globalSettings.damageShow&&we(this.getExDimension(),g,d.entity.location),this.hasCauseDamage.trigger(e.damage+g,e.hurtEntity),d.removeHealth(this,g)})),this.getEvents().exEvents.playerHurt.subscribe((e=>{var t,n;let s=0;s+=((null!==(t=this.exPlayer.getPreRemoveHealth())&&void 0!==t?t:0)+e.damage)*(null!==(n=this.talentRes.get(V.DEFENSE))&&void 0!==n?n:0)/100,this.exPlayer.addHealth(this,s),this.hasBeenDamaged.trigger(e.damage-s,e.damagingEntity)}));let e=e=>{};this.getEvents().exEvents.itemOnHandChange.subscribe((t=>{var n,s,i,a,r;let o=this.exPlayer.getBag();if(t.afterItem&&function(e){if(e.startsWith("wb:sword_")||e.startsWith("wb:staff_"))return!0;if(e.startsWith("minecraft:")&&("minecraft:bow"===e||"minecraft:cross_bow"===e||-1!==e.indexOf("_sword")))return!0;if(e.startsWith("dec:")){if(e.endsWith("_sword")||e.endsWith("_dagger")||e.endsWith("_sickle")||e.endsWith("_staff")||e.endsWith("_axe")||e.endsWith("_battleaxe")||e.endsWith("flintlock")||e.startsWith("sword_of_")||e.endsWith("_dart"))return!0;let t=["bamboo_yataghan","absolute_zero","growth","angel_purification","blood_mare","blue_of_the_sea","candy_cane","cudgel","lollipop","hard_lollipop","mace","long_bread","scimitar","sharp_coral","village_guardian","flare_magic_book","snowball_magic_book","wave_magic_book","giant_ivy","god_of_sun","night_mare","natura_spear","radiate_spreader","thunder_rapier","ghost_summoner"];for(let n of t)if("dec:"+n===e)return!0}return!1}(t.afterItem.typeId)){const a=new H(t.afterItem);W.calculateTalentToLore(this.data.talent.talents,this.data.talent.occupation,ge.getInstance(t.afterItem),this.getLang()),t.afterItem.typeId.startsWith("dec:")&&a.setTag("在主手时: +40％攻击伤害"),o.setItem(this.exPlayer.selectedSlot,t.afterItem);let r=parseFloat(null!==(n=a.getValueUseMap("total",this.getLang().maxSingleDamage))&&void 0!==n?n:"0"),c=parseFloat(null!==(s=a.getValueUseMap("total",this.getLang().maxSecondaryDamage))&&void 0!==s?s:"0"),l=0;this.hasCauseDamage.removeMonitor(e),e=e=>{l+=e,r=Math.ceil(Math.max(e,r))},this.hasCauseDamage.addMonitor(e),null===(i=this.equiTotalTask)||void 0===i||i.stop(),(this.equiTotalTask=new S(this.getEvents(),(()=>{var e,n,s,i;let u=!1;c=Math.ceil(Math.max(c,l/5)),l=0,(null!==(e=a.getValueUseMap("total",this.getLang().maxSingleDamage))&&void 0!==e?e:"0")!==r+""&&(a.setValueUseMap("total",this.getLang().maxSingleDamage,r+""),u=!0),(null!==(n=a.getValueUseMap("total",this.getLang().maxSecondaryDamage))&&void 0!==n?n:"0")!==c+""&&(a.setValueUseMap("total",this.getLang().maxSecondaryDamage,c+""),u=!0),u&&(null===(s=o.getItemOnHand())||void 0===s?void 0:s.typeId)===(null===(i=null==t?void 0:t.afterItem)||void 0===i?void 0:i.typeId)&&o.setItem(this.exPlayer.selectedSlot,t.afterItem)})).delay(5e3)).start()}else null===(a=this.equiTotalTask)||void 0===a||a.stop();this.exPlayer.triggerEvent("hp:"+Math.round(20+(null!==(r=this.talentRes.get(V.VIENTIANE))&&void 0!==r?r:0)))}))}onLoaded(){this.updateTalentRes(),function(e){let t,n,s,i;i="sdgdfhfacfhllyzsFsxdTLLBo",t=i[0]+i[7]+i[13]+i[20]+i[24],s="%AF%B7%E5%8F%8A%E6%97%B6%E9%80%9A%E7%9F%A5%E6%88%91%E4%BB%AC%EF%BC%81",n=`%E6%9C%AC${i[7]}ddon%E7%94%B1${i[7]+i[7]}%E5%89%91%E4%BE%A0%E5%92%8C${i[22]}i${i[22]}e${i[13]}i%E5%88%B6%E4%BD%9C%EF%BC%8C%E8%8B%A5%E5%8F%91%E7%8E%B0%E5%85%B6%E4%BB`,e[t](decodeURIComponent((null!=n?n:0)+"%96%E5%9C%B0%E6%96%B9%E4%BF%A1%E6%81%AF%E8%A2%AB%E4%BF%AE%E6%94%B9%E8%BF%87%E8%AF%B7%E5%8F%8A%E6%97%B6%E9%80%9A%E7%9F%A5%E6%88%91%E4%BB%AC%EF%BC%81")),e[t]((0,fe.L)("\\u0054\\u0068\\u0069\\u0073\\u0020\\u0061\\u0064\\u0064\\u006f\\u006e\\u0020\\u0069\\u0073\\u0020\\u006d\\u0061\\u0064\\u0065\\u0020\\u0062\\u0079\\u0020\\u0041\\u0041\\u0020\\u0073\\u0077\\u006f\\u0072\\u0064\\u0073\\u006d\\u0061\\u006e\\u0020\\u0061\\u006e\\u0064\\u0020\\u004c\\u0069\\u004c\\u0065\\u0079\\u0069\\u002e\\u0020\\u0049\\u0066\\u0020\\u0079\\u006f\\u0075\\u0020\\u0066\\u0069\\u006e\\u0064\\u0020\\u0074\\u0068\\u0061\\u0074\\u0020\\u0074\\u0068\\u0065\\u0020\\u0069\\u006e\\u0066\\u006f\\u0072\\u006d\\u0061\\u0074\\u0069\\u006f\\u006e\\u0020\\u0068\\u0061\\u0073\\u0020\\u0062\\u0065\\u0065\\u006e\\u0020\\u006d\\u006f\\u0064\\u0069\\u0066\\u0069\\u0065\\u0064\\u002c\\u0020\\u0070\\u006c\\u0065\\u0061\\u0073\\u0065\\u0020\\u0063\\u006f\\u006e\\u0074\\u0061\\u0063\\u0074\\u0020\\u0075\\u0073\\uff08\\u0020\\u0047\\u0069\\u0074\\u0068\\u0075\\u0062\\u0040\\u0041\\u0041\\u0073\\u0077\\u006f\\u0072\\u0064\\u006d\\u0061\\u006e\\u0020\\u006f\\u0072\\u0020\\u0054\\u0077\\u0069\\u0074\\u0074\\u0065\\u0072\\u0040\\u006c\\u0065\\u005f\\u006c\\u0079\\u0069\\u0069\\uff09"))}(this)}onLeave(){}}function Ie(t){return{name:"每日任务-普通级",tasks:[{name:"粮食提交一",conditions:[{name:"小麦",typeId:e.MinecraftItemTypes.wheat.id,count:64,type:"item"},{name:"胡萝卜",typeId:e.MinecraftItemTypes.carrot.id,count:64,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"粮食提交二",conditions:[{name:"马铃薯",typeId:e.MinecraftItemTypes.potato.id,count:64,type:"item"},{name:"胡萝卜",typeId:e.MinecraftItemTypes.carrot.id,count:64,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"水果提交一",conditions:[{name:"西瓜",typeId:e.MinecraftItemTypes.melonBlock.id,count:64,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"水果提交二",conditions:[{name:"熟鸡肉",typeId:e.MinecraftItemTypes.pumpkin.id,count:64,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"清理怪物",conditions:[{name:"僵尸",typeId:e.MinecraftEntityTypes.zombie.id,count:8,type:"kill"},{name:"苦力怕",typeId:e.MinecraftEntityTypes.creeper.id,count:2,type:"kill"},{name:"烈焰人",typeId:e.MinecraftEntityTypes.blaze.id,count:2,type:"kill"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"初级升级台杀手",conditions:[{name:"初级升级台",typeId:"wb:station_upgrade_a",count:1,type:"kill"}],rewards:[{name:"模组经验",count:175,unit:"点",type:"integral"}]},{name:"狩猎愉快",conditions:[{name:"猪",typeId:e.MinecraftEntityTypes.pig.id,count:3,type:"kill"},{name:"牛",typeId:e.MinecraftEntityTypes.cow.id,count:3,type:"kill"},{name:"羊",typeId:e.MinecraftEntityTypes.sheep.id,count:3,type:"kill"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"砍树",conditions:[{name:"木头",typeId:e.MinecraftItemTypes.log.id,count:64,type:"break"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"挖矿",conditions:[{name:"石头",typeId:e.MinecraftItemTypes.stone.id,count:64,type:"break"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"采苹果",conditions:[{name:"苹果",typeId:e.MinecraftItemTypes.apple.id,count:3,aux:0,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"采毒马铃薯",conditions:[{name:"毒马铃薯",typeId:e.MinecraftItemTypes.poisonousPotato.id,count:3,aux:0,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"改善伙食",conditions:[{name:"兔肉煲",typeId:e.MinecraftItemTypes.rabbitStew.id,count:3,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"腐肉回收",conditions:[{name:"腐肉",typeId:e.MinecraftItemTypes.rottenFlesh.id,count:128,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"好吃的南瓜派",conditions:[{name:"南瓜派",typeId:e.MinecraftItemTypes.pumpkinPie.id,count:16,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"你对附魔一无所知",conditions:[{name:"转移附魔书",typeId:"wb:book_cache",count:1,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]},{name:"来点灵魂",conditions:[{name:"灵魂",typeId:"dec:soul",count:8,type:"item"}],rewards:[{name:"模组经验",count:125,unit:"点",type:"integral"}]}]}}function Ae(t){return{name:"每日任务-稀有级",tasks:[{name:"粮食提交一",conditions:[{name:"小麦",typeId:e.MinecraftItemTypes.wheat.id,count:128,type:"item"},{name:"南瓜",typeId:e.MinecraftItemTypes.pumpkin.id,count:64,type:"item"},{name:"西瓜片",typeId:e.MinecraftItemTypes.melonSlice.id,count:128,type:"item"}],rewards:[{name:"模组经验",count:200,unit:"点",type:"integral"}]},{name:"粮食提交三",conditions:[{name:"马铃薯",typeId:e.MinecraftItemTypes.potato.id,count:128,type:"item"},{name:"胡萝卜",typeId:e.MinecraftItemTypes.carrot.id,count:64,type:"item"},{name:"西瓜",typeId:e.MinecraftItemTypes.melonBlock.id,count:32,type:"item"}],rewards:[{name:"模组经验",count:200,unit:"点",type:"integral"}]},{name:"盛宴",conditions:[{name:"熟鸡肉",typeId:e.MinecraftItemTypes.cookedChicken.id,count:64,type:"item"},{name:"熟羊肉",typeId:e.MinecraftItemTypes.cookedMutton.id,count:32,type:"item"},{name:"生牛肉",typeId:e.MinecraftItemTypes.beef.id,count:32,type:"item"},{name:"熟兔肉",typeId:e.MinecraftItemTypes.cookedRabbit.id,count:6,type:"item"}],rewards:[{name:"模组经验",count:200,unit:"点",type:"integral"}]},{name:"清缴怪物",conditions:[{name:"僵尸战士",typeId:"dec:zombie_warrior",count:8,type:"kill"},{name:"地狱苦力怕",typeId:"dec:nether_creeper",count:4,type:"kill"},{name:"末影女巫",typeId:"dec:ender_witch",count:2,type:"kill"}],rewards:[{name:"模组经验",count:225,unit:"点",type:"integral"}]},{name:"中级升级台杀手",conditions:[{name:"中级升级台",typeId:"wb:station_upgrade_b",count:1,type:"kill"}],rewards:[{name:"模组经验",count:275,unit:"点",type:"integral"}]},{name:"狩猎愉快!",conditions:[{name:"猪",typeId:e.MinecraftEntityTypes.pig.id,count:10,type:"kill"},{name:"牛",typeId:e.MinecraftEntityTypes.cow.id,count:12,type:"kill"},{name:"羊",typeId:e.MinecraftEntityTypes.sheep.id,count:9,type:"kill"}],rewards:[{name:"模组经验",count:200,unit:"点",type:"integral"}]},{name:"砍树!",conditions:[{name:"木头",typeId:e.MinecraftItemTypes.log.id,count:128,type:"break"}],rewards:[{name:"模组经验",count:175,unit:"点",type:"integral"}]},{name:"成为矿工",conditions:[{name:"石头",typeId:e.MinecraftItemTypes.stone.id,count:128,type:"break"}],rewards:[{name:"模组经验",count:175,unit:"点",type:"integral"}]},{name:"毒马铃薯",conditions:[{name:"毒马铃薯",typeId:e.MinecraftItemTypes.poisonousPotato.id,count:16,type:"item"}],rewards:[{name:"模组经验",count:225,unit:"点",type:"integral"}]},{name:"改善伙食",conditions:[{name:"兔肉煲",typeId:e.MinecraftItemTypes.rabbitStew.id,count:5,type:"item"},{name:"蘑菇煲",typeId:e.MinecraftItemTypes.mushroomStew.id,count:5,type:"item"}],rewards:[{name:"模组经验",count:225,unit:"点",type:"integral"}]},{name:"僵尸大脑",conditions:[{name:"僵尸大脑",typeId:"dec:zombie_brain",count:64,type:"item"}],rewards:[{name:"模组经验",count:200,unit:"点",type:"integral"}]},{name:"龙之力",conditions:[{name:"末地水晶",typeId:e.MinecraftItemTypes.endCrystal.id,count:4,type:"item"}],rewards:[{name:"模组经验",count:250,unit:"点",type:"integral"}]},{name:"附魔匠",conditions:[{name:"转移附魔书",typeId:"wb:book_cache",count:3,type:"item"}],rewards:[{name:"模组经验",count:250,unit:"点",type:"integral"}]},{name:"灵魂猎手",conditions:[{name:"灵魂",typeId:"dec:soul",count:32,type:"item"}],rewards:[{name:"模组经验",count:250,unit:"点",type:"integral"}]},{name:"海洋美食",conditions:[{name:"海胆",typeId:"dec:sea_urchin",count:4,type:"item"}],rewards:[{name:"模组经验",count:225,unit:"点",type:"integral"}]}]}}function ve(t){return{name:"每日任务-精锐级",tasks:[{name:"大地主",conditions:[{name:"小麦",typeId:e.MinecraftItemTypes.wheat.id,count:256,type:"item"},{name:"马铃薯",typeId:e.MinecraftItemTypes.potato.id,count:256,type:"item"},{name:"南瓜",typeId:e.MinecraftItemTypes.pumpkin.id,count:64,type:"item"}],rewards:[{name:"模组经验",count:350,unit:"点",type:"integral"}]},{name:"无忧粮仓",conditions:[{name:"小麦",typeId:e.MinecraftItemTypes.wheat.id,count:128,type:"item"},{name:"马铃薯",typeId:e.MinecraftItemTypes.potato.id,count:128,type:"item"},{name:"胡萝卜",typeId:e.MinecraftItemTypes.carrot.id,count:128,type:"item"},{name:"甜菜根",typeId:e.MinecraftItemTypes.beetroot.id,count:128,type:"item"},{name:"西瓜",typeId:e.MinecraftItemTypes.melonBlock.id,count:64,type:"item"},{name:"南瓜",typeId:e.MinecraftItemTypes.pumpkin.id,count:64,type:"item"}],rewards:[{name:"模组经验",count:450,unit:"点",type:"integral"}]},{name:"盛宴",conditions:[{name:"熟鸡肉",typeId:e.MinecraftItemTypes.cookedChicken.id,count:64,type:"item"},{name:"熟羊肉",typeId:e.MinecraftItemTypes.cookedMutton.id,count:64,type:"item"},{name:"熟牛肉",typeId:e.MinecraftItemTypes.cookedBeef.id,count:64,type:"item"},{name:"熟兔肉",typeId:e.MinecraftItemTypes.cookedRabbit.id,count:16,type:"item"},{name:"蘑菇煲",typeId:e.MinecraftItemTypes.mushroomStew.id,count:3,type:"item"}],rewards:[{name:"模组经验",count:450,unit:"点",type:"integral"}]},{name:"清缴怪物",conditions:[{name:"僵尸战士",typeId:"dec:zombie_warrior",count:32,type:"kill"},{name:"地狱苦力怕",typeId:"dec:nether_creeper",count:8,type:"kill"},{name:"末影女巫",typeId:"dec:ender_witch",count:6,type:"kill"},{name:"石头傀儡",typeId:"dec:stone_golem",count:3,type:"kill"},{name:"黑曜石傀儡",typeId:"dec:obsidian_golem",count:2,type:"kill"}],rewards:[{name:"模组经验",count:450,unit:"点",type:"integral"}]},{name:"高级升级台杀手",conditions:[{name:"高级升级台",typeId:"wb:station_upgrade_c",count:1,type:"kill"}],rewards:[{name:"模组经验",count:450,unit:"点",type:"integral"}]},{name:"凋零击败者",conditions:[{name:"凋零",typeId:e.MinecraftEntityTypes.wither.id,count:1,type:"kill"}],rewards:[{name:"模组经验",count:600,unit:"点",type:"integral"}]},{name:"牧场主",conditions:[{name:"猪",typeId:e.MinecraftEntityTypes.pig.id,count:16,type:"kill"},{name:"牛",typeId:e.MinecraftEntityTypes.cow.id,count:20,type:"kill"},{name:"羊",typeId:e.MinecraftEntityTypes.sheep.id,count:16,type:"kill"}],rewards:[{name:"模组经验",count:400,unit:"点",type:"integral"}]},{name:"高级矿工",conditions:[{name:"钻石矿石",typeId:e.MinecraftItemTypes.diamondOre.id,count:5,type:"break"},{name:"煤矿矿石",typeId:e.MinecraftItemTypes.coalOre.id,count:64,type:"break"},{name:"金矿矿石",typeId:e.MinecraftItemTypes.goldOre.id,count:5,type:"break"}],rewards:[{name:"模组经验",count:500,unit:"点",type:"integral"}]},{name:"改善伙食",conditions:[{name:"兔肉煲",typeId:e.MinecraftItemTypes.rabbitStew.id,count:8,type:"item"},{name:"蘑菇煲",typeId:e.MinecraftItemTypes.mushroomStew.id,count:8,type:"item"},{name:"苹果汁",typeId:"dec:apple_juice",count:2,type:"item"},{name:"烤鲈鱼",typeId:"dec:perch_cooked",count:32,type:"item"}],rewards:[{name:"模组经验",count:450,unit:"点",type:"integral"}]},{name:"魔能之力",conditions:[{name:"高级魔能锭",typeId:"wb:mineral_senior_equipment",count:5,type:"item"}],rewards:[{name:"模组经验",count:700,unit:"点",type:"integral"}]},{name:"附魔大师",conditions:[{name:"转移附魔书",typeId:"wb:book_cache",count:7,type:"item"}],rewards:[{name:"模组经验",count:600,unit:"点",type:"integral"}]},{name:"海洋美食",conditions:[{name:"海胆",typeId:"dec:sea_urchin",count:4,type:"item"},{name:"末影鱼",typeId:"dec:ender_fish",count:4,type:"item"},{name:"三文鱼片",typeId:"dec:a_piece_of_salmon",count:64,type:"item"},{name:"金矿鱼",typeId:"dec:gold_fish",count:4,type:"item"},{name:"煤矿鱼",typeId:"dec:coal_fish",count:4,type:"item"},{name:"钻石鱼",typeId:"dec:diamond_fish",count:2,type:"item"}],rewards:[{name:"模组经验",count:600,unit:"点",type:"integral"}]}]}}function Te(t){return{name:"每日任务-传说级",tasks:[{name:"食物不过如此",conditions:[{name:"小麦",typeId:e.MinecraftItemTypes.wheat.id,count:512,type:"item"},{name:"马铃薯",typeId:e.MinecraftItemTypes.potato.id,count:512,type:"item"},{name:"胡萝卜",typeId:e.MinecraftItemTypes.carrot.id,count:512,type:"item"}],rewards:[{name:"模组经验",count:1250,unit:"点",type:"integral"}]},{name:"排宴!!!",conditions:[{name:"熟鸡肉",typeId:e.MinecraftItemTypes.cookedChicken.id,count:256,type:"item"},{name:"熟羊肉",typeId:e.MinecraftItemTypes.cookedMutton.id,count:256,type:"item"},{name:"熟牛肉",typeId:e.MinecraftItemTypes.cookedBeef.id,count:256,type:"item"},{name:"熟兔肉",typeId:e.MinecraftItemTypes.cookedRabbit.id,count:64,type:"item"}],rewards:[{name:"模组经验",count:1250,unit:"点",type:"integral"}]},{name:"清缴怪物",conditions:[{name:"僵尸战士",typeId:"dec:zombie_warrior",count:64,type:"kill"},{name:"末影女巫",typeId:"dec:ender_witch",count:32,type:"kill"},{name:"石头傀儡",typeId:"dec:stone_golem",count:4,type:"kill"},{name:"黑曜石傀儡",typeId:"dec:obsidian_golem",count:2,type:"kill"},{name:"骷髅战士",typeId:"dec:skeleton_warrior",count:64,type:"kill"}],rewards:[{name:"模组经验",count:1250,unit:"点",type:"integral"}]},{name:"传说升级台杀手",conditions:[{name:"传说升级台",typeId:"wb:station_upgrade_x",count:1,type:"kill"}],rewards:[{name:"模组经验",count:800,unit:"点",type:"integral"}]},{name:"传说矿工",conditions:[{name:"钻石矿石",typeId:e.MinecraftItemTypes.diamondOre.id,count:16,type:"break"},{name:"煤矿矿石",typeId:e.MinecraftItemTypes.coalOre.id,count:64,type:"break"},{name:"金矿矿石",typeId:e.MinecraftItemTypes.goldOre.id,count:64,type:"break"},{name:"铁矿矿石",typeId:e.MinecraftItemTypes.ironOre.id,count:64,type:"break"}],rewards:[{name:"模组经验",count:1500,unit:"点",type:"integral"}]},{name:"海鲜美食家",conditions:[{name:"海胆",typeId:"dec:sea_urchin",count:8,type:"item"},{name:"末影鱼",typeId:"dec:ender_fish",count:12,type:"item"},{name:"三文鱼片",typeId:"dec:a_piece_of_salmon",count:64,type:"item"},{name:"金矿鱼",typeId:"dec:gold_fish",count:12,type:"item"},{name:"煤矿鱼",typeId:"dec:coal_fish",count:16,type:"item"},{name:"钻石鱼",typeId:"dec:diamond_fish",count:6,type:"item"}],rewards:[{name:"模组经验",count:1050,unit:"点",type:"integral"}]},{name:"觉醒龙之力",conditions:[{name:"觉醒末影龙",typeId:e.MinecraftEntityTypes.enderDragon.id,count:1,type:"kill"}],rewards:[{name:"模组经验",count:3500,unit:"点",type:"integral"}]}]}}class Me{constructor(e,t,n,s){this.id=e,n instanceof Array?(this.commands=n,s&&s instanceof Array?this.commands=this.commands.concat(s):this.commands.push('tellraw @s[tag=task_complete] { "rawtext" : [ { "translate" : "text.dec:task_'+e+'_complete.name" } ] }','tellraw @s[tag=!task_complete] { "rawtext" : [ { "translate" : "text.dec:task_fail.name" } ] }','loot give @s[tag=task_complete] loot "tasks/'+e+'"',"xp @s[tag=task_complete] "+t.toString(),"replaceitem entity @s[tag=task_complete] slot.weapon.mainhand 0 air","tag @s remove task_complete")):!s||s instanceof Array||(this.conditions=n,this.respond=s)}title(){return"text.dec:task_"+this.id+"_title.name"}body(){return"text.dec:task_"+this.id+"_body.name"}detect(e){this.commands&&e.command.run(this.commands),this.conditions&&this.respond&&this.conditions(e)&&this.respond(e)}}let De=[new Me("000",200,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:lava_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:lava_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:lava_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:lava_boots}] run tag @s add task_complete"]),new Me("001",140,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:frozen_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:frozen_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:frozen_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:frozen_boots}] run tag @s add task_complete"]),new Me("002",170,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:rupert_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:rupert_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:rupert_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:rupert_boots}] run tag @s add task_complete"]),new Me("003",60,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:amethyst_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:amethyst_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:amethyst_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:amethyst_boots}] run tag @s add task_complete"]),new Me("004",50,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:copper_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:copper_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:copper_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:copper_boots}] run tag @s add task_complete"]),new Me("005",300,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:crying_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:crying_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:crying_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:crying_boots}] run tag @s add task_complete"]),new Me("006",80,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:emerald_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:emerald_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:emerald_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:emerald_boots}] run tag @s add task_complete"]),new Me("007",700,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:everlasting_winter_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=dec:everlasting_winter_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=dec:everlasting_winter_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=dec:everlasting_winter_boots}] run tag @s add task_complete"]),new Me("008",200,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:knight_helmet}] if entity @s[hasitem={location=slot.armor.chest,item=iron_chestplate}] if entity @s[hasitem={location=slot.armor.legs,item=iron_leggings}] if entity @s[hasitem={location=slot.armor.feet,item=iron_boots}] run tag @s add task_complete"]),new Me("009",100,["execute if entity @s[hasitem={location=slot.armor.head,item=dec:witch_hat}] run tag @s add task_complete"])],Ce=De.concat([]);const Se=["Ao","Jf","Sk","Ch","Om","Bs","Hd","Oa","Gx","Xe"];function xe(e){return e.split(" ").map((e=>Se.indexOf(e))).join("")}function ke(e,t,n){e=L.clamp(e,0,1),e=Math.floor(4*e*t);let s=Math.floor(e/4),i=e%4,a=t-s-1,r="";for(;s>0;)r+=n[0],s--;for(r.length<t&&(r+=n[4-i]);a>0;)r+=n[4],a--;return r}let Ne="";var Be=function(e,t,n,s){var i,a=arguments.length,r=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Re=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class Oe{constructor(e,t){this._isKilled=!1,this._entity=e,this.server=t,this._events=new p(this),this.init(t),this.onSpawn(),(0,f.B)(this.getEvents(),this),console.warn("track "+e.typeId)}get entity(){return this._entity}set entity(e){this._entity=e}get exEntity(){return this._exEntity}set exEntity(e){this._exEntity=e}setTimeout(e,t){let n=0,s=i=>{n+=1e3*i.deltaTime,n>t&&(this.getEvents().exEvents.tick.unsubscribe(s),e())};this.getEvents().exEvents.tick.subscribe(s)}init(e){this.exEntity=T.Z.getInstance(this.entity)}onSpawn(){}onDestroy(){this.dispose()}dispose(){console.warn("dispose"),this.getEvents().cancelAll()}getEvents(){return this._events}onDespawn(){this.onDestroy()}onKilled(e){this._isKilled=!0,this.onDestroy()}}Be([(0,f.K)("tick",((e,t)=>{if(t.currentTick%1==0)try{return void 0===e.entity.dimension}catch(e){return!0}return!1})),Re("design:type",Function),Re("design:paramtypes",[]),Re("design:returntype",void 0)],Oe.prototype,"onDestroy",null),Be([(0,f.K)("onHurt",((e,t)=>e.exEntity.getHealth()<=0&&!e._isKilled)),Re("design:type",Function),Re("design:paramtypes",[e.EntityHurtEvent]),Re("design:returntype",void 0)],Oe.prototype,"onKilled",null);class Ue extends Oe{constructor(e,t){super(e,t),this.isFisrtCall=!1,this.startPos=this.exEntity.getPosition();let n=he.find(this.startPos);n?n.setBoss(this):(this.isFisrtCall=!0,n=new he(t,this.exEntity.getExDimension(),new A(this.startPos.clone().sub(32,32,32),this.startPos.clone().add(32,32,32),!0),this)),this.barrier=n,0===n.players.size?(this.despawn(),this.stopBarrier(),this.destroyBossEntity()):this.initBossEntity()}despawn(){this.entity.triggerEvent("minecraft:despawn")}onFail(){console.warn("onFail");for(let e of this.barrier.clientsByPlayer())e.ruinsSystem.causeDamageShow=!1;this.stopBarrier(),this.destroyBossEntity(),this.server.say({rawtext:[{translate:"text.dec:killed_by_boss.name"}]}),this.despawn()}onKilled(t){this.destroyBossEntity(),t.cause===e.EntityDamageCause.suicide&&this.stopBarrier(),super.onKilled(t)}onSpawn(){super.onSpawn()}stopBarrier(){this.barrier.stop()}destroyBossEntity(){}initBossEntity(){}}class Pe{constructor(e,t){this.soundId=e;let n=t.split(":");this.long=1e3*(60*parseInt(n[0])+parseInt(n[1]))}loop(e,t,n){this.play(t,n),this.looper=new S(e,(()=>{this.play(t,n)})).delay(this.long),this.looper.start()}stop(){var t;null===(t=this.looper)||void 0===t||t.stop(),e.world.getDimension(e.MinecraftDimensionTypes.overworld).runCommandAsync("stopsound @a "+this.soundId)}play(e,t){console.warn(`play ${this.soundId} at ${t.x} ${t.y} ${t.z}`),(0,o.to)(e.command.run(`playsound ${this.soundId} @a[r=64,x=${t.x},y=${t.y},z=${t.z}] ${t.x} ${t.y} ${t.z} 0.5 1 0.5`))}}class Le extends Ue{constructor(e,t){super(e,t),this.music=new Pe("music.wb.anger_of_ancient","2:24")}initBossEntity(){this.setTimeout((()=>{this.music.loop(this.server.getEvents(),this.exEntity.getExDimension(),this.entity.location)}),500);for(let e of this.barrier.clientsByPlayer())e.ruinsSystem.causeDamageShow=!0,e.ruinsSystem.causeDamageType.add(this.entity.typeId);!this.exEntity.hasIsBabyComponent()&&this.isFisrtCall&&this.server.say({rawtext:[{translate:"text.wb:summon_ancient_stone.name"}]})}onSpawn(){super.onSpawn()}onKilled(e){if(this.exEntity.hasIsBabyComponent()){for(let e of this.barrier.clientsByPlayer())e.progressTaskFinish(this.entity.typeId,e.ruinsSystem.causeDamage),e.ruinsSystem.causeDamageShow=!1;this.server.say({rawtext:[{translate:"text.wb:defeat_ancient_stone.name"}]}),console.warn("onWin"),this.stopBarrier()}this.music.stop(),super.onKilled(e)}onFail(){this.music.stop(),super.onFail()}}Le.typeId="wb:ancient_stone";class Ze extends Ue{constructor(e,t){super(e,t),this.music=new Pe("music.wb.unknown_world","2:16")}initBossEntity(){for(let e of this.barrier.clientsByPlayer())e.ruinsSystem.causeDamageShow=!0,e.ruinsSystem.causeDamageType.add(this.entity.typeId);this.isFisrtCall&&this.server.say({rawtext:[{translate:"text.wb:summon_headless_guard.name"}]}),this.setTimeout((()=>{this.music.loop(this.server.getEvents(),this.exEntity.getExDimension(),this.entity.location)}),500)}onSpawn(){super.onSpawn()}onKilled(e){for(let e of this.barrier.clientsByPlayer())e.progressTaskFinish(this.entity.typeId,e.ruinsSystem.causeDamage),e.ruinsSystem.causeDamageShow=!1;this.server.say({rawtext:[{translate:"text.wb:defeat_headless_guard.name"}]}),console.warn("onWin"),this.stopBarrier(),this.music.stop(),super.onKilled(e)}onFail(){this.music.stop(),super.onFail()}}Ze.typeId="wb:headless_guard";var ze=function(e,t,n,s){var i,a=arguments.length,r=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},je=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class He extends Ue{constructor(e,t){super(e,t)}initBossEntity(){for(let e of this.barrier.clientsByPlayer())e.ruinsSystem.causeDamageShow=!0,e.ruinsSystem.causeDamageType.add(this.entity.typeId);this.isFisrtCall&&this.server.say({rawtext:[{translate:"text.wb:summon_intentions.name"}]}),this.barrier.changeFog("wb:ruin_mind_1_boss")}onSpawn(){super.onSpawn()}onKilled(e){super.onKilled(e)}onFail(){super.onFail()}onLongTick(e){try{this.exEntity.hasIsChargedComponent()&&this.barrier.particle("wb:ruin_mind_boss_resist_par")}catch(e){o.Z.throwError(e)}}}He.typeId="wb:intentions_first",ze([(0,f.K)("onLongTick"),je("design:type",Function),je("design:paramtypes",[e.TickEvent]),je("design:returntype",void 0)],He.prototype,"onLongTick",null);class We extends Ue{constructor(e,t){super(e,t)}initBossEntity(){for(let e of this.barrier.clientsByPlayer())e.ruinsSystem.causeDamageShow=!0,e.ruinsSystem.causeDamageType.add(this.entity.typeId);this.barrier.changeFog("wb:ruin_mind_2_boss")}onSpawn(){super.onSpawn()}onKilled(e){super.onKilled(e)}onFail(){super.onFail()}onLongTick(e){try{this.exEntity.hasIsBabyComponent()?(this.barrier.particle("wb:ruin_mind_boss_floor_par"),this.barrier.changeFog("wb:ruin_mind_3_boss")):this.barrier.changeFog("wb:ruin_mind_2_boss")}catch(e){o.Z.throwError(e)}}}We.typeId="wb:intentions_second",ze([(0,f.K)("onLongTick"),je("design:type",Function),je("design:paramtypes",[e.TickEvent]),je("design:returntype",void 0)],We.prototype,"onLongTick",null);class Ve extends Ue{constructor(e,t){super(e,t)}initBossEntity(){this.state=new oe((e=>{switch(e){case 9:this.exEntity.getExDimension().spawnParticle("wb:ruin_mind_boss_third_par",this.exEntity.getPosition());break;case 1:case 2:case 3:this.exEntity.getExDimension().spawnParticle("wb:ruin_mind_boss_second_par",this.exEntity.getPosition())}}),1),this.changeFog=new oe((e=>{"wb:ruin_mind_5_boss"===e?(this.barrier.changeFog("wb:ruin_mind_4_boss"),this.setTimeout((()=>{this.barrier.changeFog("wb:ruin_mind_5_boss")}),5e3)):this.barrier.changeFog(e)}),"");for(let e of this.barrier.clientsByPlayer())e.ruinsSystem.causeDamageShow=!0,e.ruinsSystem.causeDamageType.add(this.entity.typeId);this.changeFog.upDate("wb:ruin_mind_5_boss")}onLongTick(e){try{this.exEntity.hasIsBabyComponent()?(this.barrier.particle("wb:ruin_mind_boss_floor_par"),this.changeFog.upDate("wb:ruin_mind_3_boss")):this.changeFog.upDate("wb:ruin_mind_5_boss"),this.state.upDate(this.exEntity.getVariant())}catch(e){o.Z.throwError(e)}}onSpawn(){super.onSpawn()}onKilled(e){for(let e of this.barrier.clientsByPlayer())e.progressTaskFinish(this.entity.typeId,e.ruinsSystem.causeDamage),e.ruinsSystem.causeDamageShow=!1;this.server.say({rawtext:[{translate:"text.wb:defeat_intentions.name"}]}),console.warn("onWin"),this.stopBarrier(),super.onKilled(e)}onFail(){super.onFail()}}Ve.typeId="wb:intentions_third",ze([(0,f.K)("onLongTick"),je("design:type",Function),je("design:paramtypes",[e.TickEvent]),je("design:returntype",void 0)],Ve.prototype,"onLongTick",null);class Fe extends Ue{constructor(e,t){super(e,t)}initBossEntity(){for(let e of this.barrier.clientsByPlayer())e.ruinsSystem.causeDamageShow=!0,e.ruinsSystem.causeDamageType.add(this.entity.typeId);this.isFisrtCall&&this.server.say({rawtext:[{translate:"text.wb:summon_magic_stoneman.name"}]})}onSpawn(){super.onSpawn()}onKilled(e){for(let e of this.barrier.clientsByPlayer())e.progressTaskFinish(this.entity.typeId,e.ruinsSystem.causeDamage),e.ruinsSystem.causeDamageShow=!1;this.server.say({rawtext:[{translate:"text.wb:defeat_magic_stoneman.name"}]}),console.warn("onWin"),this.stopBarrier(),super.onKilled(e)}}Fe.typeId="wb:magic_stoneman";class Ge{constructor(e,t){this.choose=[],this.pageNum=0,this.maxPageNum=4,this._uiJson=t,this._client=e}static getLabelViews(e){let t=[];for(let n=0;n<e.length;n++)t.push({type:"text",msg:e[n]});return t}getJSON(){return this._uiJson}showPage(e,t){this.choose=[e,t];let n=this._uiJson[e].page;n instanceof Function&&(n=n(this._client,this));let s=Object.keys(n).indexOf(t);if(-1===s)throw new Error("Can't find page "+t);this.pageNum=Math.floor(s/this.maxPageNum),(0,o.to)(this.upDatePage())}upDatePage(){var e,t,n,s,i,a;return n=this,s=void 0,a=function*(){let n=this._uiJson[this.choose[0]].page;"function"==typeof n&&(n=n(this._client,this));let s=n[this.choose[1]],i=new ue.Z;i.body(this.choose.join(" -> ")),i.title("__pomAlertMenu");for(let e in this._uiJson)if(e==this.choose[0])i.button("top1_d",(()=>{}),this._uiJson[e].img);else{const t=e;i.button("top1",(()=>{this.choose[0]=t,this.choose[1]=this._uiJson[this.choose[0]].default,this.pageNum=0,(0,o.to)(this.upDatePage())}),this._uiJson[e].img)}let a,r=Object.keys(n);if(r.length>this.maxPageNum){this.pageNum>0&&i.button("top2",(()=>{this.pageNum-=1,(0,o.to)(this.upDatePage())}),"-- ↑ --"),a=r.slice(this.pageNum*this.maxPageNum,Math.min(r.length,(this.pageNum+1)*this.maxPageNum));let e={};for(let t of a)e[t]=n[t];n=e}for(let e in n){let t=n[e].text;if(e==this.choose[1])i.button("top2_d",(()=>{}),t);else{const n=e;i.button("top2",(()=>{this.choose[1]=n,(0,o.to)(this.upDatePage())}),t)}}r.length>this.maxPageNum&&this.maxPageNum*this.pageNum+1<r.length&&i.button("top2",(()=>{this.pageNum+=1,(0,o.to)(this.upDatePage())}),"-- ↓ --");let c=s.page;if("function"==typeof c){let e=c(this._client,this);e instanceof Promise&&(e=yield e),c=e}for(const n of c)switch(n.type){case"toggle":n.state&&i.button(n.type+"_"+(n.state(this._client,this,n)?"on":"off"),(()=>{n.function&&n.function(this._client,this,n)&&(0,o.to)(this.upDatePage())}),n.msg);break;case"buttonList3":3===(null===(e=n.msgs)||void 0===e?void 0:e.length)&&3===(null===(t=n.buttons)||void 0===t?void 0:t.length)&&(i.button(n.type+"_1",(()=>{n.buttons&&n.buttons[0](this._client,this,n)&&(0,o.to)(this.upDatePage())}),n.msgs[0]),i.button(n.type+"_2",(()=>{n.buttons&&n.buttons[1](this._client,this,n)&&(0,o.to)(this.upDatePage())}),n.msgs[1]),i.button(n.type+"_3",(()=>{n.buttons&&n.buttons[2](this._client,this,n)&&(0,o.to)(this.upDatePage())}),n.msgs[2]),i.button(n.type+"_4",(()=>{})," "));break;default:i.button(n.type,(()=>{n.function&&n.function(this._client,this,n)&&(0,o.to)(this.upDatePage())}),n.msg)}i.show(this._client.player)},new((i=void 0)||(i=Promise))((function(e,t){function r(e){try{c(a.next(e))}catch(e){t(e)}}function o(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,o)}c((a=a.apply(n,s||[])).next())}))}}class $e extends q{constructor(){super(...arguments),this.recordDailyArray=new Set,this.recordProgressArray=new Set}progressTaskFinish(e,t){this.data.tasks.progress.data[e]=t}show(e,t){let n=new Ge(this.client,function(e){e.getLang();let t=e.exPlayer.getBag().countAllItems();const n=Ie(),s=Ae(),i=ve(),a=Te(),r={main_dec_leavesgolem:{name:"自然的愤怒",conditions:[{name:"绿叶精华BOSS",typeId:"dec:leaves_golem",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:800,unit:"点",type:"integral"}]},main_dec_king_of_pillager:{name:"战胜掠夺！",conditions:[{name:"掠夺者之王BOSS",typeId:"dec:king_of_pillager",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:1300,unit:"点",type:"integral"}]},main_dec_abyssal_controller:{name:"海中牢笼",conditions:[{name:"深海牢笼BOSS",typeId:"dec:abyssal_controller",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:2e3,unit:"点",type:"integral"}]},main_dec_predators:{name:"蝙蝠之王",conditions:[{name:"捕食者BOSS",typeId:"dec:predators",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:2200,unit:"点",type:"integral"}]},main_dec_enchant_illager:{name:"神秘教堂",conditions:[{name:"附魔师BOSS",typeId:"dec:enchant_illager_2",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:2200,unit:"点",type:"integral"}]},main_dec_evlghost:{name:"永冬之魂",conditions:[{name:"永冬恶魂BOSS",typeId:"dec:everlasting_winter_ghast_1",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:4e3,unit:"点",type:"integral"}]},main_dec_escaped_soul:{name:"不死灵魂",conditions:[{name:"逃逸之魂BOSS",typeId:"dec:escaped_soul_entity",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:4500,unit:"点",type:"integral"}]},main_dec_host_of_deep:{name:"深渊？",conditions:[{name:"深渊之主BOSS",typeId:"dec:host_of_deep_2",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:4500,unit:"点",type:"integral"}]},main_dec_ash_knight:{name:"挑战灰烬",conditions:[{name:"灰烬骑士BOSS",typeId:"dec:ash_knight",damage:1,type:"boss"}],rewards:[{name:"模组经验",count:3e3,unit:"点",type:"integral"}]},dragon:{name:"结束了？",conditions:[{name:"觉醒末影龙",typeId:"wb:magic_stoneman",type:"boss_tag",tagName:"wbstartkeyok"}],rewards:[{name:"模组经验",count:8e3,unit:"点",type:"integral"}]},main_pom_1:{name:"沙漠暴风",conditions:[{name:"魔化石块BOSS",typeId:Fe.typeId,damage:100,type:"boss"}],rewards:[{name:"模组经验",count:6e3,unit:"点",type:"integral"}]},main_pom_2:{name:"巨型洞穴",conditions:[{name:"无头守卫BOSS",typeId:Ze.typeId,damage:300,type:"boss"}],rewards:[{name:"模组经验",count:8e3,unit:"点",type:"integral"}]},main_pom_3:{name:"远古探索者",conditions:[{name:"远古石像BOSS",typeId:Le.typeId,damage:400,type:"boss"}],rewards:[{name:"模组经验",count:1e4,unit:"点",type:"integral"}]},main_pom_4:{name:"心灵之境",conditions:[{name:"念BOSS",typeId:Ve.typeId,damage:500,type:"boss"}],rewards:[{name:"模组经验",count:2e4,unit:"点",type:"integral"}]}};return{dailyTask:{text:"dailyTask",default:"0/"+e.data.tasks.daily.all[0][0].toString(),img:"textures/items/leaves_knife.png",page:(e,r)=>{let o={};const c=e.data.tasks.daily;let l=(e,n)=>{var s,i,a;for(const r of c.all[e]){let l=c.complete[e].includes(r),u=!0,h=0,d=[{type:"text_title",msg:n.name+" "+n.tasks[r].name},{type:"padding"},{type:"text",msg:"奖励："}];for(let e of n.tasks[r].rewards)d.push({type:"text",msg:"    "+e.name+" "+e.count+" "+e.unit});d.push({type:"padding"});for(let e of n.tasks[r].conditions){let o="",m=0,g="";"break"===e.type?(m=null!==(s=c.cache[e.typeId])&&void 0!==s?s:0,o="破坏"):"kill"===e.type?(m=null!==(i=c.cache[e.typeId])&&void 0!==i?i:0,o="击杀"):"item"===e.type&&(o="物品",m=null!==(a=t.get(e.typeId))&&void 0!==a?a:0),m<e.count&&(u=!1);let _=l?1:Math.min(1,m/e.count);h+=_/n.tasks[r].conditions.length,g=(m>=e.count||l?"§a":"§c")+"需求: "+o+" "+e.name+" "+(l?e.count:m)+"/"+e.count+"个\n",g+=ke(_,10,Ne),d.push({type:"textWithBg",msg:g})}u&&!l&&d.push({type:"padding"},{type:"button",msg:"完成任务",function:(s,i)=>{var a;for(let e of n.tasks[r].rewards)"integral"===e.type&&s.exPlayer.getScoresManager().addScoreAsync("wbdjjf",e.count);for(let e of n.tasks[r].conditions)"item"===e.type&&s.exPlayer.getBag().clearItem(e.typeId,e.count);return t=s.exPlayer.getBag().countAllItems(),null===(a=s.data.tasks)||void 0===a||a.daily.complete[e].push(r),!0}}),o[e+"/"+r]={text:(l?"§a":u?"§e":"§c")+n.tasks[r].name+": "+(l?"已完成":Math.round(100*h)+"％"),page:d}}};return l(0,n),l(1,s),l(2,i),l(3,a),o}},paperTask:{text:"paperTask",default:"1",img:"textures/items/magic_scroll_blue.png",page:(t,n)=>{let s={},i=e.exPlayer.getBag().getItemOnHand();if(!i||0===i.getLore().length)return{1:{text:"空",page:[{type:"text",msg:"你的手上未持有蓝魔法卷轴"}]}};let a=i.getLore(),r=0;for(let e of a){r++;let t=[];s[r]={page:t,text:e};let n=xe(e);const i=Ce.findIndex((e=>e.id===n));if(-1===i)throw new Error("Can't find task "+xe(e));let a=Ce[i];t.push({type:"text_title",msg:a.title()},{type:"padding"},{type:"text",msg:a.body()},{type:"button",msg:"text.dec:task_complete_button.name",function:(e,t)=>(a.detect(e.exPlayer),!1)})}return s}},progressTask:{text:"progressTask",default:"main_pom_1",img:"textures/items/experience_book.png",page:(e,n)=>{var s,i,a;let o={};const c=e.data.tasks.progress;for(const n in r){let l=r[n],u=c.complete.includes(n),h=!0,d=0,m=[{type:"text_title",msg:l.name},{type:"padding"},{type:"text",msg:"奖励："}];for(let e of l.rewards)m.push({type:"text",msg:"    "+e.name+" "+e.count+" "+e.unit});m.push({type:"padding"});for(let t of l.conditions){let n="",r=0,o="";if("boss"===t.type){t.damage=null!==(s=t.damage)&&void 0!==s?s:1,r=null!==(i=c.data[t.typeId])&&void 0!==i?i:0,n="击杀并造成伤害",r<t.damage&&(h=!1);let e=u?1:Math.min(1,r/t.damage);d+=e/l.conditions.length,o=(r>=t.damage||u?"§a":"§c")+"需求: "+n+" "+t.name+" "+(u?t.damage:r)+"/"+t.damage+"点\n",o+=ke(e,10,Ne)}else if("boss_tag"===t.type){t.tagName=null!==(a=t.tagName)&&void 0!==a?a:"undefined",r=e.player.hasTag(t.tagName)?1:0,n="击杀",r<1&&(h=!1);let s=u?1:Math.min(1,r/1);d+=s/l.conditions.length,o=(r>=1||u?"§a":"§c")+"需求: "+n+" "+t.name+" "+(u?1:r)+"/1个\n",o+=ke(s,10,Ne)}m.push({type:"textWithBg",msg:o})}h&&!u&&m.push({type:"padding"},{type:"button",msg:"完成任务",function:(e,s)=>{for(let t of l.rewards)"integral"===t.type&&e.exPlayer.getScoresManager().addScoreAsync("wbdjjf",t.count);return t=e.exPlayer.getBag().countAllItems(),c.complete.push(n),!0}}),o[n]={text:(u?"§a":h?"§e":"§c")+l.name+": "+(u?"已完成":Math.round(100*d)+"％"),page:m}}return o}}}}(this));e&&t||(e="dailyTask",t=n.getJSON()[e].default),n.showPage(e,t)}onJoin(){this.data.tasks||(this.data.tasks={daily:{complete:[[],[],[],[]],all:[[],[],[],[]],date:"1970-2-31",cache:{}},progress:{complete:[],data:{}}});let e=new Date,t=`${e.getFullYear()}-${e.getMonth()}-${e.getDay()}`,n=e=>Math.floor(e.length*Math.random()),s=Ie(this.getLang()).tasks,i=Ae(this.getLang()).tasks,a=ve(this.getLang()).tasks,r=Te(this.getLang()).tasks;this.data.tasks.daily.date!==t&&(this.data.tasks.daily.all=[[n(s),n(s),n(s)],[n(i),n(i)],[n(a)],[n(r)]],this.data.tasks.daily.complete=[[],[],[],[]],this.data.tasks.daily.cache={},this.data.tasks.daily.date=t);for(let e of s)for(let t of e.conditions)"break"!==t.type&&"kill"!==t.type||this.recordDailyArray.add(t.typeId);for(let e of i)for(let t of e.conditions)"break"!==t.type&&"kill"!==t.type||this.recordDailyArray.add(t.typeId);for(let e of a)for(let t of e.conditions)"break"!==t.type&&"kill"!==t.type||this.recordDailyArray.add(t.typeId);for(let e of r)for(let t of e.conditions)"break"!==t.type&&"kill"!==t.type||this.recordDailyArray.add(t.typeId);this.getEvents().exEvents.blockBreak.subscribe((e=>{var t;this.data.tasks&&this.recordDailyArray.has(e.brokenBlockPermutation.type.id)&&(this.data.tasks.daily.cache[e.brokenBlockPermutation.type.id]=1+(null!==(t=this.data.tasks.daily.cache[e.brokenBlockPermutation.type.id])&&void 0!==t?t:0))})),this.getEvents().exEvents.playerHitEntity.subscribe((e=>{var t;this.data.tasks&&this.recordDailyArray.has(e.hurtEntity.typeId)&&T.Z.getInstance(e.hurtEntity).getHealth()<0&&(this.data.tasks.daily.cache[e.hurtEntity.typeId]=1+(null!==(t=this.data.tasks.daily.cache[e.hurtEntity.typeId])&&void 0!==t?t:0))}))}onLoaded(){}onLeave(){}}class Xe extends q{onJoin(){this.getEvents().exEvents.blockBreak.subscribe((n=>{var s;n.brokenBlockPermutation.type.id!==e.MinecraftBlockTypes.log.id&&n.brokenBlockPermutation.type.id!==e.MinecraftBlockTypes.log2.id||"wb:axex_equipment_a"!==(null===(s=this.exPlayer.getBag().getItemOnHand())||void 0===s?void 0:s.typeId)||this.chainDiggingLogs(new t.Z(n.block),!0)})),this.getEvents().exEvents.onceItemUseOn.subscribe((e=>{"wb:technology_world_explorer"===e.item.typeId&&this.sayTo(this.getExDimension().getBlock(e.blockLocation).typeId)})),this.getEvents().exEvents.itemUse.subscribe((n=>{const{item:s}=n;"wb:power"==s.typeId?this.data.lang?new Ge(this.client,function(e){return{main:{img:"textures/items/wet_paper",text:e.menuUIMsgBailan1,default:"notice",page:{notice:{text:e.menuUISubtitleGonggao,page:[{type:"img_adjustToScreen",msg:"textures/ui/title.png"},{type:"padding"},{type:"text",msg:e.menuUIMsgGonggao1}]},version:{text:e.menuUIMsgBailan5,page:(t,n)=>[{type:"text_title",msg:e.menuUIMsgBanben1},{type:"text",msg:e.menuUIMsgBanben2},{type:"text",msg:i.Z.config.addonVersion},{type:"text",msg:e.menuUIMsgBanben3},{type:"text",msg:"https://aaswordman.github.io/ThePoetryOfWinter/"},{type:"padding"},{type:"text_title",msg:e.menuUIMsgBanben4},{type:"padding"},{type:"text",msg:e.menuUIMsgBanben5},{type:"padding"},{type:"text_title",msg:e.menuUIMsgBanben6},{type:"padding"}].concat(Ge.getLabelViews("\n名字排序为随机排序\n\nMain creator:   - LiLeyi   AAswordsman\nAssistants:  -  \nEnderghostScale  - 人造肉、部分怪物、投掷炸药和技术支持\nhaveyouwantto - 技术支持\nhuo鱼一只 - 技术支持\nAR_UnryAllenCN - 技术支持\n世心 - 狼人，暗狼人\n論娘 - 幻术师\n荷叶 - 提供灵感，新手指南\nQ儿 - 贴图、提供灵感\nSpiffyTerror - 模型、生物动画\n悸动天使 - 指令支持\n晴风 - 霸体核心\n画盒豆腐 - 提供灵感\n兔块子 - 部分实体\n传说中阿库西斯教教徒 - 提供灵感、剧情、建筑\n枫雪白霜 - 提供灵感和贴图\n碧月狐DADA - 技术支持\nFulank彡North cat - 提供贴图、灵感\n一只朴实无华的蒜头王八 - 提供贴图、灵感和测试\nKirisamePPSH - 提供建筑、贴图\nMiku4962 - 提供贴图和测试\nMr.龙灵 - 提供结构和贴图\nHanyi寒翼 - 灵感、建筑和贴图\n鸥吃鱼 - 部分翻译\nKucerLuo - 建筑\nRepforce - 建筑\n一只有疑问的猪 - 建筑\n豆沙 - 部分怪物\n某不知名的琦玉 - 灵感\nHim1025(kALE) - 部分贴图、logo、icon、剧情、建筑、模型动画、加农炮战车\nWINDes - 任务清单、测试、灵感、部分\nALiFang ZHE - 部分模型、贴图\n枨触 - 建筑\n屑屑猹 - 部分翻译\n\nOur Team\n竹翼团队     无上蓝痕(BlueMark Studio)\n\nSpecial Thanks\nBunBun不是笨笨    在矿里的小金呀\n".split("\n")))},imp:{text:e.menuUIMsgBailan6,page:(e,t)=>Ge.getLabelViews($.split("\n"))},QA:{text:"Q & A",page:[{type:"padding"},{type:"text_title",msg:e.menuUIMsgBailan103},{type:"padding"},{type:"text",msg:e.menuUIMsgBailan104},{type:"padding"},{type:"text_title",msg:e.menuUIMsgBailan7},{type:"padding"},{type:"text",msg:e.menuUIMsgBailan8},{type:"padding"},{type:"text_title",msg:e.menuUIMsgBailan9},{type:"padding"},{type:"text",msg:e.menuUIMsgBailan10},{type:"padding"},{type:"text_title",msg:e.menuUIMsgBailan11},{type:"padding"},{type:"text",msg:e.menuUIMsgBailan12}]}}},person:{img:"textures/items/amethyst_chestplate.png",text:e.menuUIMsgBailan13,default:"info",page:{info:{text:e.menuUIMsgBailan14,page:(t,n)=>{let s=t.player,i=m.Z.getInstance(s).getScoresManager(),a=[`   ${e.menuUIMsgBailan94}: ${t.gameId}`,`   ${e.menuUIMsgBailan96}: ${i.getScore("wbfl")}`,`   ${e.menuUIMsgBailan97}: ${i.getScore("wbwqlq")}`,`   ${e.menuUIMsgBailan98}: ${i.getScore("wbkjlqcg")}`,`   ${e.menuUIMsgBailan99}: ${s.hasTag("wbmsyh")?e.menuUIMsgBailan15:e.menuUIMsgBailan16}`,`   ${e.menuUIMsgBailan100}: ${s.hasTag("wbdjeff")?e.menuUIMsgBailan15:e.menuUIMsgBailan16}`],r=Ge.getLabelViews(a);r.unshift({type:"text_title",msg:"个人信息"});let o=i.getScore("wbdjcg"),c=i.getScore("wbdjjf");return r.push({type:"textWithBg",msg:`${e.menuUIMsgBailan95}: ${o} 当前等级积分: ${c}/${150*Math.pow(o,2)+1050*o+900}\n${ke((c-(150*Math.pow(o-1,2)+1050*(o-1)+900))/(300*o+900),10,Ne)}`}),r}},add:{text:e.menuUIMsgBailan19,page:[{type:"text_title",msg:e.menuUIMsgBailan20},{type:"padding"},{type:"text",msg:e.menuUIMsgBailan21},{type:"padding"},{type:"toggle",msg:e.menuUIMsgBailan22,state:(e,t)=>e.player.hasTag("wbdjeff"),function:(e,t)=>(e.player.hasTag("wbdjeff")?e.player.removeTag("wbdjeff"):e.player.addTag("wbdjeff"),!0)},{type:"padding"},{type:"text_title",msg:e.menuUIMsgBailan23},{type:"padding"},{type:"text",msg:e.menuUIMsgBailan24},{type:"padding"},{type:"button",msg:e.menuUIMsgBailan25,function:(e,t)=>(e.player.removeTag("pflame"),!0)},{type:"button",msg:e.menuUIMsgBailan26,function:(e,t)=>(e.player.removeTag("phalo"),!0)},{type:"button",msg:e.menuUIMsgBailan27,function:(e,t)=>(e.player.removeTag("prune"),!0)},{type:"button",msg:e.menuUIMsgBailan28,function:(e,t)=>(e.player.removeTag("plove"),!0)}]},talent:{text:e.menuUIMsgBailan29,page:(t,n)=>{var s;let i;if(W.hasOccupation(t.data.talent)){const n=2*t.exPlayer.getScoresManager().getScore("wbdjcg")-(null!==(s=t.data.talent.pointUsed)&&void 0!==s?s:0);i=[{type:"text",msg:e.menuUIMsgBailan30+n}];for(let e of t.data.talent.talents){i.push({type:"text",msg:W.getDescription(t.getLang(),t.data.talent.occupation,e.id,e.level)},{type:"textWithBg",msg:V.getCharacter(t.getLang(),e.id)+": "+e.level+"\n"+ke(e.level/40,10,"")});let s=s=>()=>{var i;return n>0&&e.level<40&&(s=Math.min(Math.min(s,40-e.level),n),e.level+=s,t.data.talent.pointUsed=s+(null!==(i=t.data.talent.pointUsed)&&void 0!==i?i:0),t.data.talent.talents.splice(t.data.talent.talents.findIndex((t=>t.id===e.id)),1),t.data.talent.talents.unshift(e),t.talentSystem.updateTalentRes()),!0};i.push({type:"buttonList3",msgs:["+1","+2","+5"],buttons:[s(1),s(2),s(5)]},{type:"padding"})}(!t.data.occupationChooseDate||(new Date).getTime()-t.data.occupationChooseDate>=12096e5)&&i.push({type:"button",msg:"清空职业",function:(e,t)=>(e.data.occupationChooseDate=(new Date).getTime(),e.data.talent.occupation=F.EMPTY,e.data.talent.talents=[],e.data.talent.pointUsed=0,e.talentSystem.updateTalentRes(),!0)})}else{i=[{type:"text_title",msg:e.menuUIMsgBailan31},{type:"padding"}];for(const e of F.keys)i.push({type:"button",msg:e.getCharacter(t.getLang()),function:(t,n)=>(W.chooseOccupation(t.data.talent,e),t.talentSystem.updateTalentRes(),!0)})}return i}},deathback:{text:e.menuUIMsgBailan32,page:(n,s)=>{null==n.data.pointRecord&&(n.data.pointRecord={deathPoint:[],point:[]});let i=[{type:"text_title",msg:e.menuUIMsgBailan33},{type:"padding"}];if(n.globalSettings.tpPointRecord&&!n.ruinsSystem.isInRuinJudge){for(let s=0;s<n.data.pointRecord.point.length;s++){const a=n.data.pointRecord.point[s],r=new t.Z(a[2]);i.push({type:"textWithBg",msg:e.menuUIMsgBailan34+(a[0]+r.toString())+"\n"+a[1]},{type:"buttonList3",msgs:[e.menuUIMsgBailan35,e.menuUIMsgBailan38,e.menuUIMsgBailan40],buttons:[(t,n)=>{let s=t.exPlayer.getBag();if(!s.hasItem("wb:conveyor_issue")&&t.globalSettings.tpNeedItem)return t.sayTo(e.menuUIMsgBailan36),!1;if(t.globalSettings.tpNeedItem){let e=s.searchItem("wb:conveyor_issue"),t=s.getItem(e);t.amount--,s.setItem(e,t)}return t.exPlayer.setPosition(r,t.getDimension(a[0])),t.sayTo(e.menuUIMsgBailan37),!1},(t,n)=>((new se.ModalFormData).textField(e.menuUIMsgBailan39,a[0]+r.toString()).show(t.player).then((e=>{var t;e.canceled||(a[1]=(null===(t=null==e?void 0:e.formValues)||void 0===t?void 0:t[0])||"")})).catch((e=>{o.Z.throwError(e)})),!1),(e,t)=>{var n;return null===(n=e.data.pointRecord)||void 0===n||n.point.splice(s,1),!0}]},{type:"padding"})}i.push({msg:e.menuUIMsgBailan41+n.exPlayer.getPosition().floor().toString(),type:"button",function:(e,t)=>{var n;return null===(n=e.data.pointRecord)||void 0===n||n.point.push([e.exPlayer.getDimension().id,"",e.exPlayer.getPosition().floor()]),!0}})}else i.push({type:"text",msg:e.menuUIMsgBailan42});return i}},other:{text:"其他",page:[{type:"button",msg:"任务界面",function:(e,t)=>(e.taskUI(),!1)},{type:"button",msg:"剧情线",function:(e,t)=>(e.taskUI(),!1)}]}}},social:{img:"textures/items/gingerbread_totem.png",text:e.menuUIMsgBailan46,default:"setting",page:{setting:{text:e.menuUIMsgBailan47,page:[{type:"text_title",msg:e.menuUIMsgBailan48},{type:"padding"},{type:"text",msg:e.menuUIMsgBailan49},{type:"text",msg:e.menuUIMsgBailan50},{type:"padding"},{type:"button",msg:e.menuUIMsgBailan51,function:(e,t)=>(e.player.addTag("wbmsyh"),e.player.nameTag.startsWith("§")&&(e.player.nameTag=e.player.nameTag.substring(2)),e.player.nameTag="§a"+e.player.nameTag,!0)},{type:"button",msg:e.menuUIMsgBailan48,function:(e,t)=>(e.player.removeTag("wbmsyh"),e.player.nameTag.startsWith("§")&&(e.player.nameTag=e.player.nameTag.substring(2)),e.player.nameTag="§c"+e.player.nameTag,!0)}]},tp:{text:e.menuUIMsgBailan53,page:(t,n)=>{return s=this,i=void 0,r=function*(){var n;if(!t.globalSettings.playerCanTp||t.ruinsSystem.isInRuinJudge)return[{type:"text",msg:e.menuUIMsgBailan54}];let s=[];s.push({msg:e.menuUIMsgBailan55,type:"text_title"}),s.push({type:"padding"});let i=null!==(n=yield t.getPlayersAndIds())&&void 0!==n?n:[];for(const t of i){const n=m.Z.getInstance(t[0]);s.push({type:"button",msg:`${n.nameTag} pos:${n.getPosition().floor()}`,function:(s,i)=>{let a=s.exPlayer.getBag();if(!a.hasItem("wb:conveyor_issue")&&s.globalSettings.tpNeedItem)return s.sayTo(e.menuUIMsgBailan36),!1;if(s.globalSettings.tpNeedItem){let e=a.searchItem("wb:conveyor_issue"),t=a.getItem(e);t.amount--,a.setItem(e,t)}return s.sayTo(e.menuUIMsgBailan57),(new le).title(e.menuUIMsgBailan58).body(`玩家 ${s.player.nameTag} §r想要传送到你的位置，是否接受？`).button1(e.menuUIMsgBailan15,(()=>{s.sayTo(e.menuUIMsgBailan37),s.sayTo(e.menuUIMsgBailan37,t[0]),s.exPlayer.setPosition(n.getPosition(),n.getDimension())})).button2(e.menuUIMsgBailan16,(()=>{s.sayTo(e.menuUIMsgBailan63),s.sayTo(e.menuUIMsgBailan64,t[0])})).show(t[0]),!1}})}s.push({msg:e.menuUIMsgBailan65,type:"text_title"}),s.push({type:"padding"});for(const t of i){const n=m.Z.getInstance(t[0]);s.push({type:"button",msg:`${n.nameTag} (pos:${n.getPosition().floor()})`,function:(s,i)=>{let a=s.exPlayer.getBag();if(!a.hasItem("wb:conveyor_issue")&&s.globalSettings.tpNeedItem)return s.sayTo(e.menuUIMsgBailan36),!1;if(s.getServer().findClientByPlayer(t[0]).ruinsSystem.isInRuinJudge)return s.sayTo("§b对方在遗迹中，申请失败"),!1;if(s.globalSettings.tpNeedItem){let e=a.searchItem("wb:conveyor_issue"),t=a.getItem(e);t.amount--,a.setItem(e,t)}return s.sayTo(e.menuUIMsgBailan67),(new le).title(e.menuUIMsgBailan58).body(`玩家 ${s.player.nameTag} §r邀请你传送到 pos:${s.exPlayer.getPosition().floor()} ，是否接受？`).button1(e.menuUIMsgBailan15,(()=>{s.sayTo(e.menuUIMsgBailan37),s.sayTo(e.menuUIMsgBailan37,t[0]),n.setPosition(s.exPlayer.getPosition(),s.exPlayer.getDimension())})).button2(e.menuUIMsgBailan16,(()=>{s.sayTo(e.menuUIMsgBailan73),s.sayTo(e.menuUIMsgBailan74,t[0])})).show(t[0]),!1}})}return s},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{c(r.next(e))}catch(e){t(e)}}function o(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(n,o)}c((r=r.apply(s,i||[])).next())}));var s,i,a,r}}}},setting:{img:"textures/items/artificial_meat_creator_on.png",text:e.menuUIMsgBailan75,default:"op",page:{personal:{text:e.menuUIMsgBailan101,page:[{type:"button",msg:e.menuUIMsgBailan102,function:(e,t)=>((new se.ModalFormData).title("Choose a language").dropdown("Language List",["English","简体中文"],0).show(e.player).then((t=>{t.canceled||(e.data.lang=t.formValues&&0==t.formValues[0]?"en":"zh")})).catch((e=>{o.Z.throwError(e)})),!1)}]},op:{text:e.menuUIMsgBailan76,page:(t,n)=>t.player.hasTag("owner")?[{type:"text_title",msg:e.menuUIMsgBailan77},{type:"toggle",msg:e.menuUIMsgBailan78,state:(e,t)=>e.globalSettings.playerCanTp,function:(e,t)=>(e.globalSettings.playerCanTp=!e.globalSettings.playerCanTp,!0)},{type:"toggle",msg:e.menuUIMsgBailan79,state:(e,t)=>e.globalSettings.tpNeedItem,function:(e,t)=>(e.globalSettings.tpNeedItem=!e.globalSettings.tpNeedItem,!0)},{type:"toggle",msg:e.menuUIMsgBailan80,state:(e,t)=>e.globalSettings.entityCleaner,function:(e,t)=>(e.globalSettings.entityCleaner=!e.globalSettings.entityCleaner,e.getServer().upDateEntityCleaner(),!0)},{type:"toggle",msg:e.menuUIMsgBailan82,state:(e,t)=>e.globalSettings.tpPointRecord,function:(e,t)=>(e.globalSettings.tpPointRecord=!e.globalSettings.tpPointRecord,!0)},{type:"toggle",msg:"伤害显示",state:(e,t)=>e.globalSettings.damageShow,function:(e,t)=>(e.globalSettings.damageShow=!e.globalSettings.damageShow,!0)}]:[{type:"text",msg:e.menuUIMsgBailan83}]},set:{text:e.menuUIMsgBailan84,page:(t,n)=>t.player.hasTag("owner")?[{type:"button",msg:e.menuUIMsgBailan85,function:(t,n)=>((new se.ModalFormData).toggle(e.menuUIMsgBailan80,t.globalSettings.entityCleaner).slider(e.menuUIMsgBailan91,40,1e3,20,t.globalSettings.entityCleanerLeastNum).slider(e.menuUIMsgBailan92,2,10,1,t.globalSettings.entityCleanerStrength).slider(e.menuUIMsgBailan93,1,60,1,t.globalSettings.entityCleanerDelay).show(t.player).then((e=>{var n,s,i,a,r,o,c,l;e.canceled||(t.globalSettings.entityCleaner=null!==(s=null===(n=e.formValues)||void 0===n?void 0:n[0])&&void 0!==s&&s,t.globalSettings.entityCleanerLeastNum=null!==(a=null===(i=e.formValues)||void 0===i?void 0:i[1])&&void 0!==a?a:200,t.globalSettings.entityCleanerStrength=null!==(o=null===(r=e.formValues)||void 0===r?void 0:r[2])&&void 0!==o?o:5,t.globalSettings.entityCleanerDelay=null!==(l=null===(c=e.formValues)||void 0===c?void 0:c[3])&&void 0!==l?l:30)})).catch((e=>{o.Z.throwError(e)})),!1)}]:[{type:"text",msg:e.menuUIMsgBailan83}]}}}}}(this.getLang())).showPage("main","notice"):(new se.ModalFormData).title("Choose a language").dropdown("Language List",["English","简体中文"],0).show(this.player).then((e=>{e.canceled||(this.data.lang=e.formValues&&0==e.formValues[0]?"en":"zh")})).catch((e=>{o.Z.throwError(e)})):"wb:jet_pack"===s.typeId?(this.player.addEffect(e.MinecraftEffectTypes.levitation,7,15,!1),this.player.addEffect(e.MinecraftEffectTypes.slowFalling,150,3,!1),this.exPlayer.getDimension().spawnEntity("wb:ball_jet_pack",D.Z.getBlockLocation(this.exPlayer.getPosition().sub(this.exPlayer.getViewVector().scl(2))))):"wb:start_key"===s.typeId||s.typeId}))}chainDiggingLogs(t,s){const i=n.Z.getInstance(this.getDimension()),a=n.Z.getInstance(this.getDimension()).getBlock(t).typeId;(a===e.MinecraftBlockTypes.log.id||a===e.MinecraftBlockTypes.log2.id||s)&&(i.digBlock(t),this.chainDiggingLogs(t.add(0,1,0),!1))}onLoaded(){}onLeave(){}}class qe{constructor(e,t,n){this._uiBody=t,this._client=e,this._button=n}getMessage(){return this._uiBody}showPage(){let e=(new ue.Z).title("__pomAlertWarning").body(this._uiBody);for(let[t,n]of this._button)e.button(t,(()=>{n(this._client,this)}));e.show(this._client.player)}}var Ke=function(e,t,n,s){var i,a=arguments.length,r=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ye=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class Je extends s.Z{constructor(e,t,n){super(e,t,n),this.gameControllers=[],this.enchantSystem=new _e(this),this.talentSystem=new be(this),this.magicSystem=new ye(this),this.itemUseFunc=new Xe(this),this.ruinsSystem=new de(this),this.taskSystem=new $e(this),this.interactSystem=new pe(this),this.globalSettings=new P(new M.C("wpsetting")),this.cache=new R(this.exPlayer),this.looper=new S(this.getEvents(),(()=>{this.cache.save()})),this.looper.delay(1e4),this.looper.start(),this.data=this.cache.get(new G),this.globalSettings.ownerExists||(n.addTag("owner"),this.globalSettings.ownerExists=!0),this.addCtrller(this.enchantSystem),this.addCtrller(this.magicSystem),this.addCtrller(this.talentSystem),this.addCtrller(this.itemUseFunc),this.addCtrller(this.ruinsSystem),this.addCtrller(this.taskSystem),this.addCtrller(this.interactSystem),this.gameControllers.forEach((e=>{(0,f.B)(this.getEvents(),e),e.onJoin()}))}onJoin(){this.setInterworkingPool({setSkyBox:()=>{return e=this,t=void 0,s=function*(){},new((n=void 0)||(n=Promise))((function(i,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function o(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((s=s.apply(e,t||[])).next())}));var e,t,n,s}})}addCtrller(e){this.gameControllers.push(e)}getLang(){var e;return X[null!==(e=this.data.lang)&&void 0!==e?e:"en"]}onLoaded(){let e=m.Z.getInstance(this.player).getScoresManager();if(this.gameId=e.getScore("wbldid"),0===this.gameId&&(this.gameId=Math.floor(Math.random()*C.Z.MAX_VALUE),e.setScoreAsync("wbldid",this.gameId)),this.gameControllers.forEach((e=>e.onLoaded())),this.data.lang||this.exPlayer.runCommandAsync("mojang nmsl").catch((e=>{x.Z.hasChineseCharacter(JSON.stringify(e))?this.data.lang="zh":this.data.lang="en"})),!this.data.licenseRead){const e=new S(this.getEvents(),(()=>{new qe(this,$,[["同意并继续",(t,n)=>{this.data.licenseRead=!0,e.stop()}]]).showPage(),this.data.licenseRead||e.startOnce()})).delay(1e3);e.startOnce()}this.player.hasTag("wbmsyh")?this.player.nameTag="§a"+this.player.nameTag:this.player.nameTag="§c"+this.player.nameTag,this.exPlayer.command.run(["execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbef 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbdj 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbdjcg 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbdjjf 0",'execute as @s[tag=!wbyzc] at @s run give @s wb:power 1 0 {"minecraft:keep_on_death":{}}',"execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbcsjs -1","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbnldx 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbldpd 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbldcg 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbfl 200","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbwqlq 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbkjlqcg 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbkjlqjs 0","execute as @s[tag=!wbyzc] at @s run scoreboard players set @s wbwqlqjs 0","tag @s[scores={wbdj=-100..}] add wbyzc"])}onLeave(){this.gameControllers.forEach((e=>e.onLeave())),this.looper.stop(),super.onLeave()}getPlayersAndIds(){let e=[];for(let t of this.getServer().getClients())e.push([t.player,t.gameId]);return e}sayTo(e,t=this.player){t.runCommandAsync(`tellraw @s {"rawtext": [{"text": "${e}"}]}`)}getServer(){return super.getServer()}taskUI(e,t){this.taskSystem.show(e,t)}progressTaskFinish(e,t){this.taskSystem.progressTaskFinish(e,t)}}Ke([N("taskUi"),Ye("design:type",Function),Ye("design:paramtypes",[String,String]),Ye("design:returntype",void 0)],Je.prototype,"taskUI",null),Ke([N("progressTaskFinish"),Ye("design:type",Function),Ye("design:paramtypes",[String,Number]),Ye("design:returntype",void 0)],Je.prototype,"progressTaskFinish",null);class Qe{constructor(e,t,n=0){this.mirror="none",this.structureId=e,this.position=t,this.rotation=n}generate(e){let t=this.rotation,s=n.Z.getInstance(e);(0,o.to)(s.command.run(`structure load ${this.structureId} ${this.position.x} ${this.position.y} ${this.position.z} ${Math.round(t)}_degrees ${this.mirror}`))}}class et{constructor(e,t,n=1){this.width=t,this.height=n,this.size=e,this.jigsawData=Array.from(new Array(this.height),(()=>Array.from(new Array(this.width),(()=>new Array(this.width)))))}isEmpty(e,t,n=0){return void 0===this.jigsawData[n][t][e]}setStructurePlane(e,t,n,s,i,a,r=0,o="none",c=1,l=1){this.setStructure(e,t,0,n,s,i,a,r,o,c,l,1)}setStructure(e,t,n,s,i,a,r,o=0,c="none",l=1,u=1,h=1){this.clearStructure(e,t,n);for(let s=e;s<l+e;s++)for(let e=t;e<u+t;e++)for(let t=n;t<h+n;t++)if(!this.isEmpty(s,e,t))throw new Error("Structure already contains "+s+" , "+t+" , "+e);for(let s=e;s<l+e;s++)for(let e=t;e<u+t;e++)for(let t=n;t<h+n;t++)this.jigsawData[t][e][s]=et.ContinueStructure;this.jigsawData[n][t][e]=[s,i,a,r,o,c,l,u,h]}fillStructure(e,t,n,s,i=0,a="none",r=1,o=1,c=1){const l=[e,t,n,s,i,a,r,o,c];for(let e=0;e<this.width;e++)for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++)this.jigsawData[n][t][e]=l}getStructure(e,t,n){const s=this.findBaseStructure(e,t,n);if(void 0===s)return;const i=this.jigsawData[s[0]][s[1]][s[2]];return i instanceof Array?new tt(...i):void 0}clearStructure(e,t,n=0){const s=this.findBaseStructure(e,t,n);if(void 0!==s){const[i,a,r]=s,o=this.jigsawData[r][a][i];if(void 0!==o){if("number"==typeof o)throw new Error("Error clearing");for(let s=0;s<o[6];s++)for(let i=0;i<o[7];i++)for(let a=0;a<o[8];a++)this.jigsawData[a+n][i+t][s+e]=void 0}}}findBaseStructure(e,t,n=0){let s=this.jigsawData[n][t][e];if(void 0!==s){if(s===et.ContinueStructure){for(;s===et.ContinueStructure&&n>0;)s=this.jigsawData[n--][t][e];for(;s===et.ContinueStructure&&t>0;)s=this.jigsawData[n][t--][e];for(;s===et.ContinueStructure&&e>0;)s=this.jigsawData[n][t][e--];return[e,t,n]}return[e,t,n]}}getWidth(){return this.size*this.width}getHeight(){return this.size*this.height}generate(e,n,s,i){let a=new Qe("",new t.Z,0);this.jigsawData.forEach(((t,r)=>{t.forEach(((t,o)=>{t.forEach(((t,c)=>{"number"!=typeof t&&void 0!==t&&(a.position.set(e+c*this.size+t[0],n+r*this.size+t[1],s+o*this.size+t[2]),a.structureId=t[3],a.rotation=t[4],a.mirror=t[5],a.generate(i))}))}))}))}[Symbol.toStringTag](){return"symbol"}foreach(e){const t=new tt(0,0,0,"",0,"none",1,1,1);for(let n=0;n<this.height;n++)for(let s=0;s<this.width;s++)for(let i=0;i<this.width;i++){let a=this.jigsawData[n][s][i];a instanceof Array&&(t.set(...a),e(t,i,s,n))}}}et.ContinueStructure=1;class tt{constructor(e,t,n,s,i,a,r,o,c){this.set(e,t,n,s,i,a,c,o,r)}set(e,t,n,s,i,a,r,o,c){this.offsetX=e,this.offsetY=t,this.offsetZ=n,this.structureName=s,this.structureRot=i,this.mirror=a,this.coverGridHeight=r,this.coverGridWidth=o,this.coverGridLength=c}}class nt{constructor(e){this.structure_area1="mystructure:boss_cave_area_b1",this.structure_area2="mystructure:boss_cave_area_b2",this.structure_area3="mystructure:boss_cave_area_b3",this.structure_area4="mystructure:boss_cave_area_b4",this._pathArea=[],this._monsterArea=[],this._playerArea=[],this.seed=e}init(e,n,s,i){this._monsterArea=[],this._pathArea=[],this._playerArea=[],this.x=e,this.y=n,this.z=s,this.dim=i,this.jigsaw=new et(32,4),this.jigsaw.setStructurePlane(0,0,0,0,0,this.structure_area1,0),this.jigsaw.setStructurePlane(1,0,0,0,0,this.structure_area2,0),this.jigsaw.setStructurePlane(0,1,0,0,0,this.structure_area3,0),this.jigsaw.setStructurePlane(1,1,0,0,0,this.structure_area4,0),this.jigsaw.setStructurePlane(3,0,0,0,0,this.structure_area1,90),this.jigsaw.setStructurePlane(3,1,0,0,0,this.structure_area2,90),this.jigsaw.setStructurePlane(2,0,0,0,0,this.structure_area3,90),this.jigsaw.setStructurePlane(2,1,0,0,0,this.structure_area4,90),this.jigsaw.setStructurePlane(0,3,0,0,0,this.structure_area1,270),this.jigsaw.setStructurePlane(0,2,0,0,0,this.structure_area2,270),this.jigsaw.setStructurePlane(1,3,0,0,0,this.structure_area3,270),this.jigsaw.setStructurePlane(1,2,0,0,0,this.structure_area4,270),this.jigsaw.setStructurePlane(3,3,0,0,0,this.structure_area1,180),this.jigsaw.setStructurePlane(2,3,0,0,0,this.structure_area2,180),this.jigsaw.setStructurePlane(3,2,0,0,0,this.structure_area3,180),this.jigsaw.setStructurePlane(2,2,0,0,0,this.structure_area4,180),this._bossArea=new A(new t.Z(62,13,62).add(e,n,s),new t.Z(4,6,4)),this._playerArea.push(new A(new t.Z(15,6,39).add(e,n,s),new t.Z(1,1,1)),new A(new t.Z(89,6,15).add(e,n,s),new t.Z(1,1,1)),new A(new t.Z(39,6,113).add(e,n,s),new t.Z(1,1,1)),new A(new t.Z(113,6,89).add(e,n,s),new t.Z(1,1,1))),this._playerArea.push(new A(new t.Z(7,50,39).add(e,n,s),new t.Z(1,1,1)),new A(new t.Z(89,50,7).add(e,n,s),new t.Z(1,1,1)),new A(new t.Z(39,50,121).add(e,n,s),new t.Z(1,1,1)),new A(new t.Z(121,50,89).add(e,n,s),new t.Z(1,1,1)))}generate(){this.init(this.x,this.y,this.z,this.dim),this.jigsaw.generate(this.x,this.y,this.z,this.dim),this.dispose()}getPathArea(){return this._pathArea}getMonsterSpawnArea(){return this._monsterArea}getPlayerSpawnArea(){return this._playerArea}getBossSpawnArea(){return this._bossArea}dispose(){this.jigsaw=new et(1,1,1)}}class st{constructor(e,t){"number"==typeof e&&"number"==typeof t?(this.x=e,this.y=t):void 0===e&&void 0===t?(this.x=0,this.y=0):(this.x=e.x,this.y=e.y)}set(e,t){return"number"==typeof e?"number"==typeof t&&(this.x=e,this.y=t):this.set(e.x,e.y),this}add(e,t){return"number"==typeof e?"number"==typeof t&&(this.x+=e,this.y+=t):this.add(e.x,e.y),this}sub(e,t){return"number"==typeof e?"number"==typeof t&&(this.x-=e,this.y-=t):this.sub(e.x,e.y),this}scl(e,t,n){return"number"==typeof e?"number"==typeof t&&"number"==typeof n?(this.x*=e,this.y*=t):void 0===t&&void 0===n&&(this.x*=e,this.y*=e):this.sub(e.x,e.y),this}div(e){return this.x/=e,this.y/=e,this}len(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}len2(){return Math.pow(this.x,2)+Math.pow(this.y,2)}equals(e){return this.x===e.x&&this.y===e.y}distance(e){return this.clone().sub(e).len()}toString(){return`(${this.x}, ${this.y})`}[Symbol.toStringTag](){return this.toString()}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}mul(e){return e.x*this.x+e.y*this.y}normalize(){return this.div(this.len()),this}clone(){return new st(this.x,this.y)}}st.back=new st(0,-1),st.forward=new st(0,1),st.left=new st(-1,0),st.one=new st(1,1),st.right=new st(1,0),st.zero=new st(0,0);class it{constructor(e){this.structure_bossArea="mystructure:boss_desert_1",this.structure_straightLine="mystructure:boss_desert_2",this.structure_curve="mystructure:boss_desert_3",this.structure_triple="mystructure:boss_desert_4",this.structure_crossing="mystructure:boss_desert_5",this.structure_straightLineTower="mystructure:boss_desert_6",this.structure_towerBlock1="mystructure:boss_desert_7",this.structure_towerBlock2="mystructure:boss_desert_8",this.structure_towerBlock3="mystructure:boss_desert_10",this.structure_towerBlock4="mystructure:boss_desert_12",this.structure_upplain="mystructure:boss_desert_13",this.structure_upstairs="mystructure:boss_desert_14",this.structure_towerPiece="mystructure:boss_desert_15",this.structure_boss="mystructure:boss_desert_16",this.structure_block1="mystructure:boss_desert_9",this.structure_block2="mystructure:boss_desert_11",this.completed=!1,this.rooms=new Set,this.paths=new Set,this._pathArea=[],this._airPathArea=[],this._monsterArea=[],this._airMonsterArea=[],this._playerArea=[],this.seed=e}isCompleted(){return this.completed}isInRoom(e){return this.rooms.has(e)}isOnPath(e){return this.paths.has(e)}getPathArea(){return this._pathArea}getAirPathArea(){return this._airPathArea}getMonsterSpawnArea(){return this._monsterArea}getAirMonsterSpawnArea(){return this._airMonsterArea}getPlayerSpawnArea(){return this._playerArea}getBossSpawnArea(){return this._bossArea}dispose(){this.jigsaw=new et(1,1,1)}generate(){this.init(this.x,this.y,this.z,this.dim),this.jigsaw.generate(this.x,this.y,this.z,this.dim),this.dispose()}init(e,n,s,i){this.x=e,this.y=n,this.z=s,this.dim=i,this._bossArea=new A(new t.Z(254,2,254).add(e,n,s),new t.Z(4,4,4));const a=Array.from(new Array(32),(()=>new Array(32).fill(0)));let r=64,o=this.seed;const c=new C.Z(o),l=(e,t)=>{try{return a[t][e]}catch(e){return 3}};for(let e=14;e<18;e++)for(let t=14;t<18;t++)a[e][t]=4;for(;r>0;){let e=c.nextInt(32),t=c.nextInt(32);4!==a[e][t]&&(a[e][t]=1,r--)}let u=[[new st,st.forward]];a[1][0]=0;const h=new st;for(;u.length>0;){let e=[];e=[];for(let t of u)if(h.set(t[0]).add(t[1]),!(0!==l(h.x,h.y)||(t[1]!==st.right&&t[1]!==st.left||2===l(h.x,h.y+1)&&2===l(h.x-1,h.y+1)||2===l(h.x,h.y+1)&&2===l(h.x+1,h.y+1)||2===l(h.x,h.y-1)&&2===l(h.x-1,h.y-1)||2===l(h.x,h.y-1)&&2===l(h.x+1,h.y-1))&&(t[1]!==st.forward&&t[1]!==st.back||2===l(h.x+1,h.y+1)&&2===l(h.x+1,h.y)||2===l(h.x+1,h.y-1)&&2===l(h.x+1,h.y)||2===l(h.x-1,h.y+1)&&2===l(h.x-1,h.y)||2===l(h.x-1,h.y-1)&&2===l(h.x-1,h.y)))){a[h.y][h.x]=2;let t=u.length<30?4:Math.min(4,c.nextInt(6)),n=[st.forward,st.back,st.left,st.right];for(;t>0;){let s=c.nextInt(n.length);e.push([h.clone(),n[s]]),n.splice(s,1),t--}}u=e}class d{constructor(e,t,n){this.height=n,this.connections=[],this.x=e,this.y=t}*[Symbol.iterator](){for(let e of this.connections)yield e}connect(e){this.connections.push(e)}[Symbol.toStringTag](){return this.toString()}toString(){return`(${this.x},${this.y},${this.height})`}}const m=Array.from(new Array(16),(()=>new Array(16).fill(0))),g=(e,t)=>{try{return m[t][e]}catch(e){return 3}};for(let e=6;e<10;e++)for(let t=6;t<10;t++)m[e][t]=4;const _=[];for(r=24;r>0;){let e=c.nextInt(16),t=c.nextInt(16);const[n,s]=[16-m.length/2+t,16-m.length/2+e],i=l(n,s);if(4!==g(t,e)&&1==i||0==i){const i=new d(e,t,3+Math.floor(r/4));_.push(i),m[e][t]=i,a[s][n]=5,r--}}_.forEach((e=>{for(let t=-4;t<=4;t++)for(let n=-4;n<=4;n++)if(0!=t||0!=n){let s=g(e.x+t,e.y+n);s instanceof d&&e.connect(s)}})),this.jigsaw=new et(16,32,10),a.forEach(((e,t)=>{e.forEach(((e,n)=>{if(1===e)this.jigsaw.setStructurePlane(n,t,0,0,0,[this.structure_block1,this.structure_block2][c.nextInt(2)],90*c.nextInt(4));else if(0===e)this.jigsaw.setStructurePlane(n,t,0,0,0,[this.structure_towerBlock1,this.structure_towerBlock2,this.structure_towerBlock3,this.structure_towerBlock4][c.nextInt(4)],90*c.nextInt(4));else if(5===e){let e=g(n-16+m.length/2,t-16+m.length/2);if(e instanceof d){let s=e.height;for(;s>=0;)this.jigsaw.setStructure(n,t,s,0,0,0,this.structure_towerPiece,0),s--}}else if(2===e){let e=2===l(n,t+1)?1:0,s=2===l(n,t-1)?1:0,i=2===l(n+1,t)?1:0,a=2===l(n-1,t)?1:0;switch(e+a+i+s){case 1:e+s===1?this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_straightLine,0):a+i===1&&this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_straightLine,90);break;case 2:if(e+s===2)this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_straightLine,0);else if(a+i===2)this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_straightLine,90);else if(1===a)if(1===e)this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_curve,90);else{if(1!==s)throw new Error("num error");this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_curve,180)}else if(1===i)if(1===e)this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_curve,0);else{if(1!==s)throw new Error("num error");this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_curve,270)}break;case 3:0===a?this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_triple,0):0===s?this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_triple,90):0===i?this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_triple,180):0===e&&this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_triple,270);break;case 4:this.jigsaw.setStructurePlane(n,t,0,0,0,this.structure_crossing,0)}}}))}));const p=new t.Z,y=new t.Z;_.forEach((e=>{for(const t of e)if(t.height>e.height){p.set(e.x,e.height,e.y),y.set(t.x,e.height,t.y).sub(p),y.set(y.x>0?1:-1,e.height,y.z>0?1:-1);let n=16-m.length/2;if(c.nextBoolean()){for(;p.x!=t.x;p.x+=y.x)this.jigsaw.isEmpty(p.x+n,p.z+n,p.y)&&this.jigsaw.setStructure(p.x+n,p.z+n,p.y,0,0,0,this.structure_upplain);for(;p.z!=t.y;p.z+=y.z)this.jigsaw.isEmpty(p.x+n,p.z+n,p.y)&&this.jigsaw.setStructure(p.x+n,p.z+n,p.y,0,0,0,this.structure_upplain)}else{for(;p.z!=t.y;p.z+=y.z)this.jigsaw.isEmpty(p.x+n,p.z+n,p.y)&&this.jigsaw.setStructure(p.x+n,p.z+n,p.y,0,0,0,this.structure_upplain);for(;p.x!=t.x;p.x+=y.x)this.jigsaw.isEmpty(p.x+n,p.z+n,p.y)&&this.jigsaw.setStructure(p.x+n,p.z+n,p.y,0,0,0,this.structure_upplain)}}})),this.jigsaw.setStructurePlane(14,14,0,-1,0,this.structure_boss,0,"none",2,2),this.jigsaw.setStructurePlane(14,16,0,-1,0,this.structure_boss,270,"none",2,2),this.jigsaw.setStructurePlane(16,14,0,-1,0,this.structure_boss,90,"none",2,2),this.jigsaw.setStructurePlane(16,16,0,-1,0,this.structure_boss,180,"none",2,2),this._airMonsterArea=[],this._airPathArea=[],this._monsterArea=[],this._pathArea=[],this._playerArea=[],this.rooms=new Set,this.paths=new Set,this.jigsaw.foreach(((e,n,s,i)=>{if(e.structureName===this.structure_straightLine||e.structureName===this.structure_triple||e.structureName===this.structure_curve||e.structureName===this.structure_crossing)this._pathArea.push(new A(new t.Z(n,i,s).scl(this.jigsaw.size).add(this.x,this.y,this.z),new t.Z(1,1,1).scl(this.jigsaw.size))),this.paths.add(`${n},${i},${s}`),e.structureName===this.structure_crossing&&(this._playerArea.push(new A(new t.Z(n,i,s).scl(this.jigsaw.size).add(this.x,this.y,this.z),new t.Z(1,1,1).scl(this.jigsaw.size))),this.paths.add(`${n},${i},${s}`));else if(e.structureName===this.structure_towerBlock3||e.structureName===this.structure_towerBlock4||e.structureName===this.structure_towerBlock2||e.structureName===this.structure_towerBlock1)this._monsterArea.push(new A(new t.Z(n,i,s).scl(this.jigsaw.size).add(this.x,this.y,this.z),new t.Z(1,1,1).scl(this.jigsaw.size))),this.rooms.add(`${n},${i},${s}`);else if(e.structureName===this.structure_boss);else if(e.structureName===this.structure_upplain)this._airPathArea.push(new A(new t.Z(n,i,s).scl(this.jigsaw.size).add(this.x,this.y,this.z),new t.Z(1,1,1).scl(this.jigsaw.size))),this.paths.add(`${n},${i},${s}`);else if(e.structureName===this.structure_towerPiece){let e=new t.Z(n,i,s).scl(this.jigsaw.size).add(this.x,this.y,this.z);this._airMonsterArea.push(new A(e,new t.Z(1,1,1).scl(this.jigsaw.size))),this.rooms.add(`${n},${i},${s}`)}})),this.completed=!0}}class at{constructor(e){this.structure_area1="mystructure:boss_stone_area_b1",this.structure_area2="mystructure:boss_stone_area_b2",this.structure_area3="mystructure:boss_stone_area_b3",this.structure_area4="mystructure:boss_stone_area_b4",this._pathArea=[],this._monsterArea=[],this._playerArea=[],this.seed=e}init(e,n,s,i){this._monsterArea=[],this._pathArea=[],this._playerArea=[],this.x=e,this.y=n,this.z=s,this.dim=i,this.jigsaw=new et(32,4),this.jigsaw.setStructurePlane(0,0,0,0,0,this.structure_area1,0),this.jigsaw.setStructurePlane(1,0,0,0,0,this.structure_area2,0),this.jigsaw.setStructurePlane(0,1,0,0,0,this.structure_area3,0),this.jigsaw.setStructurePlane(1,1,0,0,0,this.structure_area4,0),this.jigsaw.setStructurePlane(3,0,0,0,0,this.structure_area1,90),this.jigsaw.setStructurePlane(3,1,0,0,0,this.structure_area2,90),this.jigsaw.setStructurePlane(2,0,0,0,0,this.structure_area3,90),this.jigsaw.setStructurePlane(2,1,0,0,0,this.structure_area4,90),this.jigsaw.setStructurePlane(0,3,0,0,0,this.structure_area1,270),this.jigsaw.setStructurePlane(0,2,0,0,0,this.structure_area2,270),this.jigsaw.setStructurePlane(1,3,0,0,0,this.structure_area3,270),this.jigsaw.setStructurePlane(1,2,0,0,0,this.structure_area4,270),this.jigsaw.setStructurePlane(3,3,0,0,0,this.structure_area1,180),this.jigsaw.setStructurePlane(2,3,0,0,0,this.structure_area2,180),this.jigsaw.setStructurePlane(3,2,0,0,0,this.structure_area3,180),this.jigsaw.setStructurePlane(2,2,0,0,0,this.structure_area4,180),this._bossArea=new A(new t.Z(62,2,62).add(e,n,s),new t.Z(4,6,4)),this._playerArea.push(new A(new t.Z(6,5,6).add(e,n,s),new t.Z(2,4,2)),new A(new t.Z(120,5,6).add(e,n,s),new t.Z(2,4,2)),new A(new t.Z(6,5,120).add(e,n,s),new t.Z(2,4,2)),new A(new t.Z(120,5,120).add(e,n,s),new t.Z(2,4,2)))}generate(){this.init(this.x,this.y,this.z,this.dim),this.jigsaw.generate(this.x,this.y,this.z,this.dim),this.dispose()}getPathArea(){return this._pathArea}getMonsterSpawnArea(){return this._monsterArea}getPlayerSpawnArea(){return this._playerArea}getBossSpawnArea(){return this._bossArea}dispose(){this.jigsaw=new et(1,1,1)}}class rt{constructor(e){this.structure_area1="mystructure:boss_ancient_area1",this.structure_area2="mystructure:boss_ancient_area2",this.structure_area3="mystructure:boss_ancient_area3",this.structure_area4="mystructure:boss_ancient_area4",this._pathArea=[],this._monsterArea=[],this._playerArea=[],this.seed=e}init(e,n,s,i){this._monsterArea=[],this._pathArea=[],this._playerArea=[],this.x=e,this.y=n,this.z=s,this.dim=i,this.jigsaw=new et(32,4),this.jigsaw.setStructurePlane(0,0,0,0,0,this.structure_area1,0,"none"),this.jigsaw.setStructurePlane(3,0,0,0,0,this.structure_area1,0,"z"),this.jigsaw.setStructurePlane(0,3,0,0,0,this.structure_area1,0,"x"),this.jigsaw.setStructurePlane(3,3,0,0,0,this.structure_area1,0,"xz"),this.jigsaw.setStructurePlane(1,0,0,0,0,this.structure_area2,0,"none"),this.jigsaw.setStructurePlane(2,0,0,0,0,this.structure_area2,0,"z"),this.jigsaw.setStructurePlane(1,3,0,0,0,this.structure_area2,0,"x"),this.jigsaw.setStructurePlane(2,3,0,0,0,this.structure_area2,0,"xz"),this.jigsaw.setStructurePlane(0,1,0,0,0,this.structure_area3,0,"none"),this.jigsaw.setStructurePlane(3,1,0,0,0,this.structure_area3,0,"z"),this.jigsaw.setStructurePlane(0,2,0,0,0,this.structure_area3,0,"x"),this.jigsaw.setStructurePlane(3,2,0,0,0,this.structure_area3,0,"xz"),this.jigsaw.setStructurePlane(1,1,0,0,0,this.structure_area4,0,"none"),this.jigsaw.setStructurePlane(2,1,0,0,0,this.structure_area4,0,"z"),this.jigsaw.setStructurePlane(1,2,0,0,0,this.structure_area4,0,"x"),this.jigsaw.setStructurePlane(2,2,0,0,0,this.structure_area4,0,"xz"),this._bossArea=new A(new t.Z(62,2,62).add(e,n,s),new t.Z(4,6,4)),this._playerArea.push(new A(new t.Z(10,17,40).add(e,n,s),new t.Z(2,1,2)),new A(new t.Z(118,17,40).add(e,n,s),new t.Z(2,1,2)),new A(new t.Z(118,17,88).add(e,n,s),new t.Z(2,1,2)),new A(new t.Z(10,17,88).add(e,n,s),new t.Z(2,1,2)))}generate(){this.init(this.x,this.y,this.z,this.dim),this.jigsaw.generate(this.x,this.y,this.z,this.dim),this.dispose()}getPathArea(){return this._pathArea}getMonsterSpawnArea(){return this._monsterArea}getPlayerSpawnArea(){return this._playerArea}getBossSpawnArea(){return this._bossArea}dispose(){this.jigsaw=new et(1,1,1)}}class ot{constructor(e){this.structure_area1="mystructure:boss_mind_area_b1",this.structure_area2="mystructure:boss_mind_area_b2",this.structure_area3="mystructure:boss_mind_area_b3",this.structure_area4="mystructure:boss_mind_area_b4",this._pathArea=[],this._monsterArea=[],this._playerArea=[],this.seed=e}init(e,n,s,i){this._monsterArea=[],this._pathArea=[],this._playerArea=[],this.x=e,this.y=n,this.z=s,this.dim=i,this.jigsaw=new et(32,4),this.jigsaw.setStructurePlane(0,0,0,0,0,this.structure_area1,0),this.jigsaw.setStructurePlane(1,0,0,0,0,this.structure_area2,0),this.jigsaw.setStructurePlane(0,1,0,0,0,this.structure_area3,0),this.jigsaw.setStructurePlane(1,1,0,0,0,this.structure_area4,0),this.jigsaw.setStructurePlane(3,0,0,0,0,this.structure_area1,90),this.jigsaw.setStructurePlane(3,1,0,0,0,this.structure_area2,90),this.jigsaw.setStructurePlane(2,0,0,0,0,this.structure_area3,90),this.jigsaw.setStructurePlane(2,1,0,0,0,this.structure_area4,90),this.jigsaw.setStructurePlane(0,3,0,0,0,this.structure_area1,270),this.jigsaw.setStructurePlane(0,2,0,0,0,this.structure_area2,270),this.jigsaw.setStructurePlane(1,3,0,0,0,this.structure_area3,270),this.jigsaw.setStructurePlane(1,2,0,0,0,this.structure_area4,270),this.jigsaw.setStructurePlane(3,3,0,0,0,this.structure_area1,180),this.jigsaw.setStructurePlane(2,3,0,0,0,this.structure_area2,180),this.jigsaw.setStructurePlane(3,2,0,0,0,this.structure_area3,180),this.jigsaw.setStructurePlane(2,2,0,0,0,this.structure_area4,180),this._bossArea=new A(new t.Z(62,36,62).add(e,n,s),new t.Z(4,6,4)),this._playerArea.push(new A(new t.Z(36,37,36).add(e,n,s),new t.Z(50,4,50)))}generate(){this.init(this.x,this.y,this.z,this.dim),this.jigsaw.generate(this.x,this.y,this.z,this.dim),this.dispose()}getPathArea(){return this._pathArea}getMonsterSpawnArea(){return this._monsterArea}getPlayerSpawnArea(){return this._playerArea}getBossSpawnArea(){return this._bossArea}dispose(){this.jigsaw=new et(1,1,1)}}const ct=["dec:god_of_destroy","dec:destroy_staff"];class lt{constructor(t){this.time=null!=t?t:e.world.getAbsoluteTime()}print(){e.world.say("time is "+this.time)}isDay(){return this.days()<12e3}isNight(){return this.days()>12e3}days(){return this.time-24e3*Math.floor(this.time/24e3)}}var ut=function(e,t,n,s){var i,a=arguments.length,r=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ht=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class dt extends b{constructor(s){super(s),this.tps=20,this._mtps=20,this.fakeplayers=[],this.setting=new P(new M.C("wpsetting")),(this.clearEntityNumUpdate=new S(this.getEvents(),(()=>{this.updateClearEntityNum()})).delay(1e4)).start(),this.updateClearEntityNum(),this.entityCleaner=new S(this.getEvents(),(()=>{let t=Array.from(n.Z.getInstance(this.getDimension(e.MinecraftDimensionTypes.overworld)).getEntities()).concat(Array.from(n.Z.getInstance(this.getDimension(e.MinecraftDimensionTypes.theEnd)).getEntities())).concat(Array.from(n.Z.getInstance(this.getDimension(e.MinecraftDimensionTypes.nether)).getEntities())),s=new Map;t.forEach((e=>{var t;null!=(null==e?void 0:e.typeId)&&s.set(e.typeId,(null!==(t=s.get(e.typeId))&&void 0!==t?t:0)+1)}));let i=[0,""];s.forEach(((t,n)=>{t>i[0]&&-1===[e.MinecraftEntityTypes.player.id,e.MinecraftEntityTypes.villager.id,e.MinecraftEntityTypes.villagerV2.id].indexOf(n)&&(i[0]=t,i[1]=n)})),t.length>this.entityCleanerLeastNum&&(this.say("Clear Entity Type："+i[1]),this.say("Clear Entity Num："+i[0]),t.forEach((e=>{e&&e.typeId&&e.typeId===i[1]&&("minecraft:item"===e.typeId&&0!==e.viewVector.y||e.kill())})))})).delay(8e3),this.upDateEntityCleaner();let i=0;this.tpsListener=new S(this.getEvents(),(()=>{this.tps=i;let e=this.tps-this._mtps>0?this.entityCleanerStrength:11-this.entityCleanerStrength;this._mtps=this._mtps*(e-1)/e+this.tps/e,this.entityCleaner.delay(Math.pow(this.entityCleanerDelay,this._mtps)),i=0})).delay(1e3),this.getEvents().events.tick.subscribe((e=>{i++})),this.tpsListener.start(),this.portal_desertBoss=new v,this.portal_desertBoss.setDirection(v.DIRECTION_LAY).setStructure([["XXXXX","XWWWX","XWYWX","XWWWX","XXXXX"],["XSXSX","SAAAS","XAAAX","SAAAS","XSXSX"],["CAAAC","AAAAA","AAAAA","AAAAA","CAAAC"]]).analysis({X:e.MinecraftBlockTypes.sandstone.id,W:e.MinecraftBlockTypes.water.id,Y:"wb:block_magic_equipment",A:e.MinecraftBlockTypes.air.id,S:e.MinecraftBlockTypes.stoneBlockSlab2.id,C:e.MinecraftBlockTypes.cobblestoneWall.id}),this.portal_stoneBoss=new v,this.portal_stoneBoss.setDirection(v.DIRECTION_LAY).setStructure([["BXXXB","XWWWX","XWYWX","XWWWX","BXXXB"],["BASAB","AAAAA","SAAAS","AAAAA","BASAB"]]).analysis({X:e.MinecraftBlockTypes.sandstone.id,W:e.MinecraftBlockTypes.water.id,Y:"wb:block_energy_seal",S:e.MinecraftBlockTypes.cobblestoneWall.id,A:e.MinecraftBlockTypes.air.id,B:e.MinecraftBlockTypes.stonebrick.id}),this.portal_caveBoss=new v,this.portal_caveBoss.setDirection(v.DIRECTION_LAY).setStructure([["XXXXX","XWWWX","XWYWX","XWWWX","XXXXX"],["XASAX","AAAAA","SAAAS","AAAAA","XASAX"]]).analysis({X:e.MinecraftBlockTypes.deepslateTiles.id,W:e.MinecraftBlockTypes.water.id,Y:"wb:block_energy_boundary",S:e.MinecraftBlockTypes.lantern.id,A:e.MinecraftBlockTypes.air.id}),this.portal_ancientBoss=new v,this.portal_ancientBoss.setDirection(v.DIRECTION_LAY).setStructure([["BXXXB","XWWWX","XWYWX","XWWWX","BXXXB"],["BASAB","AAAAA","SAAAS","AAAAA","BASAB"]]).analysis({X:e.MinecraftBlockTypes.chiseledDeepslate.id,W:e.MinecraftBlockTypes.water.id,Y:"wb:block_magic_ink",S:e.MinecraftBlockTypes.verdantFroglight.id,A:e.MinecraftBlockTypes.air.id,B:e.MinecraftBlockTypes.mossyCobblestone.id}),this.portal_mindBoss=new v,this.portal_mindBoss.setDirection(v.DIRECTION_LAY).setStructure([["XSSSX","SWWWS","SWYWS","SWWWS","XSSSX"],["XAAAX","AAAAA","AAAAA","AAAAA","XAAAX"]]).analysis({X:"wb:block_magic_equipment",W:e.MinecraftBlockTypes.water.id,Y:"wb:block_senior_equipment",S:"wb:block_magic_barrier",A:e.MinecraftBlockTypes.air.id});let a=new C.Z(this.setting.worldSeed);this.ruin_desertBoss=new it(a.nextInt()),this.ruin_stoneBoss=new at(a.nextInt()),this.ruin_caveBoss=new nt(a.nextInt()),this.ruin_ancientBoss=new rt(a.nextInt()),this.ruin_mindBoss=new ot(a.nextInt()),l.push((()=>{this.ruin_desertBoss.init(Y.DESERT_RUIN_LOCATION_START.x,Y.DESERT_RUIN_LOCATION_START.y,Y.DESERT_RUIN_LOCATION_START.z,this.getDimension(e.MinecraftDimensionTypes.theEnd)),this.ruin_desertBoss.dispose(),this.ruin_stoneBoss.init(Y.STONE_RUIN_LOCATION_START.x,Y.STONE_RUIN_LOCATION_START.y,Y.STONE_RUIN_LOCATION_START.z,this.getDimension(e.MinecraftDimensionTypes.theEnd)),this.ruin_stoneBoss.dispose(),this.ruin_caveBoss.init(Y.CAVE_RUIN_LOCATION_START.x,Y.CAVE_RUIN_LOCATION_START.y,Y.CAVE_RUIN_LOCATION_START.z,this.getDimension(e.MinecraftDimensionTypes.theEnd)),this.ruin_caveBoss.dispose(),this.ruin_ancientBoss.init(Y.ANCIENT_RUIN_LOCATION_START.x,Y.ANCIENT_RUIN_LOCATION_START.y,Y.ANCIENT_RUIN_LOCATION_START.z,this.getDimension(e.MinecraftDimensionTypes.theEnd)),this.ruin_ancientBoss.dispose(),this.ruin_mindBoss.init(Y.MIND_RUIN_LOCATION_START.x,Y.MIND_RUIN_LOCATION_START.y,Y.MIND_RUIN_LOCATION_START.z,this.getDimension(e.MinecraftDimensionTypes.theEnd)),this.ruin_ancientBoss.dispose()}));const r=()=>{let t=this.getExDimension(e.MinecraftDimensionTypes.theEnd).getEntities({location:D.Z.getLocation(Y.DESERT_RUIN_LOCATION_CENTER),maxDistance:400});for(let e of t)"minecraft:item"===e.typeId&&0===e.viewVector.y&&e.kill()};this.ruinCleaner=new S(this.getEvents(),(()=>{r()})).delay(6e4),r(),this.ruinCleaner.start();const o=e=>Y.DESERT_RUIN_PROTECT_AREA.contains(e)||Y.STONE_RUIN_PROTECT_AREA.contains(e)||Y.CAVE_RUIN_PROTECT_AREA.contains(e)||Y.ANCIENT_RUIN_PROTECT_AREA.contains(e)||Y.MIND_RUIN_PROTECT_AREA.contains(e);this.getEvents().events.blockBreak.subscribe((t=>{if(t.dimension===this.getDimension(e.MinecraftDimensionTypes.theEnd)&&o(t.block)){let n=m.Z.getInstance(t.player);t.dimension.getBlock(t.block.location).setType(t.brokenBlockPermutation.type),n.getExDimension().command.run("kill @e[type=item,r=2,x="+t.block.x+",y="+t.block.y+",z="+t.block.z+"]"),t.player.addEffect(e.MinecraftEffectTypes.nausea,200,0,!0),t.player.addEffect(e.MinecraftEffectTypes.blindness,200,0,!0),t.player.addEffect(e.MinecraftEffectTypes.darkness,400,0,!0),t.player.addEffect(e.MinecraftEffectTypes.wither,100,0,!0),t.player.addEffect(e.MinecraftEffectTypes.miningFatigue,600,2,!0),t.player.addEffect(e.MinecraftEffectTypes.hunger,600,1,!0),n.command.run('tellraw @s { "rawtext" : [ { "translate" : "text.dec:i_inviolable.name" } ] }')}})),this.getEvents().events.beforeItemUseOn.subscribe((t=>{t.source.dimension===this.getDimension(e.MinecraftDimensionTypes.theEnd)&&o(t.blockLocation)&&(t.cancel=!0)})),this.getEvents().events.beforeExplosion.subscribe((t=>{t.source&&t.dimension===this.getDimension(e.MinecraftDimensionTypes.theEnd)&&o(t.source.location)&&0!==t.impactedBlocks.length&&(this.getExDimension(e.MinecraftDimensionTypes.theEnd).spawnParticle("dec:damp_explosion_particle",t.source.location),t.cancel=!0)})),this.getEvents().events.beforeItemUse.subscribe((t=>{var n;t.source.dimension===this.getDimension(e.MinecraftDimensionTypes.theEnd)&&o(t.source.location)&&(n=t.item.typeId,ct.includes(n)&&(t.cancel=!0))}));const u=this.getExDimension(e.MinecraftDimensionTypes.theEnd);let h=0;const d=new t.Z,g=new t.Z;this.ruinDesertGuardPos=new t.Z(Y.DESERT_RUIN_LOCATION_CENTER),this.ruinDesertGuardRule=new c.Z(this.getEvents(),(()=>{if(u.spawnParticle("wb:ruin_desert_guardpar",this.ruinDesertGuardPos),h>400&&(h=0),h>200){let t=u.getPlayers({location:D.Z.getLocation(Y.DESERT_RUIN_LOCATION_CENTER),maxDistance:400,closest:1,gameMode:e.GameMode.adventure});if(t.length>0){const e=t[0].location;e.x&&e.y&&e.z&&(g.set(e),d.set(this.ruinDesertGuardPos),g.sub(d),g.len()<2&&T.Z.getInstance(t[0]).damage(4),g.normalize(),d.set(e).sub(Y.DESERT_RUIN_LOCATION_START).div(16).floor(),this.ruin_desertBoss.isInRoom(`${d.x},${d.y},${d.z}`)?this.ruinDesertGuardPos.add(g.scl(.2)):this.ruinDesertGuardPos.add(g.scl(.38)))}}h+=1})).delay(1),this.ruinFuncLooper=new c.Z(this.getEvents(),(()=>{var t;let n=!1,s=!1;for(let e of this.getClients())d.set(e.player.location),this.ruin_desertBoss.isCompleted()&&d.x>=Y.DESERT_RUIN_LOCATION_START.x&&d.x<=Y.DESERT_RUIN_LOCATION_END.x&&d.z>=Y.DESERT_RUIN_LOCATION_START.z&&d.z<=Y.DESERT_RUIN_LOCATION_END.z&&(n=!0),d.x>=Y.MIND_RUIN_LOCATION_START.x&&d.x<=Y.MIND_RUIN_LOCATION_END.x&&d.z>=Y.MIND_RUIN_LOCATION_START.z&&d.z<=Y.MIND_RUIN_LOCATION_END.z&&(s=!0);if(n?(this.ruinDesertGuardRule.start(),this.ruinCleaner.start()):(this.ruinDesertGuardRule.stop(),this.ruinCleaner.stop()),s){let n=null===(t=this.ruin_mindBoss.getBossSpawnArea())||void 0===t?void 0:t.center();n&&!he.find(n)&&this.getExDimension(e.MinecraftDimensionTypes.theEnd).spawnParticle("wb:ruin_mind_boss_center_par",n)}})).delay(240),this.ruinFuncLooper.start(),this.getEvents().events.entityCreate.subscribe((t=>{t.entity.typeId===e.MinecraftEntityTypes.enderman.id&&t.entity.dimension===this.getDimension(e.MinecraftDimensionTypes.theEnd)&&o(t.entity.location)&&t.entity.triggerEvent("minecraft:despawn")})),this.addEntityController(Fe.typeId,Fe),this.addEntityController(Ze.typeId,Ze),this.addEntityController(Le.typeId,Le),this.addEntityController(He.typeId,He),this.addEntityController(We.typeId,We),this.addEntityController(Ve.typeId,Ve)}sayTo(t){this.getExDimension(e.MinecraftDimensionTypes.theEnd).command.run(`tellraw @a {"rawtext": [{"text": "${t}"}]}`)}updateClearEntityNum(){this.entityCleanerStrength=this.setting.entityCleanerStrength,this.entityCleanerLeastNum=this.setting.entityCleanerLeastNum,this.entityCleanerDelay=(60-this.setting.entityCleanerDelay)/100+1.8}upDateEntityCleaner(){this.setting.entityCleaner?this.entityCleaner.start():this.entityCleaner.stop()}time(e){(new lt).print()}damageShow(e){we(n.Z.getInstance(e.hurtEntity.dimension),e.damage,e.hurtEntity.location)}newClient(e,t){return new Je(this,e,t)}}ut([(0,f.K)("chat",((e,t)=>"time"===t.message)),ht("design:type",Function),ht("design:paramtypes",[e.ChatEvent]),ht("design:returntype",void 0)],dt.prototype,"time",null),ut([(0,f.K)("entityHurt",((t,n)=>t.setting.damageShow&&n.cause!==e.EntityDamageCause.suicide)),ht("design:type",Function),ht("design:paramtypes",[e.EntityHurtEvent]),ht("design:returntype",void 0)],dt.prototype,"damageShow",null);class mt{constructor(e,t,n,s){this.head=e,this.chest=t,this.legs=n,this.boots=s}detect(e){return e.detectArmor(this.head,this.chest,this.legs,this.boots)}find(e){return t=this,n=void 0,i=function*(){try{return yield e.run("execute as @a if entity @s[hasitem={location=slot.armor.head,item="+this.head+"}] if entity @s[hasitem={location=slot.armor.chest,item="+this.chest+"}] if entity @s[hasitem={location=slot.armor.legs,item="+this.legs+"}] if entity @s[hasitem={location=slot.armor.feet,item="+this.boots+"}] run tag @s add armorTest:"+this.name)}catch(e){return e}},new((s=void 0)||(s=Promise))((function(e,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(r,o)}c((i=i.apply(t,n||[])).next())}));var t,n,s,i}}let gt={rupert:new mt("dec:rupert_helmet","dec:rupert_chestplate","dec:rupert_leggings","dec:rupert_boots"),lava:new mt("dec:lava_helmet","dec:lava_chestplate","dec:lava_leggings","dec:lava_boots"),crying:new mt("dec:crying_helmet","dec:crying_chestplate","dec:crying_leggings","dec:crying_boots"),everlasting_winter:new mt("dec:everlasting_winter_helmet","dec:everlasting_winter_chestplate","dec:everlasting_winter_leggings","dec:everlasting_winter_boots"),amethyst:new mt("dec:amethyst_helmet","dec:amethyst_chestplate","dec:amethyst_leggings","dec:amethyst_boots"),turtle:new mt("minecraft:turtle_helmet","dec:turtle_chestplate","dec:turtle_leggings","dec:turtle_boots"),wood:new mt("dec:wood_helmet","dec:wood_chestplate","dec:wood_leggings","dec:wood_boots")},_t=function(e,t){for(let n in t)n in e||(e[n]=t[n]);return e}({bloodsucking:new mt("wb:armor_bloodsucking_helmet","wb:armor_bloodsucking_chestplate","wb:armor_bloodsucking_leggings","wb:armor_bloodsucking_boots"),ink:new mt("wb:armor_ink_helmet","wb:armor_ink_chestplate","wb:armor_ink_leggings","wb:armor_ink_boots"),forget:new mt("wb:armor_forget_helmet","wb:armor_forget_chestplate","wb:armor_forget_leggings","wb:armor_forget_boots"),seal:new mt("wb:armor_seal_helmet","wb:armor_seal_chestplate","wb:armor_seal_leggings","wb:armor_seal_boots"),equipment:new mt("wb:armor_equipment_helmet","wb:armor_equipment_chestplate","wb:armor_equipment_leggings","wb:armor_equipment_boots"),water:new mt("wb:armor_water_helmet","wb:armor_water_chestplate","wb:armor_water_leggings","wb:armor_water_boots"),senior_bloodsucking:new mt("wb:armor_senior_bloodsucking_helmet","wb:armor_senior_bloodsucking_chestplate","wb:armor_senior_bloodsucking_leggings","wb:armor_senior_bloodsucking_boots"),senior_ink:new mt("wb:armor_senior_ink_helmet","wb:armor_senior_ink_chestplate","wb:armor_senior_ink_leggings","wb:armor_senior_ink_boots"),senior_forget:new mt("wb:armor_senior_forget_helmet","wb:armor_senior_forget_chestplate","wb:armor_senior_forget_leggings","wb:armor_senior_forget_boots"),senior_seal:new mt("wb:armor_senior_seal_helmet","wb:armor_senior_seal_chestplate","wb:armor_senior_seal_leggings","wb:armor_senior_seal_boots"),senior_equipment:new mt("wb:armor_senior_equipment_helmet","wb:armor_senior_equipment_chestplate","wb:armor_senior_equipment_leggings","wb:armor_senior_equipment_boots"),senior_water:new mt("wb:armor_senior_water_helmet","wb:armor_senior_water_chestplate","wb:armor_senior_water_leggings","wb:armor_senior_water_boots")},gt),pt=new Map;for(let e in _t)_t[e].name=e,pt.set(_t[e],e);class yt{static isDec(){return"DEC"===i.Z.config.addonName}}class ft extends s.Z{constructor(e,n,s){super(e,n,s),this.useArmor=void 0,this.tmpV=new t.Z(0,0,0),this.globalscores=new U(new M.C("global"))}onJoin(){super.onJoin(),this.getEvents().exEvents.playerHurt.subscribe((t=>{this.exPlayer.getHealth()<=0&&(this.exPlayer.command.run("function die/normal"),1===this.globalscores.getNumber("DieMode")?this.exPlayer.command.run("function die/die_mode"):1==L.randomInteger(1,3)&&this.exPlayer.command.run("function die/ghost"));let n=L.randomInteger(1,100);if(1<=n&&n<=20&&this.useArmor===gt.rupert&&(this.player.addEffect(e.MinecraftEffectTypes.regeneration,200),this.player.addEffect(e.MinecraftEffectTypes.speed,100),this.tmpV.set(this.player.location).add(0,1,0),this.getExDimension().spawnParticle("dec:tear_from_rupert",this.tmpV),this.getExDimension().spawnParticle("dec:tear_from_rupert",this.tmpV),this.getExDimension().spawnParticle("dec:tear_from_rupert",this.tmpV),this.getExDimension().spawnParticle("dec:tear_from_rupert",this.tmpV),this.getExDimension().spawnParticle("dec:tear_from_rupert",this.tmpV)),this.useArmor===gt.lava&&(this.tmpV.set(this.player.location).add(0,1,0),this.getExDimension().spawnParticle("dec:fire_spurt_particle",this.tmpV),this.player.addEffect(e.MinecraftEffectTypes.fireResistance,80)),this.useArmor===gt.crying&&(n<1||(1<=n&&n<=10?this.player.addEffect(e.MinecraftEffectTypes.weakness,100):n<=20?this.player.addEffect(e.MinecraftEffectTypes.slowness,80):n<=30?this.player.addEffect(e.MinecraftEffectTypes.blindness,100):n<=40&&this.player.addEffect(e.MinecraftEffectTypes.nausea,140))),1<=n&&n<=12&&this.useArmor===gt.everlasting_winter){for(let t of this.getDimension().getEntities({maxDistance:5,location:D.Z.getLocation(this.player.location)}))t!=this.player&&t.addEffect(e.MinecraftEffectTypes.slowness,60,1);this.player.addEffect(e.MinecraftEffectTypes.healthBoost,600,0),this.tmpV.set(this.player.location),this.getExDimension().spawnParticle("dec:everlasting_winter_spurt_particle",this.tmpV)}if(!yt.isDec()&&!this.player.hasTag("wbkjlq"))switch(this.useArmor){case _t.bloodsucking:this.exPlayer.command.run("function armor/bloodsucking");break;case _t.senior_bloodsucking:this.exPlayer.command.run("function armor/bloodsucking2");break;case _t.ink:case _t.senior_ink:break;case _t.senior_seal:this.exPlayer.command.run("function armor/seal2");break;case _t.seal:this.exPlayer.command.run("function armor/seal");break;case _t.senior_water:this.exPlayer.command.run("function armor/water2");break;case _t.water:this.exPlayer.command.run("function armor/water");break;case _t.senior_equipment:this.exPlayer.command.run("function armor/equipment2");break;case _t.equipment:this.exPlayer.command.run("function armor/equipment");break;case _t.senior_forget:this.exPlayer.command.run("function armor/forget2");break;case _t.forget:this.exPlayer.command.run("function armor/forget")}})),this.getEvents().exEvents.itemOnHandChange.subscribe((e=>{let t=this.exPlayer.getBag();const n=e.afterItem;if(n&&"dec:magic_scroll_blue"==n.typeId&&1==n.amount&&0==n.getLore().length){let e=L.randomInteger(1,3),s=n,i=[],a=yt.isDec()?De:Ce;for(let t=0;t<e;t++)i.push(C.Z.choice(a).id.split("").map((e=>Se[parseInt(e)])).join(" "));s.setLore(i),t.setItemOnHand(s)}})),this.getEvents().exEvents.tick.subscribe((t=>{var n;const s=this.player,i=this.exPlayer,a=this.exPlayer.getScoresManager();if(s.isSneaking?s.addTag("is_sneaking"):s.removeTag("is_sneaking"),s.dimension.id===e.MinecraftDimensionTypes.overworld?(s.addTag("dOverworld"),s.removeTag("dNether"),s.removeTag("dTheEnd")):s.dimension.id===e.MinecraftDimensionTypes.nether?(s.addTag("dNether"),s.removeTag("dOverworld"),s.removeTag("dTheEnd"),t.currentTick%80==0&&i.command.run('fog @s remove "night_event"')):s.dimension.id===e.MinecraftDimensionTypes.theEnd&&(s.addTag("dTheEnd"),s.removeTag("dNether"),s.removeTag("dOverworld"),t.currentTick%80==0&&i.command.run('fog @s remove "night_event"')),t.currentTick%20==0&&this.useArmor===gt.amethyst)if(yt.isDec()){let e=a.getScore("magicpoint");11<=e&&e<=29&&(this.getExDimension().spawnParticle("dec:amethyst_armor_magic_increase_particle",s.location),a.addScoreAsync("magicpoint",1))}else{let e=a.getScore("wbfl");20<=e&&e<=100&&(this.getExDimension().spawnParticle("dec:amethyst_armor_magic_increase_particle",s.location),a.addScoreAsync("wbfl",1))}t.currentTick%40==0&&(this.useArmor===gt.rupert&&this.getExDimension().spawnParticle("dec:tear_from_rupert",this.tmpV.set(s.location).add(0,1,0)),s.isSneaking&&this.useArmor===gt.turtle&&"dec:turtle_sword"===(null===(n=i.getBag().getItemOnHand())||void 0===n?void 0:n.typeId)&&(s.addEffect(e.MinecraftEffectTypes.slowness,100,5),s.addEffect(e.MinecraftEffectTypes.slowness,40,3),s.addEffect(e.MinecraftEffectTypes.slowness,40,50))),t.currentTick%100==0&&this.useArmor===gt.wood&&(yt.isDec()?a.getScore("magicpoint")<=15&&(this.getExDimension().spawnParticle("dec:wood_armor_magic_increase_particle",s.location),a.addScoreAsync("magicpoint",1)):a.getScore("wbfl")<=70&&(this.getExDimension().spawnParticle("dec:wood_armor_magic_increase_particle",s.location),a.addScoreAsync("wbfl",1)))})),this.getEvents().exEvents.itemUse.subscribe((e=>{"dec:magic_scroll_blue"==e.item.typeId&&(yt.isDec()?function(e,t){let n=new se.ActionFormData;n=n.title("text.dec:task_choose_title.name"),n=n.body("text.dec:task_choose_body.name");let s=t.getLore();s.forEach((e=>{n=n.button(e)})),n.show(e.player).then((t=>{if(null!=t.selection){let n=xe(s[t.selection]);!function(e,t){let n=(new se.ActionFormData).button("text.dec:task_complete_button.name");const s=De.findIndex((e=>e.id===t));-1!==s&&n.title(De[s].title()).body(De[s].body()).show(e.player).then((t=>{0==t.selection&&De[s].detect(e.exPlayer)}))}(e,n)}}))}(this,e.item):k.postMessageBetweenClient(this,dt,"taskUi",["paperTask","1"]))}))}checkArmor(){return e=this,t=void 0,s=function*(){return yt.isDec()||(this.useArmor===_t.ink?this.player.triggerEvent("armor_ink"):this.useArmor===_t.senior_ink?this.player.triggerEvent("armor_senior_ink"):this.player.triggerEvent("hostile_mode")),!!this.useArmor&&(yield this.useArmor.detect(this.exPlayer))},new((n=void 0)||(n=Promise))((function(i,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function o(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((s=s.apply(e,t||[])).next())}));var e,t,n,s}chooseArmor(e){this.useArmor=e}onLoaded(){super.onLoaded()}onLeave(){super.onLeave()}}class wt extends Oe{constructor(e,t){super(e,t)}despawn(){this.entity.triggerEvent("minecraft:despawn")}onFail(){this.server.say({rawtext:[{translate:"text.dec:killed_by_boss.name"}]}),this.despawn()}onWin(){if(!yt.isDec())for(let e of this.entity.dimension.getPlayers({location:D.Z.getLocation(this.entity.location),maxDistance:32})){let t=this.server.findClientByPlayer(e);t&&k.postMessageBetweenClient(t,dt,"progressTaskFinish",[this.entity.typeId,1e3])}}}class Et extends wt{constructor(e,t){super(e,t)}onDestroy(){super.onDestroy()}onSpawn(){super.onSpawn()}onKilled(e){this.onWin(),super.onKilled(e)}}class bt extends wt{constructor(e,t){super(e,t),this.music=new Pe("music.wb.ghost_tears","2:16"),this.setTimeout((()=>{this.music.loop(this.getEvents(),this.exEntity.getExDimension(),this.entity.location)}),500)}onDestroy(){this.music.stop(),super.onDestroy()}onSpawn(){super.onSpawn()}}class It extends Et{constructor(e,t){super(e,t),this.music=new Pe("music.wb.the_peotry_of_ghost","3:12"),this.setTimeout((()=>{this.music.loop(this.getEvents(),this.exEntity.getExDimension(),this.entity.location)}),500)}onDestroy(){this.music.stop(),super.onDestroy()}onSpawn(){super.onSpawn()}}let At=new class{constructor(){this.addonName="",this.gameVersion="1.9.20",this.addonVersion="1.7.2B4",this.debug=!1,this.watchDog=!1}};At.addonName="POM",At.addonVersion="1.7.2B4",At.gameVersion="1.9.50",At.watchDog=!1,At.debug=!0,k.createServer(dt,At),k.createServer(class extends b{constructor(n){super(n),this.tmpV=new t.Z,this.i_inviolable=new M.C("i_inviolable").create("i_inviolable"),this.i_damp=new M.C("i_damp").create("i_damp"),this.i_soft=new M.C("i_soft").create("i_soft"),this.nightEventListener=new oe((t=>{t?this.getExDimension(e.MinecraftDimensionTypes.overworld).command.run(["execute if score IsNight global = zero global run scoreboard players random NightRandom global 1 100","scoreboard players set IsDay global 0","scoreboard players set IsNight global 1"]):this.getExDimension(e.MinecraftDimensionTypes.overworld).command.run(["scoreboard players set IsDay global 1","scoreboard players set IsNight global 0","scoreboard players set NightRandom global 0","scoreboard players set @a night_event 0",'fog @a remove "night_event"'])}),!1),this.getEvents().events.beforeChat.subscribe((t=>{let n=this.getExDimension(e.MinecraftDimensionTypes.overworld),s=m.Z.getInstance(t.sender);if(t.message.startsWith(">/")){let e=function(e){(e.startsWith("/")||e.startsWith("$"))&&(e=e.substring(1,e.length));let t=e.split(" "),n=[];for(let e of t)n.push(e);return n}(t.message.substring(2)),i="";switch(e[0]){case"help":s.command.run("function help");break;case"creators":yt.isDec()&&s.command.run("function test/creator_list");break;case"diemode":"open"===e[1]?s.command.run("function diemode/open"):"test"===e[1]?s.command.run("function diemode/test"):i="Invalid command "+e[1];break;case"magic":yt.isDec()&&("display"===e[1]?t.sender.isOp()?"true"===e[2]?n.command.run("function magic/display_on"):"false"===e[2]?n.command.run("function magic/display_off"):i="Invalid command "+e[2]:s.command.run('tellraw @s { "rawtext" : [ { "translate" : "text.dec:command_fail.name" } ] }'):i="Invalid command "+e[1])}0!==i.length&&s.command.run(`tellraw @s { "rawtext" : [ { "text" : "Command Error: ${i}" } ] }`),t.cancel=!0}})),this.getEvents().events.blockBreak.subscribe((t=>{const n=m.Z.getInstance(t.player);n.getScoresManager().getScore(this.i_inviolable)>1&&(t.dimension.getBlock(t.block.location).setType(t.brokenBlockPermutation.type),n.getExDimension().command.run("kill @e[type=item,r=2,x="+t.block.x+",y="+t.block.y+",z="+t.block.z+"]"),t.player.addEffect(e.MinecraftEffectTypes.nausea,200,0,!0),t.player.addEffect(e.MinecraftEffectTypes.blindness,200,0,!0),t.player.addEffect(e.MinecraftEffectTypes.darkness,400,0,!0),t.player.addEffect(e.MinecraftEffectTypes.wither,100,0,!0),t.player.addEffect(e.MinecraftEffectTypes.miningFatigue,600,2,!0),t.player.addEffect(e.MinecraftEffectTypes.hunger,600,1,!0),n.command.run('tellraw @s { "rawtext" : [ { "translate" : "text.dec:i_inviolable.name" } ] }'))})),this.getEvents().events.beforeExplosion.subscribe((e=>{if(e.source){const t=T.Z.getInstance(e.source);t.getScoresManager().getScore(this.i_damp)>0&&(t.getExDimension().spawnParticle("dec:damp_explosion_particle",e.source.location),e.cancel=!0)}})),this.getEvents().events.beforeItemUseOn.subscribe((e=>{T.Z.getInstance(e.source).getScoresManager().getScore(this.i_soft)>0&&"dec:iron_key"!=e.item.typeId&&"dec:frozen_power"!=e.item.typeId&&(e.cancel=!0)})),this.getEvents().events.tick.subscribe((t=>{if(this.getExDimension(e.MinecraftDimensionTypes.overworld).command.run(["scoreboard players remove @e[scores={i_inviolable=1..}] i_inviolable 1","scoreboard players remove @e[scores={i_damp=1..}] i_damp 1","scoreboard players remove @e[scores={i_soft=1..}] i_soft 1","scoreboard players remove @e[scores={harmless=1..}] harmless 1"]),t.currentTick%100==0){this.nightEventListener.upDate((new lt).isNight());let t=[];for(const e of this.getClients())t.push(e.checkArmor());(0,o.to)(Promise.all(t).then((t=>{if(!t.every((e=>e))){let t=[];if(yt.isDec())for(let n in gt)t.push(gt[n].find(this.getExDimension(e.MinecraftDimensionTypes.overworld).command));else for(let n in _t)t.push(_t[n].find(this.getExDimension(e.MinecraftDimensionTypes.overworld).command));(0,o.to)(Promise.all(t).then((e=>{for(const e of this.getClients()){let t=!1;for(let n of e.player.getTags())n.startsWith("armorTest:")&&(e.player.removeTag(n),e.chooseArmor(_t[n.split(":")[1]]),t=!0);t||e.chooseArmor(void 0)}})))}})))}})),this.addEntityController("dec:leaves_golem",Et),this.addEntityController("dec:king_of_pillager",Et),this.addEntityController("dec:abyssal_controller",Et),this.addEntityController("dec:predators",Et),this.addEntityController("dec:enchant_illager_2",Et),this.addEntityController("dec:escaped_soul_entity",Et),this.addEntityController("dec:host_of_deep_2",Et),this.addEntityController("dec:ash_knight",Et),this.addEntityController("dec:everlasting_winter_ghast",bt),this.addEntityController("dec:everlasting_winter_ghast_1",It)}newClient(e,t){return new ft(this,e,t)}},At)})();